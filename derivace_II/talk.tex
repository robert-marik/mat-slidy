\documentclass[12pt]{article}

\input ../talks.tex

\begin{document}

\section*{Jak citlivě}

V následujícím si ukážeme, jak se derivace dají využít pro citlivostní analýzu. Budeme sledovat jestli při změnách na vstupu se funkce mění rychle nebo pomalu. Využití je například i pro posouzení jak se nejistota ve vstupních datech projeví v nejistotě na výstupu. To je užitečné, protože každé praktické měření je zatíženo nějakou chybou a určitá míry nejistoty ve vstupních datech proto není nic neobvyklého.

Derivaci jsme poznali jako rychlost změny. To je možno interpretovat nekolika způsoby. Například jako míru změny funkce, pokud se vstupní data změní o jednotku. Pomocí přímé úměrnosti potom jednotkovou změnu vstupních dat můžeme libovolně zvětšit, nebo zmenšit. To druhé je smysluplnější, protože derivace je okamžitá rychlost a funguje jenom pro malé změny ve vstupních datech. Velké změny totiž trvají dlouo a v mezičase by se poměry v systému mohly změnit a náš model by mohl ztratit relevantnost. Typicky rychlost změny nebývá konstantní.

Pokud se tedy vstupní data $x$ změní o malou hodnotu $\Delta x$, odhad pro odezvu na výstupu je změna o velikosti derivace funkce $f$ v bodě $x$ násobené změnou $\Delta x$. Jako konkrétní příklad uvažujme vzorec pro deformaci nosníku, ve kterém budeme sledovat reakci na výšku nosníku. Průhyb je nepřímo úměrný třetí mocnině výšky a ze zadaného průhybu pro danou výšku je možné tuto konstantu úměrnosti vypočítat. Derivováním dostaneme jak průhyb reaguje na změny výšky a protože změna čini dvě jednotky délky, je nutno derivaci vynásobit tímto faktorem. Odsud dokážeme odhadnout změnu průhybu nosníku. Všimněme si, že derivace je záporná. To je proto že s rostoucí výškou klesá průhyb a naopak. V konkrétních číslech nám vyjde, že při změně výšky o dva centimetry je průhyb změní o tři centimetry. Zde se může jednat o reálnou změnu, například opotřebení nosníku, ale i o virtuální hypotetickou změnu, například právě nejistotu. Je možné výsledek proto interpretovat také tak, že nejistota plus mínus dva centimetry při stanovení průhybu nosníku vyvolá nejistotu plus mínus tři centimetry při stanovení průhybu.

Určitě vás napadlo, že s využitím zadaného vzorce by se dal vypočítat průhyb pro dvě různé výšky a odečtením těchto hodnot určit nárůst průhybu. Výhodou by bylo, že bychom nemuseli derivovat a dokonce pro celkovou změnu měli přesnou hodnotu a ne jenom odhad. Daň, kterou bychom za toto zaplatili by však byla velice krutá, jak plyne z následujícího výpočtu. Porovnejte přesný výpočet změny, ve kterém se odečítají dva zlomky s hodně odlišným jmenovatelem, s přibližným výpočtem změny, kde je jenom součin nebo podíl. Pokud takový výpočet není samostatný, ale součást dlouhého řetězce v komplikovanějším modelu, potom první zdánlivě jednodušší volba zpravidla vede k obrovskému nárůstu složitosti. Se součinem a podílem se pracuje opravdu lépe než s rozdílem zlomků. 

\section*{Lineární aproximace}

Uvažujem jednoduchou úlohu: máme dnes v roce 2021 strom o výšce jeden metr a víme, že roste rychlostí půl metru za rok. Chtěli bychom zjitit, jak bude vysoký v příštích letech. Není to pochopitelně nic složitého, v roce $x$, tj. za $x-2021$ let bude přírůstek $\frac 12 (x-2021)$ a celková výška $$1+\frac 12 (x-2021).$$

Jakkoliv se toto zdá být počítáním na prstech pro první stupeň základní školy, je to velice mocná metoda jak libovolnou funkci aproximovat pomocí funkce lineární. Potřebujeme k tomu výchozí funkční hodnotu, to u stromu byl jeden metr v roce 2021 a rychlost neboli derivaci funkce, což jsme měli půl metru za rok. Výsledná aproximace je bohužel jenom lokální, protože z rychlosti v jednom okamžiku nedokážeme determinovat celý budoucí vývoj. On ani náš strom neporoste za 50 let stejnou rychlostí jako na začátku. Proto je taková aproximace pouze lokální, platící v nějakém okolí výchozího bodu. I tak se jedná o velice užitečnou aproximaci, bez ketré by mnoho výpočtů v inženýrské praxi vůbec nebylo možno realizovat.

Obecný vzorec není nic jiného než zobecnění příkladu se stromem. Derivace jako odhaz změny na výstupu při jednotkové změně na vstupu se vynásobí změnou na vstupu a přičte k výchozí hodnotě. Formální vzorec vidíte na obrazovce a ještě jednou si můžete přečíst interpretaci jednotlivých částí tohoto vzorce.

Lineární aproximace nejsou nic nového, i některé běžné vzorce ve fyzice jsou vlastně lineárními aproximacemi obecnějších vztahů. Například vzorec $E=mgh$ pro potenciální energii je linearizací vztahu pro sílu v gravitačním poli blízko povrchu Země. Vzorec pro kinetickou energii $E=\frac 12 mv^2$ je zase linearizací obecnějšího relativistického vztahu, který obsahuje podíl se škaredou odmocninou a pro počítání s malými rychostmi opravdu vhodný není. Oba je možné odvodit z přibližného vzorce, který říká, že pro malá $x$ je n-tá mocnina čísla $x+1$ blízká hodnotě $1+nx.$

Představme si, že chceme napsat lineární aproximaci pro funkce v bodě $x_0=0$. To by například mohlo odpovídat tomu, že sledujeme reakci materiálu na relativně malý podnět, proto budeme psát aproximaci v nule. Bez podnětu není odezva, proto je rozumné doplnit další požadavek $f(0)=0$. Tím se nám lineární aproximace redukuje na přímou úměrnost mezi $f$ a $x$, kde konstanta úměrnosti je hodnota derivace v nule. To je neuvěřitelně zajímavé. Nemuseli jsme dělat žádné předpoklady, nemuseli jsme specifikovat zda sledujeme tok tepla vyvolaný nerovnoměrným rozložením teploty, zda sledujeme tok podzemní vody vyvolaný rozdílnými hladinami podzmení vody, zda sledujeme difzní tok vyvolaný různou koncentrací v různých částech materiálu. Žádný takový předpoklad jsme nepotřebovali.

Možná si vzpomenete, že na úvod minulé přednášky jsem říkal, že je to až k nevíře jak často si vystačíme při popisu přirodních dějů s přímou a nepřímou úměrností. Toto je jeden z důvodů -- mnoho vzorců použitých při popisu dějů okolo nás je vlastně lineární aproximací obecnějších vztahů. Jak může vypadat obecnější vztah máme například na obrázku pro deformaci materiálu silovým namáháním a vidíme zde zřetelně lineární náběh. Tuto lineární část známe z fyziky pod pojmem Hookův zákon a z obrázku je jasné to co víme i z fyziky, že tento zákon má své meze platnosti, kdy lineární aproximace selhává. Podobně se při studiu proudění podzemní vody sektají někteří z vás s Darcyho zákonem, při studiu pohybu vody ve dřevě s Fickovým zákonem, při studiu vedení tepla s Fourierovým zákonem. Všechny mají stejný tvar kdy ovezva je přímo úměrná podnětu a tato jednotnost je díky tomu, že se ve všech případech jedná a lineární aproximace obecnějších vztahů.

Geometricky je lineární aproxiamce rovnice přímky, která nejlépe aproximuje nějakou funkci a jedná se tedy o tečnu. Násobek u $x$ se nazývá směrnice a vidíme, že směrnice tečny je právě derivace. To je většinou klíčový bod použitý pro začátek studia derivací ve většině učebnic. Ti z vás co se s derivací setkali na střední škole pravděpodobně takový postup použili. My jsme se však snažili o praktičtější přístup. Málokdy nám totiž vytane na mysl užitečnost znalosti tečny ke grafu a její směrnice. Naproti tomu rychlost s jakou se něco děje je kriticky důležitá v modelování dějů probíhajících v čase a je v samém základu popisu mnoha dějů a jevů pozorovaných v přírodě.

\section*{Aproximace vyššího řádu}

V předcohzích pasážích jsme se seznámili s lienární aproximací. To je sice silná zbraň, ale na všechno nestačí. Například takové lasery bychom bez nelineární optiky nedokázali navhrnout a zkonstruovat. Nabízí se však využití derivace vyšších řádů. Zjendodušeně řečeno, kromě toho že použijeme informaci o funkční hodnotě ve výchozím bodě a rychlosti změny použijeme ještě další informace: jak rychle se mění rychlost, jak rychle se mění rychlost s jakou se mění rychlost a tak dále. Použijeme tedy derivace derivací, které nazýváme derivace vyššího řádu. Například druhá derivace je derivace derivace a pokud funkce udává polohu v čase, potom první derivace udává rychlost, druhá derivace zrychlení, třetí derivace rychlost změny zrychlení tedy takzvaný ryv a tak dále. Na obrazovce vidíte systém označování derivací vyššího řádu.

Praktické využití má zejména druhá derivace polohy podle času, protože je rovna zrychlení a podle Newtonova pohybového zákona je součin hmotnosti a zrychlení roven výsledné působící síle. Většinu úloh z mechaniky je možno díky redukovat na rovnice obsahující druhé derivace polohy. Pro nás prakticky využitelný může být například model průhybu nosníků, umožňující předpovídat deformace nosníků a tyto nosníky dostatečně dimenzovat proti selhání.  

Derivace vyššího řádu je možné využít k pečlivější aproximaci než je lokální aproximace. To je přirozené, pokud máme k dispozici více parametrů, můžeme kživku pomocí níž aproximujeme lépe přiohnout do požadovaného tvaru. Vzorec umožňující prvních $n$ derivací v bodě využít přímo pro lokální aproximaci funkce se nazývá Taylorův polynom a pochopitelně, lineární Taylorův polynom splývá s lineární aproximací.

Při vyjádření kvality aproximace se často setkáváme s takzvanou O notací. Pokud se se takový člen vyskytne ve vzorci, je tím myšlen člen úmerný argumentu.

Například v tomto vzorci pokud funkci $f$ aproximujeme polynomem stupně $n$ na pravé straně, bude výsledná chyby řádově rovna $x^{n+1}$. Je-li tedy $x$ v řádu desetin a $n=8$, potom chybu při aproximaci zaznamenáme až cca na devátém desetinném místě.


\section*{Konečné diference}

Derivace umíme počítat z analztickéoh předpisu, ale někdy je nutno vypočítat derivaci z naměřených hodont nebo vygenerovaných numerických dat. Jenoduchým postupem je nahradit derivaci jakožto okamžitou rychlost průměrnou rychlostí, tedy vynechat limitní přechod z definice derivace. Taková aproximace derivace pomocí průměrné rychlosti změny mezi současným a nejbližším následujícím bodem se naývá aproximace pomocí dopředné diference. Podobně je možno použít nejbližší předchozí bod a tím dostaneme zpětnou diferenci.

O něco sofistikovanějším postupem je uvažovat aproximace Taylorovým polynomem druhého stupně pro výrazy $f(x+h)$ a $f(x-h)$. Odečtením těchto vztahů se členy s druhou derivací odečtou a z výsledné rovnice je možno určit první derivaci vztahem který vidíte ve videu. Tato aproximace derivace se nazývá centrální diference a je přesnější než dopředná nebo zpětná a proto ji preferujeme vždy kdy je to možné. Důvod proč je tato aproximace přesnější spočívá v tom, že aproximace pomocí Taylorova polynomu druhého stupně je přesnější než aproximace tečnou, což by odovídalo postupu s vynecháním limity v definici derivace.

Podobně, když vztahy sečteme, vylučíme z nich první derivaci a dostaneme rovnici umožňující určit druhou derivaci. Tím dostaneme vzorec pro numerickou aproximaci druhé derivace nebo pro výpočet druhé derivace funkce dané v izolovaných bodech.

\section*{Řešení rovnic}

Častou úlohou je situace, kdy známe výsledek po aplikace nějaké funkce na vstupní data a chceme rekonstruovat tato vstupní data. Matematicky to znamená, že známe funkční hodnotu funkce a hledáme vzor. Pro tuto úlohu se vžilo označení řešení rovnic, kdy hledané vzory jsou neznámé v rovnici.

Ze široké škály situací se zaměříme na tu, kdy je zaručeno, že k výsledku existuje právě jeden vzor. Takové funkce se označují jako prosté funkce a u nich je jistota, že když je shoda na výstupu, je shoda i na vstupu, což vyjadřuje tato krátká věta.

Nyní víme, že u prostých funkcí je v principu možné vstupní data zpětně rekonstruovat ze známé funkční hodnoty, ale je otázka jak to udělat prakticky.

Máme tedy dánu funkci $f$ a funkční hodnotu $y$ a hledáme $x$ s vlastností $$f(x)=y.$$ Chápeme tento vztah jako rovnici s neznámou $x$. Protože u každo rovnice můžeme převést všechny členy na levou stranu a napravo bude nula, stačí se omezit na rovnice $$f(x)=0.$$ Tím se situace formálně zjednoduší.

Budeme se zabývat rovnicí, kdy na levé straně je nějaká funkce obsahující neznámou a na pravé straně je nula. Pokud by na pravé straně bylo nenulové číslo, převedeme ho na levou stranu a zahrneme do naší funkce nalevo. Obecně do tvaru kdy na pravé straně je nula můžeme dostat jakoukoliv rovnici a proto je tato metoda kterou si ukážeme zpravidla prezentována jako metoda řešení rovnic. Důležitým rysem je, že se jedná o numerickou metodu pro přibližné řešení. To znamená, že řešení bude zatíženo jistou nenulovou chybou, na druhou stranu však toto řešení může proběhnout na počítači a dokážeme takto vyřešit i rovnice typů, pro které přesné analytické řešení není k dispozici. Po svých autorech se nazývá Newtonova nebo Newtonova-Raphsonova metoda.

Postup vyžaduje počáteční odhad řešení. Ten získáme odhadem, graficky, hrubou silou případně jinou vhodnou metodou. Hlavní myšlenka metody je že v bodě sloužícím jako odhad řešení napíšeme lineární aproximaci a nahradíme funkci v rovnici touto lineární aproximací. Tím dostaneme lineární rovnici kterou je snadné vyřešit a získané řešení bude novým vylepšeným odhadem. Je to až k nevíře, ale tento systém neuvěřitelně rychle konverguje ke správnému řešení. Po provedení každého kroku se počet desetiných mist která jsou správne přibližně zdvojnásobí. Pro praktické provedení je vhodné použít přímo iterační vzorec získaný tak, že realizujeme popsané kroky pro nalezení souvislosti mezi dvěma po sobě jdoucími odhady řešení. Tedy napíšeme lineární aproximaci v bodě $x_n$ který reprezentuje $n$-tou aproximaci, nulový bod této přímky označíme $x_{n+1}$ a tento bod osamostatníme.

Například rovnice $$x=\cos x,$$ jakkoliv vypadá jednoduše, je velmi komlikovaná kvůli tomu, že jsou v relaci goniometrická funkce a polynom. Můžeme však rovnici zdolat numericky. Převedeme vše na jednu stranu, použijeme funkci definavaou levou stranou a pomocí této funkce a její derivace sestavíme iterační vzorec. Poté do tohoto vzorce dosadíme počáteční odhad jedničku, výsledek opět dosadíme do tohoto vzorce a postup opakujeme stále dokola. Evidentně se pro tuto úlohu hodí naprogramovat si kratičký cyklus v nějakém skriptovacím jazyce, já jsem použil Python protože má rozhraní přístupné přímo z webového prohlížeče.

A když už máme za sebou iterační vzorec pro Newtonovu metodu, je vhodné zmínit, že jsou i další možnosti. Někdy stačí rovnici jakýmkoliv způsobem převést do tvaru $$x=f(x)$$ a vyzkoušet iterační proces $x_{n+1}=f(x_n)$. Pokud konverguje, tj. pokud $x_n$ a $x__{n+1}$ jsou si stále blíže, dostaneme takto řešení rovnice. Konvergence je nejistá a pomalejší než u Newtonovy metody, ale i tak to může být cesta. Můžeme si to prohlédnout na rovnici z příkladu, kde osamostatníme $x$ a odvozený vztah použijeme jako východisko pro iterační vzorec. Po deseti krocích se první tři desetinná čísla nemění. Jakýsi výsledek to je, ve srovnání se super rychlou konvergencí Newtonovy metody to vypadá jako slabota, ale například jsme vůbec nepotřebovali derivaci. A vlastně ani žádný aparát, který by nebyl k dispozici již na základní škole.

\end{document}
