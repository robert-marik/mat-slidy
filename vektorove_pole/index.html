<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Robert Mařík" />
  <title>Vektorová pole, tok, zákony zachování</title>
  <style type="text/css">code{white-space: pre;} body {  font-family: "Open Sans", Sans-Serif;}</style>
<link href="../lity/dist/lity.css" rel="stylesheet">
  <link rel="stylesheet" href="../my.css?123" type="text/css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../lity/dist/lity.js"></script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  

 <script type="text/javascript">

function otevrit(co)
   {
       seed=Math.round(Math.random()*1000);
       window.open('http://um.mendelu.cz/webwork2/html2xml?&answersSubmitted=0&sourceFilePath='+co+'&problemSeed='+seed+'&displayMode=MathJax&courseID=daemon&userID=demon&course_password=demonek&outputformat=simpleM&language=cs_CZ', '_blank');
   };

function    myFunctionYTB()
    {
        //jQuery(".reseni").slideToggle();
	jQuery(".Ycontainer").slideToggle();
    }
        

  </script>

</head>
<body>

  <div class='menu-obalka'>
    <a class='menu menu4' href='../../'>Matematika</a><a class='menu menu4 ACTIVE' href='../'>Přednáška</a><a class='menu menu4' href='../cviceni'>Cvičení</a><a class='menu menu4' href='https://um.mendelu.cz/'>WeBWorK</a>
  </div>
	
 <div class='menu-obalka'><a class='menu' href='../intro'>0</a><a class='menu  ' href='../derivace_I'>1</a><a class='menu  ' href='../derivace_II'>2</a><a class='menu  ' href='../derivace_III'>3</a><a class='menu  ' href='../integraly'>4</a><a class='menu  ' href='../integraly2'>5</a><a class='menu  ' href='../ode'>6</a><a class='menu  ' href='../matice'>7</a><a class='menu  ' href='../inverzni_matice'>8</a><a class='menu  ' href='../soustavy'>9</a><a class='menu ACTIVE ' href='../vektorove_pole'>10</a><a class='menu  ' href='../dvojny_integral'>11</a><a class='menu  ' href='../numerika'>12</a><a class='menu  ' href='../shrnuti'>13</a> </div> 

<div class="container">
<div id="header">
<h1 class="title">Vektorová pole, tok, zákony zachování</h1>
<h2 class="author">Robert Mařík</h2>
<h3 class="date">2019-2021</h3>
</div>

<!-- YTB -->


<div>
<button onclick="myFunctionYTB()">Videa on/off</button>
<button onclick="jQuery('.shorten').css('display','none');">Volitelné části off</button>
</div>


<div id="TOC">
<ul>
<li><a href="#připomenutí-derivací">Připomenutí derivací</a><ul>
<li><a href="#obyčejná-derivace-fracmathrm-dfmathrm-dt.">(Obyčejná) derivace <span class="math inline">\(\frac{\mathrm df}{\mathrm dt}\)</span>.</a></li>
<li><a href="#parciální-derivace-fracpartial-fpartial-t-fracpartial-fpartial-x-dots.">Parciální derivace <span class="math inline">\(\frac{\partial f}{\partial t}\)</span>, <span class="math inline">\(\frac{\partial f}{\partial x}\)</span>, <span class="math inline">\(\dots\)</span>.</a></li>
</ul></li>
<li><a href="#transportní-jevy">Transportní jevy</a></li>
<li><a href="#tok-a-gradient-v-konstitutivních-zákonech">Tok a gradient v konstitutivních zákonech</a></li>
<li><a href="#vícerozměrné-konstitutivní-zákony">Vícerozměrné konstitutivní zákony</a><ul>
<li><a href="#fickův-zákon-difuze">Fickův zákon (difuze)</a></li>
<li><a href="#darcyho-zákon-proudění-podzemní-vody">Darcyho zákon (proudění podzemní vody)</a></li>
<li><a href="#fourierův-zákon-vedení-tepla">Fourierův zákon (vedení tepla)</a></li>
<li><a href="#soretův-efekt-termodifuze">Soretův efekt (termodifuze)</a></li>
</ul></li>
<li><a href="#speciální-případy-vztahu-mezi-gradientem-a-tokem">Speciální případy vztahu mezi gradientem a tokem</a><ul>
<li><a href="#obecný-případ-anizotropní">Obecný případ (anizotropní)</a></li>
<li><a href="#ortotropní-případ-vhodně-zvolené-osy">Ortotropní případ, vhodně zvolené osy</a></li>
<li><a href="#ortotropní-případ-ve-2d">Ortotropní případ ve 2D</a></li>
<li><a href="#izotropní-případ">Izotropní případ</a></li>
</ul></li>
<li><a href="#divergence">Divergence</a></li>
<li><a href="#výpočet-gradientu-a-divergence">Výpočet gradientu a divergence</a></li>
<li><a href="#rovnice-kontinuity">Rovnice kontinuity</a></li>
<li><a href="#rovnice-mělké-vody">Rovnice mělké vody</a></li>
<li><a href="#proudění-tekutiny-v-mechanice-kontinua">Proudění tekutiny v mechanice kontinua</a></li>
<li><a href="#difuzní-rovnice">Difuzní rovnice</a></li>
<li><a href="#vedení-tepla">Vedení tepla</a></li>
<li><a href="#voda-v-porézním-materiálu">Voda v porézním materiálu</a></li>
<li><a href="#rovnice-podzemní-vody">Rovnice podzemní vody</a></li>
<li><a href="#rovnice-vedení-tepla-ve-2d-v-různých-podmínkách">Rovnice vedení tepla ve 2D v různých podmínkách</a><ul>
<li><a href="#stacionární-stav">Stacionární stav</a></li>
<li><a href="#homogenní-izotropní-materiál-a-lineární-materiálové-vztahy">Homogenní izotropní materiál a lineární materiálové vztahy</a></li>
<li><a href="#ortotropní-materiál-nehomogenní-nebo-nelineární">Ortotropní materiál, nehomogenní nebo nelineární</a></li>
<li><a href="#homogenní-ortotropní-materiál-a-lineární-materiálové-vztahy">Homogenní ortotropní materiál a lineární materiálové vztahy</a></li>
</ul></li>
<li><a href="#umění-identifikace-předpokladů-z-tvaru-difuzní-rovnice">Umění identifikace předpokladů z tvaru difuzní rovnice</a></li>
<li><a href="#shrnutí-hlavní-myšlenky">Shrnutí, hlavní myšlenky</a></li>
<li><a href="#shrnutí-více-matematickou-formou">Shrnutí více matematickou formou</a></li>
<li><a href="#praktická-aplikace-zajímavost-z-jiné-oblasti-než-nauky-o-materiálu">Praktická aplikace (zajímavost z jiné oblasti než nauky o materiálu)</a></li>
</ul>
</div>

<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/DonzhFhcyQ4"></iframe> </div>
<h1 id="připomenutí-derivací">Připomenutí derivací</h1>

<div style="padding-left:40%;font-style:italic;color:gray">
<p>Každá věda se od určité úrovně automaticky stává částí matematiky. (David Hilbert, německý matematik.)</p>
</div>

<p>Derivace umožňují studovat a popisovat změny veličin, vyjadřovat kvantitativně jejich vzájemné souvislosti.</p>
<h2 id="obyčejná-derivace-fracmathrm-dfmathrm-dt.">(Obyčejná) derivace <span class="math inline">\(\frac{\mathrm df}{\mathrm dt}\)</span>.</h2>
<ul>
<li>S touto derivací se pracuje u funkce jedné proměnné <span class="math inline">\(f(t)\)</span>. Např. <span class="math inline">\(f(t)=kt^2\)</span>, kde <span class="math inline">\(k\)</span> je parametr (reálné číslo).</li>
<li>Derivace je okamžitá rychlost změny veličiny <span class="math inline">\(f\)</span> vzhledem k <span class="math inline">\(t\)</span>, tj. nárůst veličiny <span class="math inline">\(f\)</span> vyvolaný jednotkovým nárůstem veličiny <span class="math inline">\(t\)</span>. (Prakticky však veličinu <span class="math inline">\(t\)</span> změníme o malou hodnotu a nárůst přepočítáme na jednotkovou změnu.)</li>
<li>Jednotka derivace je stejná, jako bychom veličiny <span class="math inline">\(f\)</span> a <span class="math inline">\(t\)</span> dělili.</li>
<li>V modelech a při praktickém využití pracujeme s definicí derivace jako s rychlostí změny. Při výpočtu ale využíváme dostupné vzorce pro výpočet derivace. Například pro funkci z prvního bodu platí <span class="math inline">\(\frac{\mathrm df}{\mathrm dt}=2kt.\)</span></li>
</ul>
<h2 id="parciální-derivace-fracpartial-fpartial-t-fracpartial-fpartial-x-dots.">Parciální derivace <span class="math inline">\(\frac{\partial f}{\partial t}\)</span>, <span class="math inline">\(\frac{\partial f}{\partial x}\)</span>, <span class="math inline">\(\dots\)</span>.</h2>
<ul>
<li>S touto derivací se pracuje u funkce více proměnných, typicky <span class="math inline">\(f(x,y,z,t)\)</span>. Např. <span class="math inline">\(f(x,y,z,t)=xt^2\)</span></li>
<li>Jedná se o obyčejnou derivaci podle jedné proměnné, přičemž ostatní proměnné považujeme za parametry. Tj. v případě funkce z minulého bodu je <span class="math inline">\(\frac{\partial f}{\partial t}=2xt\)</span>, <span class="math inline">\(\frac{\partial f}{\partial x}=t^2\)</span>, <span class="math inline">\(\frac{\partial f}{\partial y}=\frac{\partial f}{\partial z}=0\)</span>.</li>
<li>Pro jednotku a výpočet platí totéž co u obyčejné derivace.</li>
<li>Při aplikacích často pracujeme s gradientem, tj. s vektorem sestaveným z parciálních derivací podle jednotlivých prostorových proměnných. Pro funkci tří proměnných <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> a <span class="math inline">\(z\)</span> a pro potřeby matematické formulace fyzikálních zákonů gradient uvažujeme jako sloupcový vektor <span class="math display">\[\nabla f =\begin{pmatrix}\frac{\partial f}{\partial x}\\\mathstrut \frac{\partial f \mathstrut}{\partial y \mathstrut}\\\frac{\partial f}{\partial z}\end{pmatrix}.\]</span> Pro úsporu místa jej někdy píšeme v transponovaném tvaru <span class="math display">\[\nabla f =\left(\frac{\partial f}{\partial x},\frac{\partial f}{\partial y},\frac{\partial f}{\partial z}\right)^T.\]</span> Gradient je vektor, který má směr odpovídající směru nejrychlejšího růstu skalární veličiny a velikost odpovídá změně veličiny na jednotku délky.</li>
</ul>
<h1 id="transportní-jevy">Transportní jevy</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/ULoUeHincbM"></iframe> </div>

<div class="obtekat">
<figure>
<img src="3d_pole.png" alt="Pro popis proudění je vhodné vektorové pole. Zde je ve 3D a vykreslené v náhodných bodech v prostoru." /><figcaption>Pro popis proudění je vhodné vektorové pole. Zde je ve 3D a vykreslené v náhodných bodech v prostoru.</figcaption>
</figure>
</div>

<p>Pochopení a modelování transportních dějů je důležité pro většinu technických oborů. Podstata těchto dějů je často odlišná, přesto mají navenek podobné chování a tím je umožněn jednotný přístup při matematickém modelování.</p>
<p>Příklady veličin podléhajících transportním dějům</p>
<ul>
<li>povrchová voda</li>
<li>podzemní voda</li>
<li>teplo</li>
<li>voda ve dřevě</li>
</ul>
<p>Obecná bilance veličiny, která má zdroje a spotřebiče a je přenášena tokem vypadá následovně.</p>
<ul>
<li>Existuje veličina, spojitě rozložená v prostoru, charakterizující stav systému. Tuto veličinu budeme nazývat <em>stavovou veličinou</em> a její hustotu označíme <span class="math inline">\(u\)</span>.</li>
<li>Stavová veličina se může v prostoru přemisťovat <em>tokem</em> <span class="math inline">\(\vec  \jmath\)</span>.</li>
<li>Stavová veličina může vznikat a zanikat. <em>Zdroje</em> i <em>spotřebiče</em> budeme uvažovat společně a jejich vydatnost rozlišíme znaménkem: spotřebiče budou zdroje se zápornou vydatností. Celkovou vydatnost zdrojů a spotřebičů v daném místě, tj. množství veličiny vygenerované na jednotku objemu (nebo plochy, nebo délky, podle počtu dimenzí v úloze) za jednotku času, označíme <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<p>Zákon zachování (se zohledněním toku a zdrojů) je vlastně celková bilance stavové veličiny. Přirozeným jazykem je možno tuto bilanci formulovat následovně.</p>
<blockquote><p>Přírůstek množství veličiny je součtem přírůstku ze zdrojů a přírůstku způsobeného tokem.</p>
</blockquote>
<p>Toto je jednoduchý, ale přitom neuvěřitelně silný nástroj, který umožní popsat řadu zcela odlišných dějů. Pro použití v matematickém modelu ale musíme jednotlivé pojmy kvantifikovat. Měřit rychlost, s jakou se mění množství veličiny v daném místě umíme pomocí derivace podle času. Měřit změny v toku přenášejícím sledovanou veličinu jsme se naučili jako jednu z aplikací parciálních derivací: jedná se o záporně vzatou derivaci podle prostorové proměnné vynásobenou fyzikální materiálovou konstantou. Ještě se musíme naučit měřit intenzitu toku a její změny ve dvou nebo třech dimenzích.</p>
<h1 id="tok-a-gradient-v-konstitutivních-zákonech">Tok a gradient v konstitutivních zákonech</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/xUhAudBfGLo"></iframe> </div>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (konstitutivní zákony).</p><p> V aplikacích často formulujeme zákony nebo vztahy mezi fyzikálními veličinami specifickými pro danou látku nebo materiál a udávají odezvu tohoto materiálu na externí stimul. Tyto zákony se nazývají <em>konstitutivní zákony</em> a formulujeme je pomocí gradientu a toku vektorového pole. Viz též <a href="https://en.wikipedia.org/wiki/Constitutive_equation">Wikipedie</a>.</p>
</blockquote>

<div class="obtekat">
<figure>
<img src="vitr.jpg" alt="Tok si snadno představíme mechanickým modelem. Například větru nebo vody. Zdroj: pixabay.com" /><figcaption>Tok si snadno představíme mechanickým modelem. Například větru nebo vody. Zdroj: pixabay.com</figcaption>
</figure>
</div>

<p>Například vítr (tok molekul vzduchu) je vyvolán nerovnoměrným rozložením vzduchu (jeho hustoty a tím i tlaku) v prostoru a směřuje z míst s vyšším tlakem do míst s tlakem nižším. Větší rozdíl tlaků způsobí “větší vítr” a tím větší tok vzduchu. Toto platí i pro jiné proudění, jak ukážeme dále.</p>
<p>Nerovnoměrnost v prostorovém rozložení charakterizuje gradient. V ustáleném stavu je pro široké rozmezí fyzikálních problémů závislost intenzity toku na gradientu lineární. A protože nulovému gradientu (nulovému stimulu) odpovídá nulový tok (nulová odezva), bude tato lineární funkce přímou úměrností.</p>
<p>V dalším shrneme důležité praktické příklady, kdy je tok úměrný gradientu. Konstanta úměrnosti je obecně pouze konstantou pro daný problém a dané hodnoty parametrů. Může se měnit s velikostí studovaného objektu (například obsah průřezu geologické vrstvy, kterou proudí voda), s fyzikálními vlastnostmi proudící látky (např. viskozita nebo hustota tekutiny, stlačitelnost vzduchu), s fyzikálními vlastnostmi prostředí (např. velikost pórů v pórovitém prostředí nebo vlhkost dřeva). Proto je možné tyto zákony najít v různých tvarech, s různými členy a případnými přídavnými konstantami, které například odseparují vliv vlastností proudící látky a vliv vlastností prostředí. Vždy záleží na konkrétní situaci, zvyklostech v příslušném podoboru, nebo na přístupu autora. Není proto naší ambicí vést výklad dopodrobna, všímejme si jenom základních myšlenek.</p>
<h1 id="vícerozměrné-konstitutivní-zákony">Vícerozměrné konstitutivní zákony</h1>
<p>Zákony uvedené níže byly často odvozeny v jednorozměrném případě a letmo zmíněny v přednášce <a href="../aproximace">Derivace II</a>. V moderní formulaci používáme obecný vektorový zápis, který zohledňuje i směr. Konstanta úměrnosti potom zprostředkovává vztah mezi dvěma vektory. Jedná se tedy z matematického pohledu o matici, která umožní nejenom změnit délku vektoru a jeho jednotku, ale i směr. Tato matice se navíc při změně báze transformuje speciálním způsobem, tak jako vektory. Takové objekty nazýváme <strong>tenzory</strong>. Níže budeme pojmem tenzor rozumět matici <span class="math inline">\(3\times 3\)</span> nebo <span class="math inline">\(2\times 2\)</span>, podle kontextu. (Obecněji je možno považovat skalární veličiny a vektory za tenzory nižších řádů, toto my však dělat nebudeme.)</p>
<p><a href="https://sagecell.sagemath.org/?z=eJxlT89ugyAcvpv4DqSpEVvs1K2Xpexkeu5h2cV1hlmorCgN0E76TnuKvdhQu6zJOPwI34_vH4MdshHOZt1bNr-fWTc738txQ4ziHSyKJUq2qEhQut1GvmfkAcf5jC32iuw4bQ0sHL_fNPRCO-zU4sUSZYvlFbIYWhSnKHPvWjhOa_FD4nu6lp-wNo2Ak1WdPb0obei55RUFBDiT1Z0DwfrUHir6CKaAjTFBoMF0EgBBDO3gCLpzK6fCnLPTpf3-Aq4DH-g5DvQ0DEZW_o_wLA_uU5y_tuRdkF-vG4oL9GflextcydbIkyqPQhrI0NB9mBaB607ja12HNOSIww9qQgQYFwKvidA06oU2816iPNPKSFUyTsWud0NglBwuO5gOgTe9wF7zC8VpggDRR0cslespcRr9AMQpj4Y=&amp;lang=sage&amp;interacts=eJyLjgUAARUAuQ==">Vizualizace toku a vrstevnic pro anizotropní materiál, kdy tok není vždy kolmý na směr maximálního spádu stavové veličiny.</a></p>
<h2 id="fickův-zákon-difuze">Fickův zákon (difuze)</h2>
<p>V roce 1855 německý lékař A. Fick objevil, že difuzní tok <span class="math inline">\(\vec J\)</span> (množství látky které projde při difuzi jednotkovou plochou za jednotku času) je úměrný gradientu koncentrace <span class="math inline">\(c\)</span> této látky. Matematicky vyjádřeno pomocí moderní terminologie to znamená, že platí <span class="math display">\[\vec J=-D\nabla c. \]</span> Veličina <span class="math inline">\(D\)</span> se nazývá difuzní koeficient. Pokud má <span class="math inline">\(\vec J\)</span> stejný směr jako <span class="math inline">\(\nabla c\)</span>, je <span class="math inline">\(D\)</span> skalární veličina. Pokud směry nejsou stejné, je <span class="math inline">\(D\)</span> tenzor. Z fyzikálních důvodů je tenzor <span class="math inline">\(D\)</span> symetrický.</p>
<p>Difuzí se například dřevo zbavuje vlhkosti při vysoušení.</p>
<h2 id="darcyho-zákon-proudění-podzemní-vody">Darcyho zákon (proudění podzemní vody)</h2>

<div class="obtekat">
<figure>
<img src="karany.jpg" alt="Vodárna Káraný infiltruje vodu do podzemí. Znalost, co se tam s vodou děje a kudy a jak teče je nezbytná. Základním zákonem pro popis tohoto děje je Darcyho zákon. Zdroj: nase-voda.cz, Nina Havlová" /><figcaption>Vodárna <a href="http://www.vodarnakarany.cz/">Káraný</a> infiltruje vodu do podzemí. Znalost, co se tam s vodou děje a kudy a jak teče je nezbytná. Základním zákonem pro popis tohoto děje je Darcyho zákon. Zdroj: nase-voda.cz, Nina Havlová</figcaption>
</figure>
</div>

<p>V letech 1855 a 1856 francouzský inženýr H. Darcy pokusy prokázal přímou úměru mezi rozdílem tlaků na koncích trubice naplněné porézní zeminou (jednalo se vlastně o rozdíl výšek pro šikmou trubici) a rychlostí proudění vody touto trubicí. Tok (množství vody, která proteče jednotkovou plochou za jednotku času) je dán vztahem <span class="math display">\[\vec q=-K\nabla p,\]</span> kde <span class="math inline">\(p\)</span> je tlak a <span class="math inline">\(K\)</span> je koeficient vodivosti (někdy též koeficient filtrace), v obecném případě symetrický tenzor, v izotropním případě, kdy <span class="math inline">\(\vec q\)</span> a <span class="math inline">\(\nabla p\)</span> mají stejný směr, veličina skalární.</p>
<p>Někdy se tento zákon neformuluje pomocí gradientu tlaku, ale pomocí gradientu jiné veličiny, kterou zavádíme v hydrologii pro názorné studium efektů, souvisejících s prouděním vody. Nejčastěji se jedná o <em>vodní potenciál</em> a hydraulickou výšku či <a href="https://cs.wikipedia.org/wiki/Hladina_podzemn%C3%AD_vody">piezometrickou hladinu</a>. Piezometrická hladina je veličina používaná k tomu, abychom do jednoho jednoduše modelovatelného faktoru (má rozměr stejný jako délka) započítali všechny veličiny mající vliv na proudění podzemní vody, od rozdílu nadmořských výšek, přes kapilární a osmotické jevy až po vnější síly vyvolané tlakem geologických vrstev a jiné. Jedná se vlastně o celkovou energii vody s tím, že některé části považujeme za zanedbatelné. Například často neuvažujeme kinetickou energii nebo osmózu a kapilární jevy.</p>
<h2 id="fourierův-zákon-vedení-tepla">Fourierův zákon (vedení tepla)</h2>

<div class="obtekat">
<figure>
<img src="rozhrani.png" alt="Na hranici tělesa je tok tepla dán okrajovou podmínkou vyjádřenou Fourierovým zákonem. Zdroj: Cengel, Ghajar: Heat and Mass Transfer." /><figcaption>Na hranici tělesa je tok tepla dán okrajovou podmínkou vyjádřenou Fourierovým zákonem. Zdroj: Cengel, Ghajar: Heat and Mass Transfer.</figcaption>
</figure>
</div>

<p>Fourierův zákon se týká vedení tepla a vyjadřuje, že vektor hustoty tepelného toku <span class="math inline">\(\vec q\)</span> vyvolaného gradientem teploty <span class="math inline">\(\nabla T\)</span> je dán vztahem <span class="math display">\[\vec q=-k\nabla T.\]</span> Je-li materiál anizotropní, což je nejobecnější případ, je veličina <span class="math inline">\(k\)</span> symetrickým tenzorem. Je-li materiál izotropní, je <span class="math inline">\(k\)</span> skalární veličinou, případně skalární veličina násobená jednotkovou maticí, pokud potřebujeme zachovat její maticový charakter.</p>
<h2 id="soretův-efekt-termodifuze">Soretův efekt (termodifuze)</h2>
<p>Tok tepla je vyvolaný nerovnoměrným rozložením teploty. Difuze chemické látky je vyvolána nerovnoměrným rozložením koncentrace této látky. Většinou je hybatelem procesu nerovnoměrnost v rozložení látky, která se tímto procesem transportuje. Nemusí to však být vždy. Příkladem je termodifuze, což je pohyb prvků vyvolaný nerovnoměrným rozložením teploty. Například při difúzi vody ve dřevě s nerovnoměrným rozložením teploty je tok dán vztahem <span class="math display">\[\vec J=-D\nabla c - sD\nabla T, \]</span> kde <span class="math inline">\(s\)</span> je koeficient termodifuze.</p>
<p>Rozeznáváme kladný a záporný Soretův efekt. Při kladném dochází k transportu ve směru klesající teploty, při záporném naopak ve směru rostoucí teploty. Te je v kontrastu s ostatními konstitutivními zákony, kde tok proudí vždy jenom do míst s menší hustotou stavové veličiny. Viz Wikipedia a heslo Thermophoresis. Viz Wikipedia a heslo Thermophoresis.</p>
<h1 id="speciální-případy-vztahu-mezi-gradientem-a-tokem">Speciální případy vztahu mezi gradientem a tokem</h1>

<div class="obtekat">
<figure>
<img src="rezistory.png" alt="Formálně jsou všechny konstitutivní zákony stejné a jsou stejné i jako zákon mezi elektrickým proudem a napětím. Proto je možné izolační vrstvy modelovat pomocí elektrických obvodů, rezistorů a vzorců pro jejich spojování z Ohmova zákona. Na obrázku je řez stěnou z dutých cihel a izolace. Zdroj: Cengel, Ghajar: Heat and Mass Transfer." /><figcaption>Formálně jsou všechny konstitutivní zákony stejné a jsou stejné i jako zákon mezi elektrickým proudem a napětím. Proto je možné izolační vrstvy modelovat pomocí elektrických obvodů, rezistorů a vzorců pro jejich spojování z Ohmova zákona. Na obrázku je řez stěnou z dutých cihel a izolace. Zdroj: Cengel, Ghajar: Heat and Mass Transfer.</figcaption>
</figure>
</div>

<p>Uvažujme vztah mezi gradientem a tokem ve tvaru <span class="math display">\[\vec j=-K\nabla u
,\]</span> kde <span class="math inline">\(K\)</span> je symetrický tenzor. Gradient má ve trojrozměrném případě vyjádření <span class="math display">\[\nabla u  =\left(\frac{\partial u }{\partial x},\frac{\partial u }{\partial y},\frac{\partial u }{\partial z}\right)^T\]</span> a ve 2D <span class="math display">\[\nabla u  =\left(\frac{\partial u }{\partial x},\frac{\partial u }{\partial y}\right)^T,\]</span> kde horní index <span class="math inline">\(T\)</span> značí transponovanou matici, tj. jedná se o sloupcový vektor.</p>
<h2 id="obecný-případ-anizotropní">Obecný případ (anizotropní)</h2>
<p>Veličina <span class="math inline">\(K\)</span> je matice <span class="math display">\[K=
\begin{pmatrix}
  k_{11}&amp; k_{12} &amp; k_{13}\\
  k_{21}&amp; k_{22} &amp; k_{23}\\
  k_{31}&amp; k_{32} &amp; k_{33}
\end{pmatrix}
\]</span> jejíž komponenty splňují <span class="math inline">\(k_{ij}=k_{ji}\)</span>. Často jsou všechny veličiny kladné a prvky v hlavní diagonále jsou dominantní.</p>
<p>Komponenty vektoru <span class="math inline">\(\vec j=(j_x, j_y, j_z)^T\)</span> jsou <span class="math display">\[
\begin{aligned}
  j_x&amp;=-k_{11}\frac{\partial u }{\partial x}-k_{12}\frac{\partial u }{\partial y}-k_{13}\frac{\partial u }{\partial z},\\
  j_y&amp;=-k_{21}\frac{\partial u }{\partial x}-k_{22}\frac{\partial u }{\partial y}-k_{23}\frac{\partial u }{\partial z},\\
  j_z&amp;=-k_{31}\frac{\partial u }{\partial x}-k_{32}\frac{\partial u }{\partial y}-k_{33}\frac{\partial u }{\partial z},
\end{aligned}
\]</span> což zjistíme prostým maticovým násobením. Prostor pro další úpravu není.</p>
<h2 id="ortotropní-případ-vhodně-zvolené-osy">Ortotropní případ, vhodně zvolené osy</h2>

<div class="obtekat">
<figure>
<img src="lepenka.jpg" alt="Ortotropní materiál je typicky materiál z jednotlivých vrstev. Typicky dřevo, půda z různých vrstev, lepenka. Zdroj: pixabay.com" /><figcaption>Ortotropní materiál je typicky materiál z jednotlivých vrstev. Typicky dřevo, půda z různých vrstev, lepenka. Zdroj: pixabay.com</figcaption>
</figure>
</div>

<p>V obecném případě je zpravidla možné transformovat soustavu souřadnic tak, aby tenzor <span class="math inline">\(K\)</span> byl diagonální. Pro praktické výpočty se toto však často nevyplatí. Pokud však je studovaný problém ortotropní, má charakteristické směry (přesněji, má tři roviny symetrie materiálových vlastností), je možné zvolit souřadnice v souladu s těmito směry a matice <span class="math inline">\(K\)</span> je diagonální.</p>
<p><span class="math display">\[K=
\begin{pmatrix}
  k_{11}&amp; 0 &amp; 0\\
 0&amp; k_{22} &amp; 0\\
  0&amp; 0 &amp; k_{33}
\end{pmatrix}
\]</span></p>
<p>Komponenty vektoru <span class="math inline">\(\vec j\)</span> jsou <span class="math display">\[
\begin{aligned}
  j_x&amp;=-k_{11}\frac{\partial u }{\partial x},\\
  j_y&amp;=-k_{22}\frac{\partial u }{\partial y},\\
  j_z&amp;=-k_{33}\frac{\partial u }{\partial z}.
\end{aligned}
\]</span></p>
<p>S diagonální maticí se pracuje velmi dobře, protože má v hlavní diagonále vlastní čísla. Tato vlastní čísla jsou fyzikální charakteristikou úlohy. Například největší vlastní číslo a odpovídající vlastní směr charakterizují směr, ve kterém je odezva materiálu na vnější podnět maximální a vlastní číslo udává velikost této reakce. Tyto fyzikální charakteristiky nemohou být závislé na volbě souřadné soustavy, ve které úlohu popisujeme. Co se mění s volbou souřadné soustavy jsou pouze souřadnice vlastního vektoru. Vlastní čísla jsou však skalární a proto jsou invariantní při otočení soustavy souřadnic. Pokud bychom neměli možnost zvolit soustavu souřadnic tak, aby matice byla diagonální, máme alespoň jistotu, že vlastní čísla zůstanou stejná.</p>
<h2 id="ortotropní-případ-ve-2d">Ortotropní případ ve 2D</h2>
<p>Stejné jako ve 3D, pouze chybí třetí rovnice.</p>
<h2 id="izotropní-případ">Izotropní případ</h2>
<p>Stejné jako ortotropní případ, ale navíc platí <span class="math inline">\(k_{11}=k_{22}=k_{33}=k.\)</span> Potom <span class="math inline">\(\vec j=-k\nabla u\)</span>, kde <span class="math inline">\(k\)</span> je konstanta a vektory toku a gradientu mají opačný směr.</p>
<h1 id="divergence">Divergence</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/wrYpaPerg3M"></iframe> </div>

<div class="obtekat">
<figure>
<img src="divergence.png" alt="Divergence a tok pole \vec q=(0,Q, R) tělesem nenulového objemu. Tok je zobrazen vždy ve středu stěny. Červené vektory vstupují do krychle a příslušné toky se počítají záporně. Modré vystupují ven a počítají se kladně. V tomto případě je celková bilance kladná, z objemu více vyteče, než vteče dovnitř. Divergence je kladná. Pokud v krychli množství veličiny neubývá, musí tam být zdroj této veličiny." /><figcaption>Divergence a tok pole <span class="math inline">\(\vec q=(0,Q, R)\)</span> tělesem nenulového objemu. Tok je zobrazen vždy ve středu stěny. Červené vektory vstupují do krychle a příslušné toky se počítají záporně. Modré vystupují ven a počítají se kladně. V tomto případě je celková bilance kladná, z objemu více vyteče, než vteče dovnitř. Divergence je kladná. Pokud v krychli množství veličiny neubývá, musí tam být zdroj této veličiny.</figcaption>
</figure>
</div>

<p>Budeme sledovat tok vektorového pole a bude nás zajímat, o kolik se tok v daném místě mění.</p>
<ul>
<li>Pro jednoduchost rozdělíme tok na tři nezávislé části ve směru jednotlivých os a vztáhneme vše k jednotkám času a průřezu, tj. budeme uvažovat hustotu toku nějaké fyzikální veličiny.</li>
<li>Je-li tato hustota toku popsána vektorovým polem <span class="math inline">\(\vec q=(P,Q,R)\)</span> v jednotkách kilogram na metr čtvereční za sekundu, znamená to, že kolmým průřezem jednotkového obsahu projde za jednotku času <span class="math inline">\(P\)</span> kilogramů sledované látky, jejíž tok popisujeme. Často se pracuje i s objemovým tokem, kdy množství neměříme v kilogramech ale v metrech krychlových a například při ustáleném proudění v trubici (hydrodynamika) je tok roven vektoru rychlosti a při proudění porézním materiálem (proudění podzemní vody) je roven filtrační rychlosti.</li>
<li>Derivace <span class="math inline">\(\frac{\partial P}{\partial x}\)</span> udává, o kolik studovaný tok v daném místě vzroste ve směru osy <span class="math inline">\(x\)</span> a tento nárůst je vztažený na jednotku délky.</li>
<li>Ve směru osy <span class="math inline">\(y\)</span> máme tok vyjádřený veličinou <span class="math inline">\(Q\)</span> a proto nás podobně zajímá <span class="math inline">\(\frac{\partial Q}{\partial y}\)</span>.</li>
<li>Analogicky <span class="math inline">\(\frac{\partial R}{\partial z}\)</span>.</li>
<li>Celková změna toku bude součtem všech tří příspěvků. Pokud je kladná, znamená to, že z daného místa více veličiny vytéká, než kolik teče dovnitř. Pokud je záporná, je tomu naopak. Jestli se v případě nerovnováhy v daném místě může proudící veličina tvořit nebo spotřebovávat nebo akumulovat nebo jestli v daném místě může ubývat z tohoto rozboru nezjistíme. Záleží na charakteru proudící veličiny a na okolnostech s tímto prouděním spojených. Tuto informaci nám pro další popis musí dodat externí věda (obecná fyzika, fyzika materiálu, fyzika životního prostředí, hydrologie, pedologie, …).</li>
<li>Při preciznější argumentaci dávající do souvislosti parciální derivace jednotlivých komponent toku s tím, co se reálně s vektorovým polem děje, je nutné si pomoci stejně jako u derivací, tj. uvažovat ne dané místo, ale jistý konečně velký objem (viz obrázek), vztáhnout dané veličiny na jednotku objemu a rozměry tohoto objemu limitně stáhnout k nule. Toto však již přesahuje ambice v našem kurzu a jedná se o formalismus, kterému se vyhneme přímým představením hotového výsledku.</li>
</ul>
<!--
Budeme sledovat tok vektorového pole ze zvoleného 
místa. Vyjádříme bilanci, o kolik je větší tok vektorového pole z daného místa ven ve srovnání s tokem tohoto pole dovnitř (viz krychlička na obrázku). Protože
záleží na objemu, ve kterém tok sledujeme, je  vztáhneme tento tok na
jednotku objemu.

Fyzikálně tok ven uvažujeme jako kladný a tok dovnitř jako záporný. Velikost toku rovinnou plochou určíme jako součin vektorového pole v tomto místě a  obsahu plochy.
Celkový tok $\vec q=(0,q_y,q_z)$ do krychle na obrázku je součtem toků levou boční stěnou a dolní stěnou, tj. 
$$Q_{in}=-q _y\Delta x \Delta z - q _z\Delta x \Delta y.$$
Podobně tok ven z krychle je  $$Q_{out}=\left(q_z+\frac {\partial q_z}{\partial z}\Delta z\right)\Delta x\Delta y + \left(q_y+\frac {\partial q_y}{\partial y}\Delta y\right)\Delta x\Delta z$$
a celková bilance je 
$$Q_{in}+Q_{out}=
\left(\frac {\partial q_y}{\partial y}+\frac {\partial q_z}{\partial z}\right)\Delta x\Delta y\Delta z.
$$
V případě proudění i v ose $x$ bude přítomen ještě další analogický člen charakterizující tuto dodatečnou položku. 

-->
<p>Výše uvedenými úvahami je motivována následující definice a věta. (Definice je maličko nepřesná, protože nemáme nástroje pro pečlivější formulaci.)</p>
<blockquote class="definice"><p class="definicename">Definice (divergence).</p><p> <em>Divergence</em> vektorového pole <span class="math inline">\(\vec F\)</span> v daném bodě je převis toku vektorového pole z tohoto místa nad tokem do tohoto místa. Tento tok se počítá přes hranici infinitezimálně malého referenčního tělesa a je vztažený na jednotku objemu. Divergenci vektorového pole <span class="math inline">\(\vec F\)</span> označujeme <span class="math inline">\(\nabla\cdot\vec F\)</span> nebo <span class="math inline">\(\mathop{\mathrm{div}} \vec F\)</span>.</p>
</blockquote>
<blockquote class="veta"><p class="vetaname">Věta (výpočet divergence).</p><p> Pro vektorovou funkci <span class="math display">\[\vec F=(P,Q,R)=P\vec i + Q\vec j + R\vec k,\]</span> kde <span class="math inline">\(P\)</span>, <span class="math inline">\(Q\)</span> a <span class="math inline">\(R\)</span> jsou funkce tří proměnných <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> a <span class="math inline">\(z\)</span> vypočteme divergenci vztahem <span class="math display">\[\nabla\cdot\vec F=\mathop{\mathrm{div}}\vec F=\frac{\partial P}{\partial x}+\frac{\partial Q}{\partial y}+\frac{\partial R}{\partial z}.\]</span> Pro vektorovou funkci dvou proměnných vypočteme divergenci analogicky, pouze chybí třetí člen.</p>
</blockquote>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (fyzikální interpretace divergence).</p><p> Vektorové pole používáme k modelování toku veličin, které nás zajímají (teplo v materiálu, tekutina nebo chemická látka v materiálu, voda nebo plyn v půdě a podobně). Divergence vektorového pole udává tok z jednotkového objemu látky v daném místě. Udává, jestli se v daném místě a čase tok nabývá na intenzitě (kladná divergence) nebo ustává (záporná divergence). Tento efekt může být způsoben tím, že veličina přenášená tímto polem se v daném místě buď kumuluje, nebo ubývá a také tím, že daná veličina v bodě může vznikat nebo zanikat.</p>
</blockquote>
<p>Divergence je lokální veličina. Udává informaci o daném bodě. Pro měření však je nutné mít konečný objem a pro stanovení toku konečně velkou hranici. Vzájemný vztah mezi lokální veličinou a konečným objemem je založený na předpokladu, že podmínky se nemění skokem a okolí každého bodu jsou nepříliš odlišné od podmínek v okolních bodech.</p>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (fyzikální interpretace divergence v měřitelných pojmech).</p><p> Protože tok přes hranici umíme měřit u těles, představíme si okolo bodu který nás zajímá, těleso. Například kouli nebo krychli. Poté určíme tok přes hranici. Tok hranicí ven počítáme kladně a dovnitř záporně. Celkový tok hranicí určíme jako součet přes všechny části hranice. Podíl celkového toku přes hranici tělesa a objemu tohoto tělesa je odhad pro divergenci v daném bodě.</p>
</blockquote>
<p>Přesnou divergenci získáme postupem uvedeným v předchozí poznámce, pokud limitním přechodem stáhneme rozměry tělesa k nule.</p>
<p>Pokud se daném místě množství veličiny nemění s časem, tj. žádná veličina se tam neakumuluje ani neubývá, mluvíme o stacionárním proudění a stacionárním poli. Situace se zjednoduší, protože potom divergence souvisí jenom s přítomností zdrojů a spotřebičů.</p>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (praktická interpretace divergence stacionárního pole).</p><p> Pokud při ustáleném proudění je v některém místě divergence kladná, znamená to, že v tomto místě musí být zdroj této veličiny. Pokud je záporná, je v daném místě spotřebič. Pro pohodlí při popisu toku bereme spotřebiče jako záporné zdroje. Vektorové pole, jehož divergence je rovna nule, se nazývá <strong>nezřídlové pole</strong>. To proto, že pokud toto pole popisuje ustálený tok, tak se jedná o tok v prostředí bez zdrojů a spotřebičů.</p>
</blockquote>
<p>Ze střední školy z fyziky umíme modelovat vektorové pole pomocí siločar. Siločáry nezřídlového pole nikde nezačínají ani nekončí a jsou to uzavřené křivky. Například stacionární magnetické pole je nezřídlové. Absence zdrojů magnetického pole se projevuje tak, že rozříznutím tyčového magnetu vzniknou dva menší plnohodnotné magnety. Nevznikne samostatný jižní pól a samostatný severní pól magnetu. To je rozdíl oproti poli elektrickému, kdy rozdělením tyče s opačně nabitými konci vznikne jedna kladně nabitá a jedna záporně nabitá tyč poloviční délky.</p>
<h1 id="výpočet-gradientu-a-divergence">Výpočet gradientu a divergence</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/UzT_PDj5ukY"></iframe> </div>
<p>Viz přednáška.</p>
<h1 id="rovnice-kontinuity">Rovnice kontinuity</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/_iHeE-9DJrA"></iframe> </div>

<div class="obtekat">
<figure>
<img src="ucto.jpg" alt="Rovnice kontinuity je vlastně bilance zisků a ztrát pro danou stavovou veličinu v libovolném bodě. Zdroj: pixabay.com" /><figcaption>Rovnice kontinuity je vlastně bilance zisků a ztrát pro danou stavovou veličinu v libovolném bodě. Zdroj: pixabay.com</figcaption>
</figure>
</div>

<ul>
<li>Přírůstek stavové veličiny za jednotku času v jednotkovém objemu (nebo ploše, nebo délce, podle dimenzionality úlohy) je derivace hustoty <span class="math inline">\(u\)</span> podle času. <span class="math display">\[\text{Přírůstek}=\frac{\partial u}{\partial t}\]</span></li>
<li>Přírůstek veličiny v jednotkovém objemu (nebo ploše, nebo délce) za jednotku času způsobený tokem <span class="math inline">\(\vec \jmath\)</span> je záporně vzatá divergence vektorového pole <span class="math inline">\(\vec \jmath\)</span>. Tento přírůstek je způsobený snížením toku, proto má předřazeno záporné znaménko. <span class="math display">\[    \text{
     Přírůstek způsobený tokem
}=-\nabla\cdot \vec \jmath\]</span></li>
</ul>
<p>Matematickou formulací celkové bilance je <strong>rovnice kontinuity</strong>. <span class="math display">\[
      {\frac{\partial u}{\partial t}=\sigma -\nabla\cdot \vec \jmath}   \]</span></p>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (fyzikální interpretace členů rovnice kontinuity).</p><p></p>
<ul>
<li>Člen <span class="math inline">\(\frac{\partial u}{\partial t}\)</span> udává, jak rychle se roste hustota stavové veličiny <span class="math inline">\(u\)</span> v daném místě a čase.</li>
<li>Člen <span class="math inline">\(\sigma\)</span> udává vydatnost zdrojů stavové veličiny, přičemž spotřebiče jsou uvažovány jako zdroje záporné vydatnosti. Tento člen tedy udává, kolik stavové veličiny v tomto místě vzniká v jednotkovém objemu za jednotku času.</li>
<li>Člen <span class="math inline">\(\nabla\cdot \vec j\)</span> udává v daném bodě změnu ve velikosti proudění přenášejícím stavovou veličinu. Přesněji, udává, o kolik více veličiny z daného místa vyteče ve srovnání s množstvím veličiny, které do tohoto místa vteče. Jinak řečeno, udává, o kolik zesílí v daném místě tok <span class="math inline">\(\vec \jmath\)</span>. My potřebujeme mít zachyceno zeslabení (množství které chybí v toku se “použije” na akumulaci veličiny v daném místě) a proto uvažujeme záporně vzatou divergenci, tj. <span class="math inline">\(-\nabla\cdot \vec j\)</span>.</li>
<li>Pokud zdroje stavové veličiny neexistují, jedná se o <em>bezzdrojovou rovnici</em> a klademe <span class="math inline">\(\sigma=0\)</span>.</li>
<li>Pokud studujeme systém v ustáleném stavu, kdy se stavová veličina nemění v čase, je člen <span class="math inline">\(\frac{\partial u}{\partial t}\)</span> na levé straně nulový. V tomto případě mluvíme o <em>stacionárním stavu</em> a <em>stacionární rovnici kontinuity</em>. Stacionární rovnice kontinuity typicky popisuje systémy, které byly dostatečně dlouhou dobu ve stabilních podmínkách a dosáhly rovnovážného stavu.</li>
<li>Viděli jsme, že za určitých podmínek mohou některé členy v rovnici kontinuty chybět. Naopak člen <span class="math inline">\(\nabla\cdot \vec j\)</span> charakterizující změny v toku je v rovnici kontinuity přítomen vždy. Bez něj by rovnice kontinuity ztratila smysl (resp. redukovala by se na triviální případ, kdy veličina v daném místě vzniká danou rychlostí a zůstává zde, tj. problém řešitelný čistě integrováním).</li>
</ul>
</blockquote>
<p>V matematice často rovnici kontinuity uvažujeme ve výše uvedeném tvaru. Při praktickém použití většinou preferujeme názornou interpretaci jednotlivých veličin a proto se v rovnici mohou objevit další konstanty úměrnosti, které umožní sladit jednotky a fyzikální interpretaci členů. Někdy se naopak snažíme konstanty co nejvíce redukovat metodami transformace popsanými v přednášce o diferenciálních rovnicích. Proto volíme vhodné násobky veličin vystupujících v matematické formulaci tak, aby se co nejvíce konstant eliminovalo, případně shluklo do jediné veličiny. Zkušenosti ukazují, že je vhodné volit veličiny bezrozměrné. Například v publikaci P. Horáček, Fyzikální a mechanické vlastnosti dřeva I je zavedena <a href="https://is.mendelu.cz/eknihovna/opory/zobraz_cast.pl?cast=9180;lang=cz">bezrozměrná vlhkost, bezrozměrný čas a bezrozměrná vzdálenost</a> na straně 61 pro rovnici popisující difuzi a <a href="https://is.mendelu.cz/eknihovna/opory/zobraz_cast.pl?cast=9182;lang=cz">charakteristická délka, Biotovo číslo (bezrozměrná tepelná vodivost) a bezrozměrná teplota, bezrozměrný čas a bezrozměrná vzdálenost</a> pro rovnici popisující vedení tepla na stranách 88 a 89.</p>
<p>V této rovnici není zahrnut případ, kdy se veličina přenáší ještě i prouděním hmotného prostředí (konvekce).</p>

<a onclick=otevrit("problems/difuzni_rce/interpretace_clenu.pg"); target="_blank" class="WWotazka">Testová otázka</a>

<h1 id="rovnice-mělké-vody">Rovnice mělké vody</h1>
<div class="obtekat">
<figure>
<img src="ricka.jpg" alt="Rovnici kontiuity známe ze středoškolské fyziky pro ustálené proudění. Naše obecnější formulace umí zachytit i nestacionární stav. Zdroj: pixabay." /><figcaption>Rovnici kontiuity známe ze středoškolské fyziky pro ustálené proudění. Naše obecnější formulace umí zachytit i nestacionární stav. Zdroj: pixabay.</figcaption>
</figure>
</div>
<p>Rovnici kontinuity můžeme použít pro popis vody v korytě. Úloha je jednodimenzionální a tok <span class="math inline">\(Q\)</span> je skalární veličina. Divergence toku se díky jednodimenzionálnosti redukuje na derivaci podle prostorové proměnné <span class="math inline">\(\frac{\partial Q}{\partial x}\)</span>. Zachovávající se veličinou je množství vody. Hustota zachovávající se veličiny je množství vody na metr délky toku, tj.  <span class="math inline">\(A\)</span> (obsah průřezu říčního toku v daném místě). Zdroje zpravidla neuvažujeme, tj. <span class="math inline">\(\sigma=0\)</span>. Rovnice kontinuity má potom tvar <span class="math display">\[
      {\frac{\partial A}{\partial t}= - {\frac{\partial Q}{\partial x}}}
\]</span> a nazývá se Saint-Venantova rovnice nebo též <em>rovnice mělké vody</em>. Tato rovnice se používá při popisu <em>proudění v korytě</em> nebo při modelování <em>vln tsunami</em>.</p>
<p>V rovnici jsou dvě funkce, tok <span class="math inline">\(Q\)</span> definující pohyb stavové veličiny a průřez <span class="math inline">\(A\)</span> definující množství stavové veličiny. Někdy je vhodnější pracovat se stavovou veličinou <span class="math inline">\(h\)</span> udávající výšku hladiny. Jak jsme zmínili v úvodní přednášce o derivacích, je derivace <span class="math inline">\(\frac{\mathrm dA}{\mathrm d h}\)</span> rovna šířce hladiny. Abychom mohli celou rovnici převést na tvar pracující jenom se stavovou veličinou <span class="math inline">\(h\)</span>, je nutné udělat nějaké dodatečné předpoklady, jako například pracovat s konkrétním tvarem koryta.</p>
<h1 id="proudění-tekutiny-v-mechanice-kontinua">Proudění tekutiny v mechanice kontinua</h1>

<div class="obtekat">
<figure>
<img src="med.jpg" alt="Rovnice mechaniky kontinua dokáží popsat i děje, které se odehrávají v tekutinách tekoucích jinak, než voda nebo ideální tekutina. Běžným příkladem je med, technicky významným například beton. Kromě rovnice kontinuity je nutné dodat ještě další fyzikální vztahy. Zdroj: pixabay.com." /><figcaption>Rovnice mechaniky kontinua dokáží popsat i děje, které se odehrávají v tekutinách tekoucích jinak, než voda nebo ideální tekutina. Běžným příkladem je med, technicky významným například beton. Kromě rovnice kontinuity je nutné dodat ještě další fyzikální vztahy. Zdroj: pixabay.com.</figcaption>
</figure>
</div>

<p>V mechanice kontinua podobně jako u vedení tepla neuvažujeme zdroje. Stavovou veličinou je hustota <span class="math inline">\(\rho\)</span>, která popisuje množství látky v daném místě. Tato látka je přenášena tokem, který je roven součinu rychlosti <span class="math inline">\(\vec u\)</span> a hustoty <span class="math inline">\(\rho\)</span>. Rovnice kontinuity popisující proudění dané rychlostí <span class="math inline">\(\vec u\)</span> má poté tvar <span class="math display">\[\frac{\partial \rho}{\partial t} + \nabla\cdot (\rho \vec {u}) = 0,\]</span> kde <span class="math inline">\(\rho\)</span> je hustota. Tato rovnice napsána pro vzduch je jednou z rovnic používaných při <a href="http://www-history.mcs.st-and.ac.uk/HistTopics/Weather_forecasts.html">modelování vývoje počasí</a></p>
<p>Pro nestlačitelnou tekutinu je hustota konstantní, což eliminuje nestacionární člen a redukuje rovnici na <span class="math display">\[ \nabla\cdot\vec
u =0.\]</span> Důsledkem této rovnosti je zvýšení rychlosti molekul pohybující se nestlačitelné tekutiny při proudění místem s menším průřezem.</p>
<p><a href="https://cs.wikipedia.org/wiki/Rovnice_kontinuity#Rovnice_kontinuity_ve_st%C5%99edo%C5%A1kolsk%C3%A9_fyzice">Středoškolský makroskopický tvar</a> jednorozměrné rovnice kontinuity pro proudění nestlačitelné tekutiny je <span class="math display">\[S u = \mathrm{konst}.\]</span></p>
<h1 id="difuzní-rovnice">Difuzní rovnice</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/MH8IzenZZCo"></iframe> </div>
<p>Difuzní rovnice je rovnice kontiuity s dosazeným konstitučním vztahem pro tok. Použijeme-li pro kvantifikaci souvislosti toku a gradientu lineární aproximaci, je možné psát <span class="math display">\[      \vec \jmath=-D\nabla u,\]</span> kde <span class="math inline">\(D\)</span> konstanta úměrnosti. Pokud tok <span class="math inline">\(\vec \jmath\)</span> a gradient <span class="math inline">\(\nabla u\)</span> leží v jedné přímce, je <span class="math inline">\(D\)</span> reálné číslo, jinak je <span class="math inline">\(D\)</span> matice. Například při studiu pohybu vody ve dřevě se voda řídí nejen směrem maximálního poklesu vlhkosti, ale stáčí se současně do podélného směru, ve kterém dřevo vede vlhkost nejlépe. V takovém případě je <span class="math inline">\(D\)</span> matice. Spojením rovnice kontinuity <span class="math display">\[
      {\frac{\partial u}{\partial t}=\sigma -\nabla\cdot \vec \jmath}   \]</span> a vztahu pro tok stavové veličiny dostáváme rovnici <span class="math display">\[
      {\frac{\partial u}{\partial t}=\sigma - \nabla\cdot \bigl(-D\nabla u\bigr)}.\]</span> Tuto rovici je možno upravit na tvar <span class="math display">\[
      {\frac{\partial u}{\partial t}=\sigma + \nabla\cdot \bigl(D\nabla u\bigr)},\]</span> který se nazývá <em>difuzní rovnice</em>.</p>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (fyzikální interpretace difuzní rovnice).</p><p></p>
<ul>
<li>Člen <span class="math inline">\(\frac{\partial u}{\partial t}\)</span> udává, jak rychle se mění hustota stavové veličiny <span class="math inline">\(u\)</span>. Je stejný jako v rovnici kontinuity.</li>
<li>Člen <span class="math inline">\(\sigma\)</span> udává vydatnost zdrojů stavové veličiny. Je stejný jako v rovnici kontinuity.</li>
<li>Člen <span class="math inline">\(\nabla u\)</span> udává nerovnoměrnost v prostorovém rozložení stavové veličiny. Pomocí difuzní matice <span class="math inline">\(D\)</span> a konstitutivního zákona tuto nerovnoměrnost přepočítáme na tok, který se snaží uvažovanou nerovnoměrnost vyrovnat. Tento tok je reprezentován výrazem <span class="math inline">\(-D\nabla u\)</span>.</li>
<li>Záporně vzatá divergence toku udává, jak tok v daném místě ztrácí na intenzitě. Vzhledem k zápornému znaménku v konstitutivním zákoně má záporně vzatá divergence tvar <span class="math display">\[\nabla\cdot \bigl(D\nabla u\bigr).\]</span> Představuje přírůstek hustoty stavové veličiny v daném místě za jednotku času, způsobený zeslábnutím toku.</li>
<li>Rovnice jako celek vyjadřuje, že navýšení hustoty stavové veličiny (tj. množství stavové veličiny v jednotkovém objemu) je součtem navýšení díky zdrojům a navýšení díky zeslabení toku v daném místě.</li>
</ul>
</blockquote>
<h1 id="vedení-tepla">Vedení tepla</h1>

<div class="obtekat">
<figure>
<img src="teplo.jpg" alt="Stromy umí ochlazovat své okolí. Ulice v Melbourne vyfocená termokamerou to dokazuje. A difuzní rovnice toto dokáže modelovat. Photograph: City of Melbourne. Zdroj: theguardian.com." /><figcaption>Stromy umí ochlazovat své okolí. Ulice v Melbourne vyfocená termokamerou to dokazuje. A difuzní rovnice toto dokáže modelovat. Photograph: City of Melbourne. Zdroj: theguardian.com.</figcaption>
</figure>
</div>

<p>Důležitým speciálním případem difuzní rovnice je rovnice vedení tepla. Stavovou veličinou, která se zachovává v úlohách s vedením tepla, je vnitřní energie ve formě tepla. Zpravidla nemá smysl uvažovat členy vyjadřující zdroje, tj. <span class="math inline">\(\sigma =0\)</span>. Protože teplo neměříme přímo, je vhodnější model formulovat pro teplotu <span class="math inline">\(T\)</span>. Jsou-li <span class="math inline">\(\varrho\)</span> a <span class="math inline">\(c\)</span> po řadě hustota a měrná tepelná kapacita materiálu, má člen vyjadřující změnu hustoty energie v daném místě tvar <span class="math inline">\(\varrho c\frac{\partial T}{\partial t}.\)</span> Úměrnost mezi gradientem teploty a tokem tepla zprostředkovává <em>Fourierův zákon</em>. Difuzní rovnice má v tomto případě tvar <span class="math display">\[{\varrho c\frac{\partial T}{\partial t}=  \nabla\cdot\bigl(D\nabla T\bigr)}\]</span></p>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (fyzikální interpretace rovnice vedení tepla).</p><p></p>
<ul>
<li>Veličina <span class="math inline">\(\frac{\partial T}{\partial t}\)</span> udává rychlost růstu teploty tělesa a koeficient <span class="math inline">\(\rho c\)</span> tuto hodnotu přepočítává na údaj, jak rychle roste vnitřní energie tělesa (kinetická energie molekul.)</li>
<li>Výraz <span class="math inline">\(D\nabla T\)</span> udává (až na znaménko), jak se nerovnoměrnost v rozložení teploty vyrovnává tokem tepla. Přesněji, tok tepla je <span class="math inline">\(-D\nabla T\)</span>.</li>
<li>Člen <span class="math inline">\(\nabla\cdot(D\nabla T)\)</span> udává, kolik tepla z celkového toku v daném místě zůstává a podílí se na zvýšení teploty. Vzhledem k absenci zdrojů je to také jediný mechanismus, jak v daném místě může vnitřní energie přibývat či ubývat.</li>
<li>Rovnice jako celek vyjadřuje to, že pokud z daného místa více energie odtéká, než kolik do místa proudí, dojde v tomto místě k odpovídajícímu snížení teploty. V tomto bodě je totiž divegrence toku <span class="math inline">\(\nabla\cdot (-D\nabla T)\)</span> kladná a výraz z rovnice <span class="math inline">\(\nabla\cdot (D\nabla T)\)</span> je proto záporný.</li>
</ul>
</blockquote>

<div class="obtekat">
<figure>
<img src="vrstvy.png" alt="Na rozhraní vrstev ve vrstveném materiálu je spojité teplotní pole a tok tepla. Zdroj: Cengel, Ghajar: Heat and Mass Transfer." /><figcaption>Na rozhraní vrstev ve vrstveném materiálu je spojité teplotní pole a tok tepla. Zdroj: Cengel, Ghajar: Heat and Mass Transfer.</figcaption>
</figure>
</div>


<a onclick=otevrit("problems/difuzni_rce/vedeni_tepla_vypocet.pg"); target="_blank" class="WWotazka">Testová otázka</a>

<p>Tato rovnice je zobecnění rovnice vedení tepla v jedné dimenzi, kterou jsme odvodili primitivními prostředky (jenom pomocí parciálních derivací, bez gradientu a divergence) ve tvaru <span class="math display">\[\rho c\frac{\partial T}{\partial t}=\frac{\partial}{\partial x}\left(D\frac{\partial T}{\partial x}\right)\]</span> v úvodní přednášce.</p>
<p>Rovnice vedení tepla se používá například při <em>tepelné ochraně budov</em>, při modelování <em>tepelných ostrovů</em> v krajině, při <em>tepelné modifikaci dřeva</em>, nebo při studiu <em>permafrostu</em>.</p>
<p>V literatuře věnované problematice dřeva se rovnice vedení tepla ve dřevě označuje jako Druhý Fourierův zákon (P. Horáček, Fyzikální a mechanické vlastnosti dřeva I, str. 88).</p>
<p>V některých případech nemusí být člen charakterizující zdroje nulový. Teplo může vznikat například při tření nebo při průchodu elektrického proudu transformací z jiného druhu energie. Dále teplo vzniká například při betonování po <a href="http://www.ebeton.cz/pojmy/hydratacni-teplo">přidání vody do cementu</a>, známý je problém jak <a href="http://www.ebeton.cz/encyklopedie/hooverova-prehrada">uchladit Hooverovu přehradu</a> při stavbě.</p>
<h1 id="voda-v-porézním-materiálu">Voda v porézním materiálu</h1>

<div class="obtekat">
<figure>
<img src="drevo.jpg" alt="Difuzní rovnice se používá k modelování sušení dřeva. Zdroj: pixabay.com." /><figcaption>Difuzní rovnice se používá k modelování sušení dřeva. Zdroj: pixabay.com.</figcaption>
</figure>
</div>

<p>V porézním materiálu voda prostupuje materiálem a zachovává se její množství, což bude stavová veličina. Hustotu tohoto množství, tj. obsah vody v jednotce objemu, označíme <span class="math inline">\(c\)</span> a pro tuto veličinu formulujeme matematický model. Zdroje neuvažujeme. Úměrnost mezi gradientem koncentrace vody a jejím tokem zprostředkovává <em>Fickův zákon</em>. Modelem je potom difuzní rovnice bez zdrojů. <span class="math display">\[
      {\frac{\partial c}{\partial t}= \nabla\cdot \bigl(D\nabla c\bigr)}
      \]</span> Tato rovnice se používá například při modelování procesu <em>sušení dřeva</em> v sušárnách nebo při modelování <em>dřeva ve vlhkém prostředí</em>. Stejná rovnice napsaná pro vzduch se používá k modelování proudění v atmosféře při <em>předpovídání počasí</em>.</p>
<p>V literatuře věnované problematice dřeva se rovnice difuze použitá na modelování vlhkosti ve dřevě označuje jako Druhý Fickův zákon (A. Požgaj a kol., Štruktúra a vlastnosti dreva, str. 202, P. Horáček, Fyzikální a mechanické vlastnosti dřeva I, str. 60).</p>
<p>V praxi je dřevo často s jistou přesností homogenní, ale difuzní koeficient dřeva závisí na vlhkosti, tedy vztah mezi gradientem vlhkosti a difuzním tokem není lineární. Přesto i v tomto případě používáme Fickův zákon, ovšem složky difuzního koeficientu nepovažujeme za konstanty, jsou závislé na <span class="math inline">\(c\)</span> a jejím prostřednictvím i na <span class="math inline">\(x\)</span>.</p>
<h1 id="rovnice-podzemní-vody">Rovnice podzemní vody</h1>

<div class="obtekat">
<figure>
<img src="voda.jpg" alt="Difuzní rovnice umí popsat proudění podzemní vody. Díky tomu dokážeme zabránit kontaminacím pitné vody z chemických provozů. Zdroj: pixabay.com." /><figcaption>Difuzní rovnice umí popsat proudění podzemní vody. Díky tomu dokážeme zabránit kontaminacím pitné vody z chemických provozů. Zdroj: pixabay.com.</figcaption>
</figure>
</div>

<p>Proudění podzemní vody je vlastně úloha s řekou se zasypaným korytem. Taková voda teče ve srovnání s povrchovou vodou velmi pomalu, protože prosakuje půdou. Prostor, kde se podzemní voda nachází, se nazývá <em>zvodeň</em>. Stejně jako řeka v korytě na povrchu, i voda v podzemní zvodni teče v jistém smyslu “z kopce”. V tomto případě však kromě nadmořské výšky může hrát roli i rozdíl tlaků nebo další efekty. Vliv všech těchto efektů shrnujeme do jediného pojmu <em>piezometrická výška</em>. Směr “z kopce” pro podzemní vodu je poté směr poklesu piezometrické výšky. V daném místě se může voda hromadit, to poznáme nárůstem hladiny spodní vody. Také může z hlediska zvodně část vody zanikat, například pokud je zde čerpaná studna nebo průsak do jiné zvodně. Voda může ve zvodni i vznikat, například zasakovacím vrtem nebo průsakem dešťových srážek. Pokud do celkové bilance započteme rozdíl mezi přítokem a odtokem a všechny zdroje a spotřebiče, množství vody se zachovává.</p>
<p>Podzemní zvodeň je typickým porézním materiálem, přesto k modelování vody v tomto prostředí přistupujeme speciálním způsobem. Úloha se většinou uvažuje ve dvou dimenzích, protože horizontální rozměry zvodně jsou mnohem větší než její hloubka. Zachovává se množství vody, ale stejně jako u vedení tepla je výhodné formulovat model pro lépe měřitelnou veličinu, <em>piezometrickou výšku</em> <span class="math inline">\(h\)</span>. Přírůstek množství podzemní vody za časovou jednotku na jednotkové ploše v daném místě zvodně má tvar <span class="math inline">\(S_S \frac{\partial h}{\partial t}\)</span>, kde <span class="math inline">\(S_S\)</span> je <em>specifická zásobnost</em>. Úměrnost mezi gradientem piezometrické výšky a filtračním tokem zprostředkovává <em>Darcyho zákon</em>. Difuzní rovnice má (s konstantou úměrnosti <span class="math inline">\(T\)</span>, <em>transmisivitou</em>) tvar <span class="math display">\[ {S_S\frac{\partial h}{\partial t}=  \sigma + \nabla\cdot \bigl(T\nabla h\bigr).}\]</span> Tato rovnice se nazývá <em>rovnice podzemní vody</em>. Zdroje jsou nejčastěji zasakovací nebo odvodňovací vrty, dále studny, poldry, výkopy nebo zářezy. Informace získané z rovnice podzemní vody se využívají například k ochraně lomů, dolů a stavebních jam před <em>zaplavením</em>, k hospodaření s <em>pitnou vodou</em>, k ochraně před šířením <em>kontaminace z chemických provozů</em>. Aplikace jsou dále v detekci zdroje kontaminace pitné vody a odhadu rychlosti šíření kontaminace, včetně <em>kontaminace slanou mořskou vodou</em> v přímořských oblastech.</p>
<p>U proudění s napjatou hladinou (mezi dvěma nepropustnými vrstvami, angl. <em>confined aquifer</em>) transmisitiva závisí pouze na fyzikálních vlastnostech zvodně. Například pro homogenní izotropní materiál je konstantní. U proudění s volnou hladinou (bez horní nepropustné vrstvy, angl. <em>unconfined aquifer</em>) je transmisivita úměrná tloušťce vrstvy obsahující vodu. Zpravidla nulovou hodnotu piezometrické hladiny volíme na dolní nepropustné vrstvě a potom platí <span class="math inline">\(T=kh\)</span>, kde <span class="math inline">\(k\)</span> závisí pouze na fyzikálních vlastnostech půdy. Proto se často rovnice podzemní vody pro proudění s volnou hladinou zapisuje ve tvaru <span class="math display">\[ {S_S\frac{\partial h}{\partial t}=  \sigma + \nabla\cdot \bigl(kh\nabla h\bigr).}\]</span></p>
<h1 id="rovnice-vedení-tepla-ve-2d-v-různých-podmínkách">Rovnice vedení tepla ve 2D v různých podmínkách</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/5hy6lB1O4KQ"></iframe> </div>

<div class="obtekat">
<figure>
<img src="VCJR_modifikace_pravidelne.jpg" alt="Teplotní modifikace dřeva ve VCJR v Útěchově. Díky jednoduché geometrii vzorků je možno provést i přesný analytický výpočet teplotního pole. Výřez ukazuje detail čtyř vzorků. Jeden z nich je nařezán šikmo. V takovém případě je výpočet mnohem obtížnější než u vzorků, jejichž tvar respektuje anatomické směry ve dřevě. Zdroj: J. Dömény." /><figcaption>Teplotní modifikace dřeva ve VCJR v Útěchově. Díky jednoduché geometrii vzorků je možno provést i přesný analytický výpočet teplotního pole. Výřez ukazuje detail čtyř vzorků. Jeden z nich je nařezán šikmo. V takovém případě je výpočet mnohem obtížnější než u vzorků, jejichž tvar respektuje anatomické směry ve dřevě. Zdroj: J. Dömény.</figcaption>
</figure>
<figure>
<img src="VCJR_sindel.jpg" alt="Teplotní modifikace šindele ve VCJR v Útěchově. Řídí se stejnou rovnicí jako hranoly na obrázku výše. Vinou komplikovaného tvaru je však matematické modelování teplotního pole možné jenom numerickou cestou. Skutečně, v podobných úlohách hraje geometrie úlohy důležitou roli a netriviální geometrie zpravidla znemožní efektivní řešení analytickou cestou. Zdroj: J. Dömény." /><figcaption>Teplotní modifikace šindele ve VCJR v Útěchově. Řídí se stejnou rovnicí jako hranoly na obrázku výše. Vinou komplikovaného tvaru je však matematické modelování teplotního pole možné jenom numerickou cestou. Skutečně, v podobných úlohách hraje geometrie úlohy důležitou roli a netriviální geometrie zpravidla znemožní efektivní řešení analytickou cestou. Zdroj: J. Dömény.</figcaption>
</figure>
<figure>
<img src="rtb.png" alt="Nestacionární rovnice vedení tepla. Měření teplotních charakteristik pomocí sledování odezvy na teplotní impuls na ÚNOD LDF MENDELU. Zdroj: R. Slávik." /><figcaption>Nestacionární rovnice vedení tepla. Měření teplotních charakteristik pomocí sledování odezvy na teplotní impuls na ÚNOD LDF MENDELU. Zdroj: R. Slávik.</figcaption>
</figure>
</div>

<p>Uvažujme rovnici vedení tepla ve dvou rozměrech a v prostředí bez zdrojů. <span class="math display">\[\rho c\frac{\partial T}{\partial t}=\nabla\cdot (D\nabla T)\tag{***}\]</span></p>
<h2 id="stacionární-stav">Stacionární stav</h2>
<p>Stacionární stav znamená, že stavové veličiny nezávisí na čase. Derivace podle času je v takovém případě nulová. Rovnice (***) se redukuje na <span class="math display">\[\nabla\cdot (D\nabla T)=0.\]</span></p>
<h2 id="homogenní-izotropní-materiál-a-lineární-materiálové-vztahy">Homogenní izotropní materiál a lineární materiálové vztahy</h2>
<p>Materiál má ve všech místech (homogenní) a ve všech směrech (izotropní) stejné vlastnosti. Veličina <span class="math inline">\(D\)</span> je reálná skalární veličina (konstanta).</p>
<p>Podle pravidla derivace konstantního násobku se rovnice (***) redukuje na<br />
<span class="math display">\[\rho c\frac{\partial T}{\partial t}=D\nabla\cdot (\nabla T)\]</span> a ve složkách <span class="math display">\[\rho c\frac{\partial T}{\partial t}=D\left(\frac{\partial^2 T}{\partial x^2}+\frac{\partial^2 T}{\partial y^2}\right).\]</span> Pro <span class="math inline">\(\tau=\frac{Dt}{\rho c}\)</span> (změna jednotky času) dostáváme <span class="math display">\[\frac{\partial T}{\partial \tau}=\frac{\partial^2 T}{\partial x^2}+\frac{\partial^2 T}{\partial y^2}.\]</span></p>
<h2 id="ortotropní-materiál-nehomogenní-nebo-nelineární">Ortotropní materiál, nehomogenní nebo nelineární</h2>
<p>Materiál má dva charakteristické směry související s rovinami symetrie. Zvolíme soustavu souřadnic tak, aby osy byly orientovány ve směru vlastních vektorů.</p>
<p>Veličina <span class="math inline">\(D\)</span> je diagonální matice. Pro <span class="math display">\[D=\begin{pmatrix}D_x &amp; 0\\ 0&amp; D_y\end{pmatrix}\]</span> je tvar rovnice (***) ve složkách <span class="math display">\[\rho c\frac{\partial T}{\partial t}=\frac{\partial }{\partial x}\left(D_x\frac{\partial T}{\partial x}\right)
+\frac{\partial }{\partial y}\left(D_y\frac{\partial T}{\partial y}\right).\]</span></p>
<h2 id="homogenní-ortotropní-materiál-a-lineární-materiálové-vztahy">Homogenní ortotropní materiál a lineární materiálové vztahy</h2>
<p>Materiál má dva charakteristické směry související s rovinami symetrie a materiálové charakteristiky jsou ve všech místech stejné a nezávislá na <span class="math inline">\(T\)</span>. Stejné jako předchozí případ, ale <span class="math inline">\(D_x\)</span> a <span class="math inline">\(D_y\)</span> jsou konstanty. Podle pravidla pro derivaci konstantního násobku se rovnice (***) redukuje na <span class="math display">\[\rho c\frac{\partial T}{\partial t}=D_x\frac{\partial^2 T}{\partial x^2}+D_y\frac{\partial^2 T}{\partial y^2}.\]</span></p>
<h1 id="umění-identifikace-předpokladů-z-tvaru-difuzní-rovnice">Umění identifikace předpokladů z tvaru difuzní rovnice</h1>
<p>Jasná kuchařka, jak identifikovat předpoklady vedoucí ke konkrétní formě difuzní rovnice může vypadat násedovně. Obecný tvar v kartézských souřadnicích je <span class="math display">\[\frac{\partial u}{\partial t} =\sigma +
\frac{\partial }{\partial x}\left(D_x\frac{\partial u}{\partial x}\right)+
\frac{\partial }{\partial y}\left(D_y\frac{\partial u}{\partial y}\right)+
\frac{\partial }{\partial z}\left(D_z\frac{\partial u}{\partial z}\right)
\]</span> a pokud máte před sebou podobnou rovnici, ve které některý člen chybí, znamená to, že tato rovnice v sobě již obsahuje jisté předpoklady. Ty se pokusíme identifikovat. Některý člen může být lehce modifikovaný, například a levé straně mohou figurovat dodatečné multiplikativní konstanty (například v případě rovnice vedení tepla) nebo člen popisující zdroje může být nekonstantní (například při studiu vývoje populace se zahrnutím prostorového rozložení používáme logistický růst <span class="math inline">\(\sigma = ru\left(1-\frac uK\right)\)</span>), zajímavé však pro nás jsou podstatné odlišnosti shrnuté v následujících odrážkách. Vždy je to “něco za něco”. Jednodušší rovnice se lépe dále zpracovává, ale neumí zachytit plnou škálu efektů, které jsou v obecné rovnici.</p>
<ul>
<li>Je v rovnici člen <span class="math inline">\(\frac{\partial u}{\partial t}\)</span> s derivací podle času? Pokud ano, je rovnice <em>nestacionární</em> a dokáže popsat časový vývoj děje. Pokud ne, jedná se o <em>stacionánrní</em> rovnici popisující děj po dosažení ustáleného stavu. Stacionární rovnice je jednodušší, ale nedokáže zachytit časový vývoj.</li>
<li>Je v rovnici člen bez časové a prostorové derivace? Tj. v našem označení <span class="math inline">\(\sigma\)</span>? Pokud ano, popisuje tento člen vydatnost zdrojů nebo spotřebičů a rovnice je schopna zachytit situace, kdy stavová veličina vzniká nebo zaniká. Pokud ne, jedná se o <em>bezzdrojovou rovnici</em>. Takové rovnice popisuje stav, kdy se stavová veličina může jenom přemisťovat nebo kumulovat. Bezzdrojová rovnice je jednodušší, ale nedokáže modelovat vznik či zánik stavové veličiny.</li>
<li>Jsou přítomny všechny prostorové souřadnice, nebo jenom některé? Počet prostorových souřadnic defiuje <em>dimenzi problému</em>, tj. určuje, zda se jedná o úlohu v prostoru, v rovině nebo na přímce.</li>
<li>Jsou všechny difuzní koeficienty stejné (například <span class="math inline">\(D\)</span>), nebo jsou odlišeny (například indexy <span class="math inline">\(D_x\)</span>, <span class="math inline">\(D_y\)</span>, <span class="math inline">\(D_z\)</span>)? Pokud jsou stejné, jedná se o <em>izotropní</em> materiál a rovnice dokáže popsat pouze materiál mající ve všech směrech stejné vlastnosti. Pokud jsou difuzní koeficienty odlišeny, jedná se o <em>anizotropní</em> nebo <em>ortotropní</em> materiál a dokážeme s ní popsat i materiály mající díky své struktuře jiné vlastnosti v jednotlivých směrech.</li>
<li>Jsou difuzní koeficienty uvnitř derivací ve členech typu <span class="math display">\[\frac{\partial }{\partial x}\left(D_x\frac{\partial u}{\partial x}\right)\]</span> nebo jsou difuzní členy zjednodušeny do tvaru <span class="math display">\[D_x\frac{\partial ^2 u}{\partial x^2}\]</span> s druhými derivacemi? Pokud jsou zjednodušeny do druhého tvaru se součinem difuzního koeficientu a druhé derivace, znamená to, že rovnice je sice jednodušší, ale rovnice je schopna popsat pouze materiál, který je <em>homogenní</em> a konstitutivní zákon v tomto materiálu je <em>lineární</em>. V opačném případě (nehomogenita materiálu, nelinearita materiálu, případně obojí) necháváme difuzní koeficienty uvnitř derivace, tak jak to je v obecném případě. Rovnice je komplikovanější, ale umožňuje práci s obecnějšími materiály.</li>
</ul>

<a onclick=otevrit("problems/difuzni_rce/predpoklady.pg"); target="_blank" class="WWotazka">Testová otázka</a>

<h1 id="shrnutí-hlavní-myšlenky">Shrnutí, hlavní myšlenky</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/TjyB3kP2uXE"></iframe> </div>

<div class="obtekat">
<figure>
<img src="../message.jpg" alt="A jaká je hlavní message? Zdroj: pixabay.com" /><figcaption>A jaká je hlavní message? Zdroj: pixabay.com</figcaption>
</figure>
</div>

<ul>
<li>Pomocí gradientu a aparátu lineární algebry můžeme vyjádřit vztah mezi pohybem fyzikální veličiny a mechanismem, který tento pohyb iniciuje. Většinou se jedná o vztah mezi vektorovým polem toku a gradientem jistého skalárního pole.</li>
<li>Pomocí parciálních derivací a divergence dokážeme určit, jestli se v nějakém místě veličina proudící tímto místem “ztrácí” nebo “přibývá”.</li>
<li>Dokážeme dokonce s rozumnou interpretací, čím případné ubývání přenášené veličiny může být způsobeno (zdroje a spotřebiče nebo akumulace v daném místě), zformulovat rovnici, která dané proudění plně popisuje. Výsledkem jsou rovnice vedení tepla, rovnice difuze, rovnice proudění podzemní vody a jiné.</li>
<li>Obecná rovnice odvozená podle předchozích bodů je obecná a pro práci na konkrétní úloze se ji snažíme nějak blíže specifikovat. Například zjednodušit, pokud máme informaci o charakteru materiálových vztahů (lineární/nelineární) a materiálu (homogenní/nehomogenní). Jiným zjednodušením je, pokud se zajímáme o stacionární stav, který se nastolí po dosažení rovnováhy.</li>
<li>Posláním široké škály příkladů různých specifikací rovnice kontinuity (vedení tepla, proudění povrchové a podzemní vody a další) je, aby si student uvědomil široký záběr obecné formulace rovnice kontinuity. Na zkoušku se naučte obecnou rovnici a jenom informativně si přečtěte její speciální případy. Obory pracující se dřevem (dřevařství, nábytek, dřevostavby) si uložte do paměti rovnice popisující modelování tepla a vlhkosti ve dřevě. Budou se vám hodit ve studiu. Na krajinářství se zase zaměřte na modelování vody, mělké i podzemní.</li>
</ul>
<h1 id="shrnutí-více-matematickou-formou">Shrnutí více matematickou formou</h1>
<ul>
<li>Ukázali jsme si, že má smysl založit model na bilanci, která vyjadřuje, že rychlost růstu stavové veličiny je součtem příspěvku vygenerovaného zdroji a příspěvku přineseného tokem.</li>
<li>Rychlost růstu je derivace podle času, <span class="math display">\[\frac {\partial u}{\partial t}.\]</span></li>
<li>Příspěvek přinesený tokem je roven zeslabení toku v daném místě. Zeslabení toku vypočteme jako záporně vzaté zesílení toku, tj. záporně vzatou divergenci toku, <span class="math display">\[-\nabla\cdot \vec j.\]</span></li>
<li>Celková bilance se poté nazývá rovnice kontinuity a má tvar <span class="math display">\[
\frac {\partial u}{\partial t}=\sigma - \nabla\cdot \vec j. \]</span></li>
<li>Tok <span class="math inline">\(\vec j\)</span> zpravidla vypočteme jako záporně vzatý gradient stavové veličiny vynásobený difuzní maticí, tj. <span class="math display">\[\vec j=-D\nabla u.\]</span></li>
<li>Spojením předchozích vztahů dostáváme difuzní rovnici <span class="math display">\[
\frac {\partial u}{\partial t}=\sigma + \nabla\cdot \left(D\nabla u\right). \]</span> To je rovnice popisující obecně transport energie nebo hmoty prostředím. Například vedení tepla nebo difuzi vody při sušení dřeva.</li>
<li>Pro konkrétní výpočet je často nutné rovnici zapsat v souřadnicích. Například pokud máme dvojrozměrný model a směr souřadných os zvolíme ve vlastních směrech matice <span class="math inline">\(D\)</span> (potom matice <span class="math inline">\(D\)</span> bude diagonální s diagonálními prvky například <span class="math inline">\(D_x\)</span> a <span class="math inline">\(D_y\)</span>), má difuzní rovnice tvar <span class="math display">\[ \frac {\partial u}{\partial t}=\sigma + \frac{\partial }{\partial x}\left(D_x \frac{\partial u}{\partial x}\right ) + \frac{\partial }{\partial y}\left(D_y \frac{\partial u}{\partial y}\right ). \]</span></li>
<li>Pokud je materiál homogení a má lineární materiálovou odezvu, je dokonce možné rovnici dále zjednodušit na <span class="math display">\[ \frac {\partial u}{\partial t}=\sigma + D_x\frac{\partial^2 u }{\partial x^2 } + D_y\frac{\partial^2 u }{\partial y^2 } . \tag{N}
\]</span> Tato formulace je jednodušší než předešlá, protože obsahuje druhé derivace místo kvaziderivací.</li>
<li>Pokud je rovnice například stacionární (stavová veličina nezávisí na čase, derivace podle času je nulová), bezzdrojová (neobsahuje zdroje ani spotřebiče, veličina <span class="math inline">\(\sigma\)</span> je nulová), z homogenního a lineárního materiálu (viz předchozí bod) redukuje se rovnice (N) na<br />
<span class="math display">\[ 0= D_x\frac{\partial^2 u }{\partial x^2 } + D_y\frac{\partial^2 u }{\partial y^2 } . \tag{S}
\]</span> Tato rovnice je jednodušší než “plná rovnice” (N) a proto ji dokážeme řešit i ve složitějších podmínkách. Někdy například umíme vyřešit nestacionární rovnici (N) a máme dynamiku jak rychle roste stavová veličina, například jak rychle roste teplota v materiálu. To je nejlepší scénář, někdy však může být nerealizovatelný. Někdy ale umíme vyřešit jenom stacionární rovnici (S) a najdeme jenom rozložení stavové veličiny po dosažení rovnovážného stavu. To je také dobrá a užitečná informace sama o sobě. Navíc může sloužit jako odrazový můstek k řešení nestacionární rovnice (N) tak, že od stacionárního řešení postupujeme zpětně v čase.</li>
<li>Pokud je materiál z předchozího bodu ještě navíc izotropní, tj. pokud má stejné vlastnosti ve všech směrech, je <span class="math inline">\(D_x=D_y\)</span> a rovnici je možno vydělit do tvaru <span class="math display">\[ 0= \frac{\partial^2 u }{\partial x^2 } + \frac{\partial^2 u }{\partial y^2 } .\]</span> O této rovnici si ukážeme (v roce 2021 jsme si ukázali už na minulé přednášce) že zapojením druhých diferencí pro numerickou aproximaci druhé derivace (viz <a href="https://user.mendelu.cz/marik/mtk/mat-slidy/derivace_II/#kone%C4%8Dn%C3%A9-diference-a-numerick%C3%A1-aproximace-derivace">přednáška číslo 2</a>) se model redukuje na soustavu lineárních rovnic, jak jsme ji poněkud naivní metodou odvodili v <a href="https://user.mendelu.cz/marik/mtk/mat-slidy/matice/#rozlo%C5%BEen%C3%AD-teploty-na-tepeln%C4%9B-vodiv%C3%A9-desce">přednášce číslo 7</a>.</li>
</ul>
<h1 id="praktická-aplikace-zajímavost-z-jiné-oblasti-než-nauky-o-materiálu">Praktická aplikace (zajímavost z jiné oblasti než nauky o materiálu)</h1>
<p>Jste frustrovaní, že k rovnici nemáme řešení? Bohužel ho není obecně možné najít. Rovnici dokážeme přesně vyřešit jenom ve velmi speciálních případech. I bez vyřešení však z rovnice získáváme užitečné informace. Navíc rovnice může být stavebním kamenem složitějšího modelu. Místo slibů konkrétní příklad zase na jiné (ale aktuální) téma.</p>
<p>V článku <a href="https://arxiv.org/pdf/2101.12011">A Local and Time Resolution of the COVID-19 Propagation—A Two-Dimensional Approach for Germany Including Diffusion Phenomena to Describe the Spatial Spread of the COVID-19 Pandemic</a> je prostorové šíření epidemi COVID modelováno difuzní rovnicí (1) ve tvaru <span class="math display">\[\frac{\partial c}{\partial t}=q+\nabla\cdot \left(D\nabla c\right),\]</span> což je přesně rovnice, se kterou jsme pracovali zde. Je to rovnice ve své neobecnější formě, aby bylo možno zachytit</p>
<ul>
<li>časový vývoj (o ten nám jde),</li>
<li>nehomogenitu v šíření (například ve městech je jiná rychlost šíření než na venkově) a</li>
<li>existenci zdrojů (vir se umí množit).</li>
</ul>
<p>Tato rovnice se řeší pro Německo, což znemožňuje kvůli složité geometrii nalezení analytického přesného řešení. To totiž umíme v prakticky použitelné formě najít jenom pro obdélník a několik málo dalších množin. Proto se tento model řeší numericky. V prvním odstavci podkapitoly 4 článku je numerický model pro jednotlivé spolkové země označen číslem (7) a redukce na soustavu lineárních rovnic (8). V následujícím odstavci je zmíněna Jacobiho metoda pro numerické řešení soustav lineárních rovnic. S touto metodou jsme se setkali v předchozí přednášce o soustavách rovnic.</p>
<p>Model je dokonce možné doplnit dynamikou růstu zahrnující nárůst nejenom vlivem difuze, ale i vlivem množení viru v daném místě. Přesněji, v odstavci 6 odkazovaného článku se model doplňuje rovnicemi (9) až (11) ve tvaru <span class="math display">\[\begin{aligned}
\frac{\mathrm dS_j}{\mathrm dt}&amp;=-\kappa_j\frac {I_j}{N_j}{S_j},\\
\frac{\mathrm dI_j}{\mathrm dt}&amp;=\kappa_j\frac {I_j}{N_j}{S_j}-\eta_j I_j,\\
\frac{\mathrm dR_j}{\mathrm dt}&amp;=\eta_j I_j.
\end{aligned} \]</span> Toto jsou již naši staří známí ze světa derivací funkce jedné proměnné. Například první rovnice vyjadřuje, že počet <span class="math inline">\(S_j\)</span> lidí zdravých a náchylných k onemocnění COVID19 ve spolkové zemi s indexem <span class="math inline">\(j\)</span> se snižuje rychlostí přímo úměrnou současně množství náchylných lidí a množství <span class="math inline">\(I_j\)</span> infikovaných lidí a nepřímo úměrnou celkové velikosti populace v této zemi <span class="math inline">\(N_j\)</span>. Konstanta úměrnosti je <span class="math inline">\(\kappa_j\)</span> a abychom se mohli spolehnout na to, že tato konstanta je kladná, je úbytek skupiny dosud zdravých lidí zachycen záporným znaménkem na pravé straně rovnice. Podobně je možné interpretovat další rovnice, je to vlastně klasický <a href="https://www.matfyz.cz/clanky/matematika-koronaviru-matematicke-modely-sireni-epidemie">SIR model epidemie</a>. Prolistujete si výše odkazovaný anglický článek o modelování epidemie v Německu a všimněte si, že se nic ručně nemusí počítat. Rovnice se nasimulují v počítači a člověk jenom plní ty úlohy, které počítače neumí a nikdy umět nemůžou: sestaví model na základě své představy o fungování procesu a poté interpretuje výstup ze simulace.</p>

</div>  <!-- container -->



  <div class='menu-obalka'>
    <a class='menu menu4' href='../../'>Matematika</a><a class='menu menu4 ACTIVE' href='../'>Přednáška</a><a class='menu menu4' href='../cviceni'>Cvičení</a><a class='menu menu4' href='https://um.mendelu.cz/'>WeBWorK</a>
  </div>
	
 <div class='menu-obalka'><a class='menu' href='../intro'>0</a><a class='menu  ' href='../derivace_I'>1</a><a class='menu  ' href='../derivace_II'>2</a><a class='menu  ' href='../derivace_III'>3</a><a class='menu  ' href='../integraly'>4</a><a class='menu  ' href='../integraly2'>5</a><a class='menu  ' href='../ode'>6</a><a class='menu  ' href='../matice'>7</a><a class='menu  ' href='../inverzni_matice'>8</a><a class='menu  ' href='../soustavy'>9</a><a class='menu ACTIVE ' href='../vektorove_pole'>10</a><a class='menu  ' href='../dvojny_integral'>11</a><a class='menu  ' href='../numerika'>12</a><a class='menu  ' href='../shrnuti'>13</a> </div> 


<div class="footer">
      Copyright by Robert Mařík, content is available under <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener">CC BY-SA 3.0</a>, built with <a href="https://www.pandoc.org" target="_blank" rel="noopener">Pandoc</a>
   </div>



<style>
  .shorten {
      border-left: solid;
      border-left-color:gray;
      padding-left:1em;
      max-height:300px;
      overflow:hidden;
      margin-bottom:20px;
      margin-top:20px;
          -webkit-mask-image: linear-gradient(180deg, #000 20%, transparent);
  }
  .rozbalovatko {
      color:gray;
      margin-bottom:30px;
      display:block;
      background-color: gainsboro;
  }
  .rozbalovatko p {padding:10px; margin-top:0px;}
  .rozbalovatkoPopisek {
      color:orangered;
      background-color:#444;
      font-weight: bold;
      display:block;
      padding:5px;
      margin-left: -20px;
      padding-left: 20px;
  }
  .rozbalovatko p {
      color:crimson;
  }
</style>

<script>


jQuery( document ).ready(function() {
    jQuery(".shorten").each(function(){
	popisek = jQuery(this).data("text");
	if (!popisek) {popisek="";}
	jQuery(this).prepend("<span class=\"rozbalovatko\"><span class=\"rozbalovatkoPopisek\">Volitelný text. Klikněte pro rozbalení.</span><p>"+popisek+"</p></span>").css("background-color","gainsboro");
    });

    jQuery(".rozbalovatko").each(function(){
    	jQuery(this).parent().click(function() {
            jQuery( this ).css("max-height","100%").css("-webkit-mask-image","none").css("background-color","inherit");
	    jQuery( this ).children(".rozbalovatko").slideUp();
	    jQuery( this ).unbind("click");
	})
    });
});

</script>

  
</body>
</html>
