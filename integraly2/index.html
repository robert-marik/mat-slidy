<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Robert Mařík" />
  <title>Integrály pro pokročilé</title>
  <style type="text/css">code{white-space: pre;} body {  font-family: "Open Sans", Sans-Serif;}</style>
<link href="../lity/dist/lity.css" rel="stylesheet">
  <link rel="stylesheet" href="../my.css?123" type="text/css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../lity/dist/lity.js"></script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  

 <script type="text/javascript">

function otevrit(co)
   {
       seed=Math.round(Math.random()*1000);
       window.open('http://um.mendelu.cz/webwork2/html2xml?&answersSubmitted=0&sourceFilePath='+co+'&problemSeed='+seed+'&displayMode=MathJax&courseID=daemon&userID=demon&course_password=demonek&outputformat=simpleM&language=cs_CZ', '_blank');
   };

function    myFunctionYTB()
    {
        //jQuery(".reseni").slideToggle();
	jQuery(".Ycontainer").slideToggle();
    }
        

  </script>

</head>
<body>

  <div class='menu-obalka'>
    <a class='menu menu4' href='../../'>Matematika</a><a class='menu menu4 ACTIVE' href='../'>Přednáška</a><a class='menu menu4' href='../cviceni'>Cvičení</a><a class='menu menu4' href='https://um.mendelu.cz/'>WeBWorK</a>
  </div>
	
 <div class='menu-obalka'><a class='menu' href='../intro'>0</a><a class='menu  ' href='../derivace_I'>1</a><a class='menu  ' href='../derivace_II'>2</a><a class='menu  ' href='../derivace_III'>3</a><a class='menu  ' href='../integraly'>4</a><a class='menu ACTIVE ' href='../integraly2'>5</a><a class='menu  ' href='../ode'>6</a><a class='menu  ' href='../matice'>7</a><a class='menu  ' href='../inverzni_matice'>8</a><a class='menu  ' href='../soustavy'>9</a><a class='menu  ' href='../vektorove_pole'>10</a><a class='menu  ' href='../dvojny_integral'>11</a><a class='menu  ' href='../numerika'>12</a><a class='menu  ' href='../shrnuti'>13</a> </div> 

<div class="container">
<div id="header">
<h1 class="title">Integrály pro pokročilé</h1>
<h2 class="author">Robert Mařík</h2>
<h3 class="date">2019-2020</h3>
</div>

<!-- YTB -->


<div>
<button onclick="myFunctionYTB()">Videa on/off</button>
<button onclick="jQuery('.shorten').css('display','none');">Volitelné části off</button>
</div>


<div id="TOC">
<ul>
<li><a href="#vlastnosti-integrálu">Vlastnosti integrálu</a></li>
<li><a href="#střední-hodnota">Střední hodnota</a></li>
<li><a href="#výpočet-práce-pomocí-integrálu">Výpočet práce pomocí integrálu</a></li>
<li><a href="#numerická-aproximace-určitého-integrálu">Numerická aproximace určitého integrálu</a></li>
<li><a href="#integrace-substituční-metodou">Integrace substituční metodou</a></li>
<li><a href="#integrál-jako-funkce-meze">Integrál jako funkce meze</a></li>
<li><a href="#shrnutí-hlavní-myšlenky">Shrnutí, hlavní myšlenky</a></li>
</ul>
</div>

<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/nvagZcCVm4k"></iframe> </div>
<p>Naučili jsme se integrovat pomocí neurčitého a určitého integrálu. Neurčitý integrál vyjadřuje funkční hodnotu vypočítanou z akumulace okamžitých změn. Z principiálních důvodů není možné, pokud je zadána pouze rychlost změny, určit celou veličinu, ale jenom její změnu. Proto je neurčitý integrál dán jednoznačně až na aditivní konstantu. Velikost změny na zadaném intervalu je dána určitým integrálem, ke kterému je možné dospět i geometricky a fyzikálně názorným způsobem představeným v definici Riemannova integrálu. Ten otevírá možnost rozšířit platnost mnoha fyzikálních vzorců na případ, kdy parametry úlohy nejsou konstantní. Dokážeme tak počítat dráhu pohybu proměnnou rychlostí, tlak vody na plochu ponořenou napříč různými hloubkami a podobně.</p>
<p>V následujícím textu rozvineme některé poznatky o integrálu, odvodíme si některé pokročilejší metody pro výpočet, ukážeme si, že každá spojitá funkce má primitivní funkci a také otevřeme cestu k definování funkcí, které nejsou elementární.</p>
<p>Nejprve si připomeneme jednu ze základních aplikací integrálu: nasčítání příspěvků od spojitě se měnící veličiny.</p>
<div class="shorten" data="" data-text="Ukázka vysvětluje, proč trubky praskají podélně. Demonstruje integrál jako nástroj k sečtení nekonečně mnoha příspěvků, protože celkovou sílu je potřeba určit jako součet sil v každém bodě trubky. Protože z různých bodech je síla různá (má jiný směr), nedá se celková síla určit násobením tlaku a obsahu. ">
<h2 id="příklad-proč-trubky-praskají-podélně">Příklad: proč trubky praskají podélně?</h2>
<div class="obtekat">
<figure>
<img src="hoop_stress.png" alt="Schema válcové nádoby pod tlakem a řezy, v nichž počítáme namáhání." /><figcaption>Schema válcové nádoby pod tlakem a řezy, v nichž počítáme namáhání.</figcaption>
</figure>
<figure>
<img src="impregnacni_komora.jpg" alt="Znalost napětí, které tlak způsobí na obalu nádoby, je důležitá pro práci s tlakovými a podtlakovými nádobami. Ty jsou nejčastěji cylindrické nebo kulové. Na obrázku unikátní zařízení pro tlakovou impregnaci ve VCJR v Útěchově se soustavou trubek a tlakových nádob. Zdroj: J. Dömény." /><figcaption>Znalost napětí, které tlak způsobí na obalu nádoby, je důležitá pro práci s tlakovými a podtlakovými nádobami. Ty jsou nejčastěji cylindrické nebo kulové. Na obrázku unikátní zařízení pro tlakovou impregnaci ve VCJR v Útěchově se soustavou trubek a tlakových nádob. Zdroj: J. Dömény.</figcaption>
</figure>
<figure>
<img src="popraskane_trubky.jpg" alt="Natlakovaná válcová nádoba modeluje i trubku pod tlakem. Takové trubky praskají podélně, protože v tom směru je dvojnásobné tahové napětí. Na obrázku jsou vodovodní trubky roztrhané mrazem. Zdroj: http://datagenetics.com/blog/december22013, Ian Mercer." /><figcaption>Natlakovaná válcová nádoba modeluje i trubku pod tlakem. Takové trubky praskají podélně, protože v tom směru je dvojnásobné tahové napětí. Na obrázku jsou vodovodní trubky roztrhané mrazem. Zdroj: http://datagenetics.com/blog/december22013, Ian Mercer.</figcaption>
</figure>
</div>
<p>Uvažujme natlakovanou válcovou nádobu s tlakem <span class="math inline">\(p\)</span>, výškou <span class="math inline">\(L\)</span>, poloměrem podstavy <span class="math inline">\(r\)</span> a stěnou o tloušťce <span class="math inline">\(t\)</span>.</p>
<p>Vypočteme namáhání silou v ose, tj. namáhání řezu A. Obsah řezu (vyšrafováno červeně) je <span class="math inline">\(2\pi r t\)</span>. Na dno a víko působí síla <span class="math inline">\(F=p\pi r^2\)</span> a v řezu A kolmém na osu válce je tahové napětí <span class="math display">\[\sigma_{p} = \frac FS=\frac {p\pi r^2}{2\pi rt}=\frac {pr}{2t}.\]</span></p>
<p>Směrem radiálně od osy se tlaková síla rozkládá na celou plochu pláště válce a v tomto směru je tahové napětí minimální.</p>
<p>Vypočteme poslední složku přispívající k namáhání pláště válce, obvodové napětí. K tomu musíme vypočítat sílu, která působí po obvodě válce, tj. která se snaží válec roztrhnout v řezu B. Tento řez má obsah (červeně vyznačeno) <span class="math inline">\(2Lt\)</span>. Nejtěžší bude najít celkovou sílu, která od sebe oddaluje dvě poloviny pláště. To je místo, kde zapojíme integrál.</p>
<p>Kousek pláště válce odpovídající úhlu <span class="math inline">\(\Delta \alpha\)</span> má obsah <span class="math inline">\(rL\Delta \alpha\)</span> a tlaková síla na tento kousek je součin tlaku a obsahu, tj. <span class="math display">\[\Delta F=pS=p Lr\Delta \alpha .\]</span> Směr je kolmý k plášti válce a s vodorovnou osou svírá úhel <span class="math inline">\(\alpha\)</span>. Průmět této síly do vodorovného směru je <span class="math display">\[\Delta F_x=pLr\Delta \alpha \cos \alpha\]</span> a tyto příspěvky musíme posčítat na intervalu <span class="math inline">\(\alpha \in \left[-\frac\pi 2,\frac \pi 2\right]\)</span>. Celková síla, která se snaží nádobu roztrhnout podélně je <span class="math display">\[F_x=\int_{-\frac \pi2}^{\frac \pi 2} prL \cos \alpha \,\mathrm d \alpha 
=prL [\sin \alpha]_{-\frac \pi 2}^{\frac \pi 2}=prL \left[\sin\frac \pi 2 -\sin\left(-\frac \pi2 \right)\right]=2p rL.\]</span> Povrch na který tato síla působí odpovídá dvěma podélným hranám (červeně na řezu B), tj. má obsah <span class="math inline">\(2Lt\)</span> a napětí je tedy <span class="math display">\[\sigma_{h}=\frac{2pLr}{2Lt}=\frac{pr}t=2\sigma_p.\]</span> Vidíme, že toto napětí je dvojnásobkem napětí v podélné ose.</p>
<p>Ještě je vhodné ověřit, že svislý průmět, tj . <span class="math display">\[\Delta F_y=pLr\Delta \alpha \sin \alpha\]</span> k namáhání nepřispívá, protože <span class="math display">\[F_y=\int_{-\frac \pi2}^{\frac \pi 2} prL \sin \alpha \,\mathrm d \alpha 
=0.\]</span> To však je možné očekávat i ze symetrie.</p>
<p>Pokud se chcete dozvědět více, zkuste Google a heslo “hoop stress”.</p>
</div>
<h1 id="vlastnosti-integrálu">Vlastnosti integrálu</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/uyiQAbYZVRU"></iframe> </div>
<div class="obtekat">
<figure>
<img src="int_vlastnosti.png" alt="Monotonie a aditivia vzhledem k mezi pro určitý integrál." /><figcaption>Monotonie a aditivia vzhledem k mezi pro určitý integrál.</figcaption>
</figure>
</div>
<p>Z minulé přednášky víme, že integrál (určitý i neurčitý) je lineární, tj. zachovává součet funkcí a násobení konstantou.</p>
<p>Následující dvě věty nejsou překvapivé. Vyjadřují dvě intuitivně zřejmá fakta.</p>
<ul>
<li>Pokud se veličina mění rychleji, výsledná změna je větší.</li>
<li>Pokud sledujeme změnu veličiny za určitý čas, můžeme sledovat změnu do nějakého mezičasu a poté od mezičasu do konce a obě částečné změny poté sečíst.</li>
</ul>
<p>Je však důležité vědět, že tyto myšlenky platí pro libovolné integrovatelné funkce a proto zformulujeme následující věty.</p>
<blockquote class="veta"><p class="vetaname">Věta (monotonie vzhledem k funkci).</p><p> Je-li <span class="math inline">\(f(x)\geq g(x)\)</span> na intervalu <span class="math inline">\([a,b]\)</span>, platí <span class="math display">\[\int_a^b f(x)\,\mathrm dx\geq \int_a^b
g(x)\,\mathrm dx.\]</span></p>
</blockquote>
<blockquote class="veta"><p class="vetaname">Důsledek.</p><p> Integrál nezáporné funkce je nezáporný. Přesněji, je-li <span class="math inline">\(a&lt;b\)</span> a <span class="math inline">\(f(x)\geq 0\)</span> na <span class="math inline">\([a,b]\)</span>, platí <span class="math display">\[\int _a^b f(x)\,\mathrm dx \geq 0.\]</span></p>
</blockquote>
<blockquote class="veta"><p class="vetaname">Věta (aditivita vzhledem k integračnímu oboru).</p><p> Platí <span class="math display">\[\int_a^b f(x)\,\mathrm dx= \int_a^c f(x)\,\mathrm dx + \int_c^b f(x)\,\mathrm dx.\]</span></p>
</blockquote>
<p>Věta o aditivitě vzhledem k integračnímu oboru je například pro Newtonovu definici integrálu důsledkem zřejmého vztahu <span class="math display">\[[F(b)-F(c)]+[F(c)-F(a)]=F(b)-F(a)\]</span> pro libovolnou primitivní funkci <span class="math inline">\(F\)</span>. Graficky i fyzikálně je názorný případ, kdy <span class="math inline">\(c\)</span> leží v intervalu <span class="math inline">\([a,b]\)</span>. Vzorec však platí pro libovolné uspořádání mezí podle velikosti.</p>
<h1 id="střední-hodnota">Střední hodnota</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/8Qc0RI4T5LI"></iframe> </div>

<div class="obtekat">
<figure>
<img src="tepelna_vodivost.png" alt="Když materiálová konstanta není konstantní a chceme ji zprůměrovat, použijeme integrální střední hodnotu. Zdroj: Cengel, Ghajar: Heat and Mass Transfer." /><figcaption>Když materiálová konstanta není konstantní a chceme ji zprůměrovat, použijeme integrální střední hodnotu. Zdroj: Cengel, Ghajar: Heat and Mass Transfer.</figcaption>
</figure>
</div>

<p>Určitou souvislost s monotonií vzhledem k funkci má otázka, zda je možné funkci definovanou na intervalu <span class="math inline">\([a,b]\)</span> nahradit funkcí konstantní tak, aby obě funkce měly stejný integrál. V praxi to znamená, že bychom například při pohybu tělesa časový průběh rychlosti nahradili jednou hodnotou takovou, že dráha za daný čas bude stejná. To je přesně to, co známe z běžného života jako definici průměrné rychlosti. Je to současně i návod pro následující rozšíření pojmu průměrná rychlost na libovolné integrovatelné funkce. Jedná se vlastně o jakousi průměrnou hodnotu, při které ale nepočítáme průměr z konečného počtu hodnot, ale z hodnot rozložených spojitě na zadaném intervalu.</p>
<p>Definice střední hodnoty je snadným důsledkem toho, že hledáme hodnotu <span class="math inline">\(\mu\)</span> s vlastností <span class="math display">\[\int_a^b f(x)\,\mathrm dx=\int_a^b \mu\,\mathrm dx=\mu \int_a^b \mathrm dx=\mu(b-a).\]</span></p>
<blockquote class="definice"><p class="definicename">Definice (střední hodnota).</p><p> Nechť <span class="math inline">\(f\)</span> je funkce definovaná a integrovatelná na uzavřeném intervalu <span class="math inline">\([a,b]\)</span>. Číslo <span class="math inline">\(\mu\)</span> definované vztahem <span class="math display">\[\mu=\frac 1{b-a}\int_a^b f(x)\,\mathrm dx\]</span> se nazývá <em>střední hodnota</em> funkce <span class="math inline">\(f\)</span> na intervalu <span class="math inline">\([a,b]\)</span>.</p>
</blockquote>
<div class="obtekat">
<figure>
<img src="mean.png" alt="Střední hodnota lineární a obecné funkce." /><figcaption>Střední hodnota lineární a obecné funkce.</figcaption>
</figure>
</div>
<p>Geometricky je střední hodnota výška obdélníka, který má jednu stranu tvořenou intervalem <span class="math inline">\([a,b]\)</span> a obsah je roven integrálu <span class="math inline">\(\int_a^b f(x)\,\mathrm dx.\)</span> Pokud je funkce <span class="math inline">\(f(x)\)</span> kladná a lineární, je tento integrál roven obsahu lichoběžníka o základnách <span class="math inline">\(f(a)\)</span> a <span class="math inline">\(f(b)\)</span> a výšce <span class="math inline">\(b-a\)</span>. Tedy <span class="math display">\[\int_a^b f(x)\,\mathrm dx=(b-a)\frac{f(a)+f(b)}2\]</span> a střední hodnota lineární funkce je tedy průměrem hodnoty na začátku a na konci intervalu.</p>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (střední hodnota materiálové konstanty).</p><p> Tepelná vodivost materiálu podobeného analýze tepelně-izolačních vlastností nemusí být konstantní v celém rozsahu teplot, ale může se měnit s teplotou. Pokud je známa funkce <span class="math inline">\(k(T)\)</span>, je střední hodnota tepelné vodivosti v tepelném rozsahu od <span class="math inline">\(T_1\)</span> do <span class="math inline">\(T_2\)</span> dána vztahem (viz Cengel, Ghajar: Heat and Mass Transfer) <span class="math display">\[k_{avg}=\frac 1{T_2-T_1} \int_{T_1}^{T_2} k(T)\,\mathrm dT\]</span> V praxi nemáme analytický předpis pro funkci <span class="math inline">\(k(T)\)</span>, ale funkce je dána v několika bodech tabulkou. Takové funkce můžeme integrovat numericky, což bude ukázáno v další části této přednášky.</p>
</blockquote>
<p><strong>Příklad.</strong> Střední hodnota funkce <span class="math inline">\(y=2x^2-1\)</span> na intervalu <span class="math inline">\([0,2]\)</span> je <span class="math display">\[\frac 12 \int_0^2 2x^2-1 \,\mathrm dx=\frac 12 \left[\frac 23 x^3-x\right]_0^2=\frac 12 \left[\frac 23 8-2 - 0\right]=\frac 53.\]</span></p>
<p><a href="https://sagecell.sagemath.org/?z=eJwz1DfSyswrSU0vSixJ1TDSqogz0jXU0ajQMdAx0tQEAIuACEI=&amp;lang=sage">Online výpočet.</a></p>

<p>Výpočet střední hodnoty si také můžete procvičit v následujících cvičeních.</p>
<a onclick=otevrit("problems/integraly_pouziti/stredni_hodnota.pg"); target="_blank" class="WWotazka">Testová otázka</a>
<a onclick=otevrit("problems/integraly_pouziti/stredni_hodnota_2.pg"); target="_blank" class="WWotazka">Testová otázka</a>
<a onclick=otevrit("problems/integraly_pouziti/stredni_hodnota_3.pg"); target="_blank" class="WWotazka">Testová otázka</a>

<!--

<div class='obtekat'>

![Graf počtu nemocných chřipkou. Čárkovaně je dlouhodobý trend, okolo kterého počet nemocných osciluje s krátkou periodou. Zelená plná křivka je pětiletý průměr začínající v daném roce. Minimum této křivky je vhodný okamžik pro začátek plošné vakcinace.](graf.png)

</div>


**Příklad.** (Podle Leah Edelstein-Keshet: Integral Calculus with
Applications to the Life Sciences). Health Canada dlouhodobě monitoruje
chřipku. Ze získaných dat vyplývá, že u této nemoci existuje sezonní
cyklus s krátkou periodou a dlouhodobý dvacetiletý cyklus s dlouhou
periodou. Je-li $t$ čas v měsících, je počet nemocných (ve stotisících
jedinců) dobře aproximován funkcí $$I(t)=\cos\left(\frac \pi 6
t\right)+\cos\left(\frac \pi {120} t\right)+2.$$ Health Canada má
snahu chřipku eliminovat z populace očkováním. Odhaduje se, že je
nutné pětileté období intenzivní vakcinace. Pro co nejnižší náklady je
vhodné vakcinaci začít v období, kdy je virus na pětiletém
minimu. Střední hodnota za pětileté období počínající časem $t_0$ je
$$\overline I(t_0)=\frac 1{12\times 5}\int_{t_0}^{t_0+12\times 5}
I(t)\,\mathrm dt.$$

Pro výpočet minima funkce $\overline I(t_0)$ je nutné umět derivovat
funkce, které jsou vyjádřeny integrálem a proměnná je v mezi tohoto
integrálu. To se naučíme v dalších částech přednášky a poté se k
tomuto příkladu vrátíme.

[Online výpočet.](https://sagecell.sagemath.org/?z=eJxtjs0KgzAQhO-C75BbNj9iErG3XD3nFcTGIAQjcSn27du0pT_Q2-x8M8xexgwUKaurGZDZKe2wLe2JIxMvrY0ql6mr8JX4uENxdQva8J4RTpYVfcgjepjhYBIOiRJFz7Vh95W6ctpuMeGbKtkrVZAzTxB-gCRTiilbmv2ZShKX1e94jd7Spilvu-7ZGv63QvZ-feS0cEa47gb9BD-U&lang=sage)

-->
<h1 id="výpočet-práce-pomocí-integrálu">Výpočet práce pomocí integrálu</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/Z8wDZxap794"></iframe> </div>
<div class="shorten" data-text="Práci určujeme jako součin síly a posunutí. Co když se ale síla během konání práce snižuje? Například při vytahování řetězu na střechu visí dolů stále menší část řetězu a síla je stále menší. Potom se místo součinu dá použít integrál. ">
<h2 id="příklad-práce-při-vytahování-řetězu">Příklad: práce při vytahování řetězu</h2>
<div class="obtekat">
<figure>
<img src="chain.jpg" alt="Visící řetěz. Při vytahování na střechu se zmenšuje síla, kterou je nutno překonávat. Zdroj: pixabay.com" /><figcaption>Visící řetěz. Při vytahování na střechu se zmenšuje síla, kterou je nutno překonávat. Zdroj: pixabay.com</figcaption>
</figure>
</div>
<p>Ze střechy budovy o výšce <span class="math inline">\(50\)</span> metrů visí řetěz dlouhý <span class="math inline">\(30\)</span> metrů. Jeden metr řetězu váží dva kilogramy. Vypočítáme práci potřebnou pro povytažení řetězu o deset metrů a poté práci potřebnou pro úplné vytažení řetězu.</p>
<p>Z fyziky víme, že na těleso o hmotnosti <span class="math inline">\(m\)</span> působí síla <span class="math inline">\(F\)</span> daný vztahem <span class="math display">\[F=mg,\]</span> kde <span class="math inline">\(g\)</span> je tíhové zrychlení a že práce <span class="math inline">\(W\)</span> konaná silou <span class="math inline">\(F\)</span> po dráze <span class="math inline">\(s\)</span> je rovna součinu <span class="math display">\[W=Fs.\]</span></p>
<p>Pokud z budovy visí <span class="math inline">\(h\)</span> metrů řetězu o lineární hustotě <span class="math inline">\(\tau=2\,\mathrm{kg}/\mathrm m\)</span>, je nutné při vytahování řetězu zvedat těleso o hmotnosti <span class="math inline">\(h\tau\)</span>, tj. vyvinout sílu <span class="math display">\[F=h\tau g.\]</span> Při vytahování řetězu se délka visící části zkracuje a změna délky <span class="math inline">\(\Delta h\)</span> je záporná. Při povytažení řetězu o délku <span class="math inline">\(|\Delta h|=-\Delta h\)</span> je nutné vykonat práci <span class="math display">\[\Delta
W=F|\Delta h|=-h\tau g \Delta h.\]</span></p>
<p>Při povytažení o 10 metrů řetěz vytahujeme spojitě od <span class="math inline">\(h_1=30\)</span> po <span class="math inline">\(h_2=20\)</span>. Celková práce je <span class="math display">\[\begin{aligned}W&amp;=\int_{h_1}^{h_2}-h\tau g\,\mathrm dh=\tau g\int_{h_2}^{h_1}h\,\mathrm dh
=\tau g\left[\frac 12 h^2\right]_{h_2}^{h_1}\\&amp;
=\tau g\left[\frac 12 h_1^2 - \frac 12 h_2^2\right]=\frac 12 \tau g (h_1^2-h_2^2)
\\&amp;=\frac 12 \tau g (h_1-h_2)(h_1+h_2).
\end{aligned}
\]</span> Pro <span class="math inline">\(\tau =2\,\mathrm{kg}\,\mathrm m^{-1}\)</span> a <span class="math inline">\(g=9.81\, \mathrm{kg}\,\mathrm{m}\,\mathrm {s}^{-2}\)</span> dostáváme <span class="math inline">\(W=4905\,\mathrm J.\)</span> Formálně je tento výsledek stejný, jako bychom hmotnost dolních <span class="math inline">\(h_1-h_2\)</span> metrů řetězu soustředili do středu tohoto úseku (tedy do úrovně <span class="math inline">\(\frac 12 (h_1+h_2)\)</span> metrů pod střechu) a poté tento hmotný bod přemístili konstantní silou po dráze <span class="math inline">\(\frac 12 (h_1+h_2)\)</span> na střechu.</p>
<p>Práci pro vytažení celého řetězu dostaneme volbou <span class="math inline">\(h_2=0\)</span>. Tedy <span class="math display">\[W=\frac 12 \tau g h_1^2\]</span> a numericky <span class="math inline">\(W=8829\,\mathrm J.\)</span> Protože vytáhnout první třetinu nejtěžší, očekáváme, že práce potřebná pro vytažení celého řetězu bude menší než trojnásobek práce nutné pro povytažení o třetinu. Toto se přirozeně potvrzuje porovnáním numerických hodnot.</p>
<p><a href="https://sagecell.sagemath.org/?z=eJwrSyzSUC9JLFVIV8hQyDBUyDBS1-TlKs7IL9fIzCtJTS9KLElV0NDN0AKq0UrX0cjQyTDUyTDS1CROlUaGka0BsWqBArZGOum2lnoWQBFDW2MDoLitEYX6wdoBxXNBdg==&amp;lang=sage">Online výpočet.</a></p>
</div>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (práce konaná silou proměnné velikosti).</p><p> Práce vykonaná silou <span class="math inline">\(F(x)\)</span> při přemístění tělesa z polohy <span class="math inline">\(x=a\)</span> do polohy <span class="math inline">\(x=b\)</span> je <span class="math display">\[W=\int_a^b F(x)\,\mathrm dx.\]</span> Jako speciální případ dostáváme pro konstantní sélu <span class="math inline">\(F\)</span> středoškolský vzorec <span class="math display">\[W=Fs,\]</span> kde <span class="math inline">\(s=b-a\)</span> je posunutí.</p>
</blockquote>
<div class="shorten" data-text="Příklad konání práce konstantní silou ale po různých drahách je vyčerpávání nádrže. Litr vody u hladiny se při čerpání musí přmístit o jinou výšku než litr vody u dna a proto se práce nedá vypočítat jako součin síly a posunutí. Dá se však vypočítat integrálem.">
<h2 id="příklad-práce-při-čerpání-vody">Příklad: práce při čerpání vody</h2>
<div class="obtekat">
<figure>
<img src="mojzisuv_most_pod_vodou.jpg" alt="Mojžíšův most je z obou stran chráněný přehradou umožňující regulací výšky vody v okolí mostu, vzhledem k charakteru krajiny v Holandsku však není překvapení, že může být i zatopený. Zdroj: http://veryhungryexplorer.com/the-day-i-nearly-walked-on-water/" /><figcaption>Mojžíšův most je z obou stran chráněný přehradou umožňující regulací výšky vody v okolí mostu, vzhledem k charakteru krajiny v Holandsku však není překvapení, že může být i zatopený. Zdroj: http://veryhungryexplorer.com/the-day-i-nearly-walked-on-water/</figcaption>
</figure>
</div>
<p>Pokud potřebujeme vyčerpat vodu z rezervoáru, nádrže, rybníka nebo jezera, musíme ji dopravit za stěnu (za hráz, dostat na břeh, …). Představme si, že po opadnutí vody v okolí Mojžíšova mostu, se kterým jsme se seznámili na minulé přednášce, zůstane uvnitř voda. Tu je potřeba vyčerpat. Tím se most proměnil v nádrž o hloubce <span class="math inline">\(H\)</span>. Povrch hladiny ve chvíli, kdy je voda <span class="math inline">\(x\)</span> jednotek délky pod okrajem mostu označme <span class="math inline">\(S\)</span>. (Pro nádrž ve tvaru kvádru by <span class="math inline">\(S\)</span> bylo konstantní a rovno obsahu dna.)</p>
<ol type="1">
<li>Pro vyzvednutí tělesa o hmotnosti <span class="math inline">\(m\)</span> o výšku <span class="math inline">\(h\)</span> musíme vykonat práci <span class="math inline">\(W=mgh,\)</span> abychom vykompenzovali nárůst potenciální energie.</li>
<li>Vodu v nádrži rozdělíme na vodorovné vrstvy o výšce <span class="math inline">\(\Delta x\)</span>. Hmotnost vrstvy o výšce <span class="math inline">\(\Delta x\)</span> v hloubce <span class="math inline">\(x\)</span> pod okrajem nádrže bude <span class="math inline">\(\Delta m=S\Delta x\rho\)</span> a abychom vodu dostali přes okraj, musíme vykonat práci <span class="math display">\[\Delta W=\Delta m gx=S\Delta x\rho
gx.\]</span></li>
<li>Celková práce na vyčerpání vody se vypočte jako součet jednotlivých příspěvků. Spojitě se měnící veličinu sčítáme integrálem, což vede na vztah <span class="math display">\[W=\int_0^H S\rho gx \,\mathrm dx=\rho g\int_0^H Sx
\,\mathrm dx.\]</span></li>
<li>Pro nádrže ve tvaru kvádru by veličina <span class="math inline">\(S\)</span> byla konstantní a integrál by vycházel <span class="math display">\[W=S\rho g\int_0^H x\,\mathrm dx=S\rho g\left[\frac 12 x^2\right]_0^H=S\rho g\frac 12 H^2=(SH\rho)g\frac 12 H.\]</span> Výraz <span class="math inline">\(SH\rho\)</span> je celková hmotnost. Práce je tedy stejná, jako kdybychom těleso o stejné hmotnosti jako je hmotnost vodní masy zvedli z poloviční hloubky pod hladinou na úroveň hladiny. Je to stejná práce, jakou bychom vykonali, kdyby všechna voda byla stlačena v těžišti a my bychom tuto vodu zvedli na úroveň okraje nádrže.</li>
</ol>
</div>
<h1 id="numerická-aproximace-určitého-integrálu">Numerická aproximace určitého integrálu</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/7jo_pZJjgRA"></iframe> </div>
<p>Následující myšlenka se si týká výlučně určitého integrálu, ale dále v dnešní přednášce si představíme nástroj, který umožní ji použít i pro integrál neurčitý.</p>
<p>Někdy se stane, že neumíme nebo nepotřebujeme určitý integrál vypočítat přesně. Nebo že ani nemáme dostatek informací pro přesný výpočet, například funkce může být známa jenom v několika bodech, které jsou výsledkem měření a mimo tyto body nejsou žádné informace o funkčních hodnotách. To je přesně situace pro numerickou aproximaci určitého integrálu. Mechanický model základních myšlenek aproximace je shrnut v několika následujících bodech.</p>
<ul>
<li>Představme si, že máme určit dráhu pohybu, ale v zadaném časovém intervalu máme pouze několik záznamů hodnoty rychlosti z tachometru.</li>
<li>Mimo tyto záznamy se mohlo dít v podstatě cokoliv. Budeme však doufat, že rychlost se měnila spíše pozvolna.</li>
<li>Základní taktika odhadu dráhy může být taková, že mezi každými zaznamenanými hodnotami rychlosti na tachometru nahradíme pohyb rovnoměrným pohybem rychlostí, která je průměrem krajních hodnot.</li>
<li>Předchozí postup aplikovaný na libovolnou funkci odpovídá tomu, že mezi každými dvěma hodnotami nahradíme funkci funkcí lineární a poté integrál vypočítáme pro tuto lineární funkci. Tento postup (lichoběžníkové pravidlo) je možné modifikovat nebo vylepšit. Například je možné použít pro aproximaci části parabol místo přímek (Simpsonovo pravidlo). U funkce, která je rostoucí, je možné například použít funkční hodnotu v dolní mezi a tím dostaneme dolní odhad pro výsledný integrál.</li>
</ul>
<p><strong>Příklad.</strong> Zahradnická firma vytáhla pařez a malotraktorem jej odtáhla o 20 metrů bokem. Vzhledem k nepravidelnému tvaru a tažení po různých druzích povrchu po cestě se síla měnila. Pracovníkovi se podařilo odhadnout sílu během pohybu. Závislost síly na dráze zachycuje následující tabulka.</p>
<style>
table, th, td {
   border: 2px solid green;
} 
td {padding:10px}
tr td:first-child {color:green; background: #E9E9E9;}
table {
    border-collapse: collapse;
}
</style>
<style>
table, th, td {
   border: 2px solid green;
} 
td {padding:10px}
tr td:first-child {color:green; background: #E9E9E9;}
table {
    border-collapse: collapse;
}

th {
    background-color: green;
    color: white;
    border-color: gray;
}

th {text-align: center;}
</style>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(s\)</span>/m</th>
<th>0</th>
<th>5</th>
<th>10</th>
<th>15</th>
<th>20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(F\)</span>/kN</td>
<td>2.3</td>
<td>1.5</td>
<td>2.1</td>
<td>3.1</td>
<td>2.0</td>
</tr>
</tbody>
</table>
<p>Odhadneme celkovou vykonanou práci. <span class="math display">\[W=5 \frac{2.3+1.5}2 +5 \frac{1.5+2.1}2 +5 \frac{2.1+3.1}2 +5 \frac{3.1+2.0}2=44.25 \,\mathrm{kN}\,\mathrm {m} = 44.25\,\mathrm{kJ}\]</span></p>
<p><strong>Poznámka.</strong> V předchozím příkladě byla funkce dána v pravidelných intervalech. Proto se ve všech členech objevuje faktor <span class="math inline">\(\frac 52\)</span>, který je možné vytknout. Po vytknutí zůstane v závorce součet, kde se hodnoty funkce v dolní a horní mezi objeví jednou a ostatní dvakrát. To v obecném případě vede k následujícímu vzorci.</p>
<blockquote class="veta"><p class="vetaname">Věta (lichoběžníkové pravidlo).</p><p> Nechť je funkce <span class="math inline">\(f\)</span> spojitá na intervalu <span class="math inline">\([a,b]\)</span>. Rozdělme interval <span class="math inline">\([a,b]\)</span> na <span class="math inline">\(n\)</span> intervalů stejné délky <span class="math inline">\(h\)</span>, tj. platí <span class="math inline">\(h=\frac{b-a}n\)</span>. Krajní body těchto intervalů označme po řadě <span class="math inline">\(x_0\)</span>, <span class="math inline">\(x_1\)</span>, …, <span class="math inline">\(x_n\)</span> a jim odpovídající funkční hodnoty funkce <span class="math inline">\(f\)</span> po řadě <span class="math inline">\(y_0\)</span>, <span class="math inline">\(y_1\)</span>, …, <span class="math inline">\(y_n\)</span>. Platí <span class="math display">\[
\int_a^bf(x)\,\mathrm dx\approx \frac h2\Bigl(
{y_0}+2y_1+2y_2+\cdots+2y_{n-1}+{y_n}\Bigr).
\]</span></p>
</blockquote>
<blockquote class="poznamka"><p class="poznamkaname">Poznámka (slovní interpretace lichoběžníkového pravidla).</p><p> Pokud ve vzorci pro lichoběžníkové pravidlo dosadíme za hodnotu <span class="math inline">\(h\)</span> odpovídající délku intervalu <span class="math inline">\(\frac{ b-a}n\)</span> a přeuspořádáme členy, dostaneme <span class="math display">\[ \int_a^bf(x)\,\mathrm dx\approx (b-a)\frac {{y_0}+2y_1+2y_2+\cdots+2y_{n-1}+{y_n}}{2n} \]</span> a <span class="math display">\[ \frac 1{b-a}\int_a^bf(x)\,\mathrm dx\approx \frac {{y_0}+2y_1+2y_2+\cdots+2y_{n-1}+{y_n}}{2n}. \]</span> Toto je odhad pro veličinu, kterou jsme výše nazvali střední hodnotou. Lichoběžníkové pravidlo je tedy možné chápat tak, že vezmeme funkční hodnoty v pravidelných intervalech a vypočteme vážený průměr těchto hodnot, kdy všechny funkční hodnoty ve vnitřních bodech se berou s dvojnásobnou vahou než funkční hodnoty v krajních bodech. To je odhad střední hodnoty, který stačí vynásobit délkou intervalu a dostaneme odhad integrálu.</p>
</blockquote>

<p>Výpočet pomocí lichoběžníkového pravidla si také můžete procvičit v následujícícm cvičení.</p>
<a onclick=otevrit("problems/integraly_vypocet/lichobeznikove_pravidlo.pg"); target="_blank" class="WWotazka">Testová otázka</a>

<!--

# Integrace metodou per partés

Metoda per partés je metoda odvozená z derivace součinu. Nechť $u$ a
$v$ jsou funkce, mající derivace $u'$ a $v'$. Snadným důsledkem
derivace součinu
$$(uv)'=u'v+uv'$$
je
$$uv'=(uv)'-u'v.$$
Integrací tohoto vztahu dostáváme následující tvrzení.

> Věta (metoda per partés pro neurčitý a určitý integrál). Nechť $u$ a
> $v$ jsou funkce proměnné $x$, mající spojité derivace $u'$ a
> $v'$. Platí
> $$\int uv' \,\mathrm dx=uv-\int u'v\,\mathrm dx$$
> pro neurčitý integrál a
> $$\int_a^b uv' \,\mathrm dx=[uv]_a^b-\int_a^b u'v\,\mathrm dx$$
> pro integrál určitý.

Použití této metody má smysl, pokud je integrál $\int u'v\,\mathrm dx$
jednodušší pro výpočet ve srovnání s integrálem $\int uv'\,\mathrm
dx.$ Typické situace pro integrování metodou per partés jsou následující.

1. $\int x\sin x\,\mathrm dx$, $\int x\cos x\,\mathrm dx$, $\int xe^x\,\mathrm dx$
1. Mírné obměny integrálů z předchozího bodu, kdy místo $x$ může být libovolný polynom a goniometrická nebo exponenciální funkce má lineární vnitřní složku.
1. $\int x^k\ln x\,\mathrm dx$

**Příklad.** Volbou
$${\begin{aligned} u&= x & u'&=1 \\ v'&=e^x & v&=e^x\end{aligned}}$$
můžeme vypočítat integrál
$$\int x e^x\,\mathrm dx=xe^x-\int 1e^x\,\mathrm dx=xe^x-e^x+c.$$

**Příklad.** Volbou
$${\begin{aligned} u&= \ln x & u'&=\frac 1x \\ v'&=1 & v&=x\end{aligned}}$$
můžeme vypočítat integrál
$$\int \ln x\,\mathrm dx=x\ln x-\int \frac 1x x\,\mathrm dx=x\ln x-\int 1\,\mathrm dx=x\ln x-x+c.$$

-->
<h1 id="integrace-substituční-metodou">Integrace substituční metodou</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/tdK-zog1cv0"></iframe> </div>
<div class="shorten" data-text="Substituční metoda je jedna z metod jak najít neurčitý integrál, který se nedá najít pomocí vzorců. Spočívá v přechodu k jiné proměnné, kdy se počítaný integrál nahradí jiným integrálem, pokud možno jednodušším a integrovatelným pomocí vzorců.">
<p>Substituční metoda je metoda odvozená z derivace složené funkce <span class="math display">\[[u(v(x))]&#39;=u&#39;(v(x))v&#39;(x),\]</span> což dává <span class="math display">\[u(v(x))=\int u&#39;(v(x))v&#39;(x)\,\mathrm dx.\tag{1}\]</span></p>
<p>Označme <span class="math inline">\(u&#39;(x)=f(x)\)</span>, tj. <span class="math inline">\(u(x)=\int f(x)\,\mathrm dx\)</span>. Označíme-li dále <span class="math inline">\(v(x)=t\)</span>, platí <span class="math display">\[u(v(x))=u(t)=\int f(t)\,\mathrm dt.\]</span> Přeznačme ještě <span class="math inline">\(v(x)\)</span> na <span class="math inline">\(\varphi(x)\)</span>. Potom má (1) po záměně levé a pravé strany tvar uvedený v následující větě.</p>
<blockquote class="veta"><p class="vetaname">Věta (substituční metoda pro neurčitý integrál).</p><p> Platí <span class="math display">\[\int f(\varphi (x))\varphi&#39;(x)\,\mathrm dx=\int f(t)\,\mathrm
dt,\tag{2}\]</span> kde po výpočtu integrálu napravo dosazujeme <span class="math inline">\(t=\varphi (x).\)</span></p>
</blockquote>
<p>Formálně výraz napravo ve (2) přejde ve výraz nalevo a naopak dosazením rovností <span class="math display">\[\varphi(x)=t,\qquad \varphi&#39;(x)\,\mathrm dx=\mathrm dt.\]</span> Toto je současně i návod, jak substituční metodu použít prakticky.</p>
<p><strong>Příklad.</strong> Substituce <span class="math inline">\(x^2=t\)</span> vede na vztah mezi diferenciály ve tvaru <span class="math inline">\(2x\,\mathrm dx=\mathrm dt\)</span>. Odsud <span class="math display">\[\int x e^{x^2}\,\mathrm dx=\frac 12 \int e^t\,\mathrm dt=\frac 12e^t=\frac 12 e^{x^2}+c.\]</span></p>
<p><strong>Příklad.</strong> Substituce <span class="math inline">\(f(x)=t\)</span> vede na vztah mezi diferenciály ve tvaru <span class="math inline">\(f&#39;(x)\,\mathrm dx=\mathrm dt\)</span>. Odsud <span class="math display">\[\int \frac {f&#39;(x)}{f(x)}\,\mathrm dx=\int \frac 1t\,\mathrm dt=\ln |t|=\ln|f(x)|+c.\]</span> Například <span class="math display">\[\int \frac{x}{x^2+1}\,\mathrm dx=\frac 12\int \frac{2x}{x^2+1}\,\mathrm dx= \frac 12\int \frac{(x^2+1)&#39;}{x^2+1}\,\mathrm dx=\frac 12 \ln|x^2+1|+c.\]</span></p>
<p><strong>Příklad.</strong> Substituce <span class="math inline">\(ax+b=t\)</span> vede na vztah mezi diferenciály ve tvaru <span class="math inline">\(a\,\mathrm dx=\mathrm dt\)</span>. Odsud je možné odvodit vzorec, který již známe pro integrál funkce s lineární vnitřní složkou. Vskutku, platí <span class="math display">\[\int  f(ax+b)\,\mathrm dx= \int  \frac 1af(t)\,\mathrm dt= \frac 1a F(t)= \frac 1a F(ax+b)+C,\]</span> kde <span class="math inline">\(F(x)=\int f(x)\,\mathrm dx.\)</span></p>
<p>Vztah (2) je základní vztah pro substituci v neurčitém integrálu. Používáme jej ve vhodných případech zprava doleva i zleva doprava. Variantu pro určitý integrál jsme viděli ve speciálním případě ve cvičení, kdy vnitřní funkce reprezentovala konstantní násobek. Viděli jsme přirozeným způsobem, že při substituci (vyjádření v jiných jednotkách) se s integrovanou funkcí se mění i meze. Obecný vzorec pro integrování určitého integrálu substituční metodou je v následující větě.</p>
<blockquote class="veta"><p class="vetaname">Věta (substituční metoda pro určitý integrál).</p><p> Platí <span class="math display">\[\int_a^b f(\varphi (x))\varphi&#39;(x)\,\mathrm dx=\int_{\varphi
(a)}^{\varphi(b)} f(t)\,\mathrm dt.\]</span></p>
</blockquote>
<p>Meze tedy podléhají stejné transformaci, jako integrovaná proměnná. Pokud používáme substituci <span class="math inline">\(t=\varphi(x)\)</span>, potom v dolní mezi pro <span class="math inline">\(x=a\)</span> platí <span class="math inline">\(t=\varphi(a).\)</span> Podobná situace je i v mezi horní.</p>
</div>
<h1 id="integrál-jako-funkce-meze">Integrál jako funkce meze</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/qUwPJkVBFOQ"></iframe> </div>
<p>Integrál může být součástí definice funkce. Tím se můžeme dostat mimo množinu elementárních funkcí a značně tak rozšířit třídu funkcí, se kterými umíme pracovat.</p>
<blockquote class="veta"><p class="vetaname">Věta (integrál jako funkce horní meze).</p><p> Buď <span class="math inline">\(f\)</span> spojitá funkce na intervalu <span class="math inline">\(I\)</span> a <span class="math inline">\(a\in I\)</span>. Funkce <span class="math inline">\(F(x)\)</span> definovaná vztahem <span class="math display">\[
F(x):=\int_a^x f(t)\,\mathrm dt
\]</span> má na intervalu <span class="math inline">\(I\)</span> derivaci a platí <span class="math inline">\(F&#39;(x)=f(x)\)</span>, tj. <span class="math inline">\(F(x)\)</span> je primitivní funkcí k funkci <span class="math inline">\(f(x)\)</span>.</p>
</blockquote>
<p><strong>Příklad.</strong> Pro funkci <span class="math inline">\(f(x)=x^2\)</span> platí <span class="math display">\[\int_0^x t^2\,\mathrm dt=\left[\frac
    {t^3}{3}\right]_0^{x}=\frac{x^3}{3}\]</span> což je skutečně jedna z primitivních funkcí k funkci <span class="math inline">\(x^2\)</span>, jak již víme z přednášky o neurčitém integrálu.</p>
<p>Věta o integrálu jako funkci horní meze dokonce udává tvar primitivní funkce pro libovolnou spojitou funkci. Tím dostáváme okamžitě následující tvrzení.</p>
<blockquote class="veta"><p class="vetaname">Důsledek (postačující podmínka existence primitivní funkce).</p><p> Ke každé spojité funkci existuje neurčitý integrál.</p>
</blockquote>
<p>Bohužel, ne vždy neurčitý integrál dokážeme efektivně najít. Zatímco problém nalezení derivace funkce složené z funkcí, které umíme derivovat, spočívá pouze ve správné aplikaci vzorců pro derivování, problém nalézt neurčitý integrál i k funkci tak jednoduché, jako je například <span class="math inline">\(e^{-x^2}\)</span> je neřešitelný ve třídě elementárních funkcí. Totéž platí pro další “nevinně vyhlížející” funkce jako <span class="math inline">\(\int \sin (x^2)\,\mathrm dx\)</span> nebo <span class="math inline">\(\int \frac{\sin x}{x}\,\mathrm dx\)</span>. Věta o integrálu jako funkci horní meze nabízí možnost zapsat primitivní funkci vztahem <span class="math display">\[\int e^{-x^2}\,\mathrm dx=c+\int_0^x
e^{-t^2}\,\mathrm dt.\]</span> Funkční hodnoty takové funkce můžeme určovat například tak, že integrál aproximujeme numericky.</p>
<p>Následující ukázka demonstruje, že i s funkcí definovanou pomocí integrálu je možné jistým způsobem pracovat, aniž bychom měli k dispozici analytické vyjádření této funkce.</p>
<div class="shorten" data-text="Ukázka demonstruje, že funkce se dají v matematice definovat pomocí integrálu. Vlasntosti funkcí se dají odvodit z vlastností odvozených pomocí metod práce s integrály.">
<h2 id="ukázka-funkce-definované-pomocí-integrálu">Ukázka funkce definované pomocí integrálu</h2>
<div class="obtekat">
<figure>
<img src="slide-rule.jpg" alt="Součin se na součet mění například u logaritmického pravítka. Zdroj: pixabay.com" /><figcaption>Součin se na součet mění například u logaritmického pravítka. Zdroj: pixabay.com</figcaption>
</figure>
</div>
<p>Uvažujme funkci definovanou vztahem <span class="math display">\[f(x)=\int_1^x\frac 1t\,\mathrm dt.\tag{*}\]</span> Ukážeme si, že tento tvar umožňuje odvodit některé vlastnosti funkce <span class="math inline">\(f\)</span>. Dokážeme například, že funkce <span class="math inline">\(f\)</span> mění násobení na sčítání, tj. že platí <span class="math display">\[f(ab)=f(a)+f(b).\]</span> Podle definice je <span class="math display">\[f(ab)=\int_1^{ab}\frac 1t \,\mathrm dt.\]</span> Podle aditivity vzhledem k integračnímu oboru platí <span class="math display">\[f(ab)=\int_1^{a}\frac 1t \,\mathrm dt+\int_a^{ab}\frac 1t \,\mathrm dt =f(a)+\int_a^{ab}\frac 1t \,\mathrm dt.\tag{**}\]</span> Ve druhém integrálu bychom potřebovali dostat jedničku v dolní mezi, abychom dostali integrál stejný jako v definici funkce <span class="math inline">\(f\)</span>. Proto zavedeme substituci <span class="math inline">\(\frac ta=s\)</span>, <span class="math inline">\(t=sa\)</span>, <span class="math inline">\(\mathrm dt=a\mathrm ds\)</span>. S použitím této substituce se (**) transformuje na <span class="math display">\[f(ab)
=f(a)+\int_1^{b}\frac 1{sa} a\,\mathrm ds
=f(a)+\int_1^{b}\frac 1{s} \,\mathrm ds
=f(a)+f(b).\]</span></p>
<p>Pokud si všimneme, že integrál (*) v definici funkce <span class="math inline">\(f\)</span> je možné vypočítat a že funkce <span class="math inline">\(f\)</span> je vlastně funkce <span class="math inline">\(\ln x\)</span>, není vlastnost, že funkce mění násobení na sčítání nijak překvapivá. Pro nás však bylo důležité, že v důkaze jsme použili jenom definici funkce <span class="math inline">\(f\)</span> pomocí integrálu a pravidla pro práci s integrály. Nemuseli jsme nijak používat ani vlastnosti logaritmu, ani vlastnosti funkce k logaritmu inverzní, což bývá základem středoškolského odvození tohoto vzorce. Vidíme, že integrál je možné použít k definici funkce a s touto funkcí je možné dále pracovat. Substituce <span class="math inline">\(t^{\frac 1r}=s\)</span>, <span class="math inline">\(t=s^r\)</span>, <span class="math inline">\(\mathrm dt=rs^{r-1}\,\mathrm ds\)</span> například ukáže, že platí <span class="math display">\[f(a^r)=\int_1^{a^r}\frac 1t\,\mathrm dt= \int _1^a \frac
1{s^r}rs^{r-1}\,\mathrm ds= r\int _1^a\frac 1s\,\mathrm ds=rf(a).\]</span></p>
</div>
<!--

# Model eliminace chřipky

V příkladě u střední hodnoty jsme se zabývali problémem eliminace chřipky a zjistili, že potřebujeme najít minimum funkce
$$\overline I(t_0)=\frac 1{12\times 5}\int_{t_0}^{t_0+12\times 5} I(t)\,\mathrm dt.$$
Protože jsme se zabývali připadem, kdy je proměnná jenom v horní mezi a naše funkce má proměnnou v horní i v dolní mezi, můžeme využít aditivitu
integrálu vzhledem k mezi a psát
$$
\begin{aligned}
\overline I(t_0)&=
\frac 1{12\times 5}\int_{t_0}^{0} I(t)\,\mathrm dt +
\frac 1{12\times 5}\int_{0}^{t_0+12\times 5} I(t)\,\mathrm dt
\\&=
-\frac 1{60}\int_{0}^{t_0} I(t)\,\mathrm dt +
\frac 1{60}\int_{0}^{t_0+60} I(t)\,\mathrm dt
.
\end{aligned}
$$
Derivací podle $t_0$ nyní dostáváme podle věty o integrálu jako funkci horní meze a podle pravidla o derivování součtu a složené funkce
$$\begin{aligned}\frac{\mathrm d\overline I}{\mathrm dt_0}
&=-\frac 1{60} I(t_0)+
\frac 1{60} I(t_0+60) \frac{\mathrm d}{\mathrm dt_0}(t_0+60)
\\&=-\frac 1{60}I(t_0)+\frac 1{60}I(t_0+60)
\\&=\frac 1{60} \Bigl(I(t_0+60)-I(t_0)\Bigr)
\end{aligned}
$$
Minimum tedy najdeme z podmínky $I(t_0)=I(t_0+60).$ Po dosazení vztahu pro funkci $I$ a potřebných výpočtech, které jsou záležitostí středoškolské matematiky a proto k nim teď nebudeme odbočovat, abychom neztratili linii výpočtu, dostaneme 
$t_0=90+120k$, kde $k$ je libovolné celé číslo.

-->
<!-- tedy řešíme rovnici
\dm $$ \cos\left(\frac \pi 6 t\right)+\cos\left(\frac \pi {120} t\right)+2 = \cos\left(\frac \pi 6 (t+60)\right)+\cos\left(\frac \pi {120} (t+60)\right)+2 $$
tj. (následující výpočty jsou sice dlouhé, ale jedná se běžnou středoškolskou matematiku a práci s goniometrickými funkcemi)
$$
\cos\left(\frac \pi 6 t\right)+\cos\left(\frac \pi {120} t\right)
=
\cos\left(\frac \pi 6 t+ 10\pi\right)+\cos\left(\frac \pi {120} t+\frac 12\pi\right)
$$
$$
\cos\left(\frac \pi 6 t\right)+\cos\left(\frac \pi {120} t\right)
=
\cos\left(\frac \pi 6 t\right)+\cos\left(\frac \pi {120} t+\frac 12\pi\right)
$$
$$
\cos\left(\frac \pi {120} t\right)
=
\cos\left(\frac \pi {120} t+\frac 12\pi\right)
$$
$$
\cos\left(\frac \pi {120} t\right)
=
-\sin\left(\frac \pi {120} t\right)
$$
$$
\tan\left(\frac \pi {120} t\right)
=
-1
$$
Tato rovnice má řešení $\frac \pi {120} t=\frac 34\pi +k\pi$ tj.
$t=90+120k$.
-->
<!--

Vzhledem k povaze problému se střídají maxima a minima
funkce $\overline I(t_0)$. Toto je ještě nutné rozvážit, abychom s
očkováním nezačali v době, kdy by byly náklady naopak
maximální. Vzhledem ke snadné praktické interpretaci je však zřejmé,
že minimum pětiletého průměru bude v době, jejíž začátek o něco
předchází dlouhodobé minimum výskytu chřipky. Odsud snadno rozlišíme,
kdy se jedná o minimum pětiletého průměru a kdy o maximum.

-->
<div class="shorten" data-text="Ukázka se vrací k jednomu z předchozích příkladů, k vytahování řetězu. Úlohu je možno vyřešit pomocí potenciální energie. Ale protože každá část řetězu je v jiné výšce, není možné použít klasický vzorec pro potenciální energii. Přípěvky k celkové potenciální energii můžeme nasčítat integrálem.">
<h1 id="příklad-řetěz-jinak-pomocí-změny-potenciální-energie">Příklad: řetěz jinak (pomocí změny potenciální energie)</h1>
<p>Vypočítáme příklad z prací při vytahování řetězu tak, že určíme změnu potenciální energie řetězu. Práci <span class="math inline">\(W\)</span> vykonanou při vyzvednutí tělesa o hmotnosti <span class="math inline">\(m\)</span> o výšku <span class="math inline">\(h\)</span> vypočteme jako změnu potenciální energie v tíhovém poli Země, tj. <span class="math display">\[W=mgh.\]</span> Komplikace v tomto případě je, že každou část řetězu vytahujeme z jiné hloubky. Část řetězu délky <span class="math inline">\(\Delta h\)</span> váží <span class="math inline">\(m=\tau\Delta h\)</span> kilogramů a při vytažení z hloubky <span class="math inline">\(h\)</span> na úroveň střechy je změna potenciální energie (a vykonaná práce) <span class="math display">\[\Delta
W=mgh=\tau\Delta h g h.\]</span> Součet těchto příspěvků pro dolní třetinu řetězu, od <span class="math inline">\(h_2=20\,\mathrm m\)</span> po <span class="math inline">\(h_1=30\,\mathrm m\)</span> je <span class="math display">\[W=\int_{h_2}^{h_1}\tau
g h\,\mathrm dh=\tau g\int_{h_2}^{h_1} h\,\mathrm dh.\]</span> Tím výpočet přechází ve stejný integrál jako v předchozím přístupu a výsledky jsou tedy stejné. Práci pro celý řetěz získáme opět volbou <span class="math inline">\(h_2=0.\)</span></p>
<p>Že práce vykonaná při vytažení celého řetězu je stejná jako změna potenciální energie celého řetězu je zřejmé. Za zmínku ještě stojí úvaha, proč je povytažení řetězu o 10 metrů ekvivalentní změně potenciální energie dolních 10 metrů při vytažení této části řetězu na střechu. Stačí uvážit, že bychom řetěz přetočili vzhůru nohama, povytáhli o 10 metrů, rozpojili a visící část znovu otočili vzhůru nohama. Otočení vzhůru nohama není spojeno s konáním práce, stejně tak rozpojení a případné opětovné napojení. Práce se tedy koná jenom tak, že řetěz vytahujeme o 10 metrů. Výsledek však je stejný, jako kdybychom řetěz nepřetáčeli, jenom odpojili dolních 10 metrů a tuto část zvedli nahoru.</p>
<div class="obtekat">
<figure>
<img src="zdymadlo.jpg" alt="Lodní výtah Falkrik Wheel. Zdroj: Wikipedie." /><figcaption>Lodní výtah Falkrik Wheel. Zdroj: Wikipedie.</figcaption>
</figure>
</div>
<p>Ještě možná stojí za rozvážení fakt, že při otočení řetězu okolo středu se nekoná práce. Tato skutečnost se dá opět dokázat myšlenkovým rozdělením řetězu na kousky a sečtením práce nutné pro přemístění těchto kousků. Ta bude kladná pro kousky pod těžištěm, záporná pro kousky nad těžištěm a výsledný součet bude nulový. Na podobném principu pracuje lodní výtah Falkrik Wheel. Práce potřebná pro otočení výtahu a vytažení lodě nahoru (nebo spuštění dolů nebo obojí současně) je překvapivě malá – jedna loď potenciální energii získává, druhá loď stejně velkou potenciální energii ztrácí (pokud není loď, použije se místo lodi voda) a stačí jenom vykompenzovat třecí síly v mechanismu. V minulosti zde byla soustava 11 zdymadel a lodě touto soustavou proplouvaly celý den.</p>
</div>
<h1 id="shrnutí-hlavní-myšlenky">Shrnutí, hlavní myšlenky</h1>

<div class="obtekat">
<figure>
<img src="../message.jpg" alt="A jaká je hlavní message? Zdroj: pixabay.com" /><figcaption>A jaká je hlavní message? Zdroj: pixabay.com</figcaption>
</figure>
</div>

<ul>
<li>Naučili jsme se některé triky pro integrály: určitý integrál se dá numericky aproximovat a neurčitý integrál se dá převést metodou per-partés nebo substitucí na jiný integrál, v optimálním případě na integrál vhodný pro aplikaci vzorců.</li>
<li>Integrál, resp. střední hodnota funkce, slouží jako náhrada aritmetického průměru v situacích, kdy počítáme průměr z nekonečně mnoha veličin a vzorec pro klasický aritmetický průměr selhává.</li>
<li>Integrál je také nástrojem, který nás dokáže vymanit ze světa elementárních funkcí a můžeme pomocí tohoto integrálu definovat funkce, které nejsou elementární. Základním prostředkem je integrál jako funkce horní meze. Toto se využívá například ve statistice. Vedlejším produktem je věta zaručující existenci primitivní funkce pro libovolnou spojitou funkci.</li>
</ul>

</div>  <!-- container -->



  <div class='menu-obalka'>
    <a class='menu menu4' href='../../'>Matematika</a><a class='menu menu4 ACTIVE' href='../'>Přednáška</a><a class='menu menu4' href='../cviceni'>Cvičení</a><a class='menu menu4' href='https://um.mendelu.cz/'>WeBWorK</a>
  </div>
	
 <div class='menu-obalka'><a class='menu' href='../intro'>0</a><a class='menu  ' href='../derivace_I'>1</a><a class='menu  ' href='../derivace_II'>2</a><a class='menu  ' href='../derivace_III'>3</a><a class='menu  ' href='../integraly'>4</a><a class='menu ACTIVE ' href='../integraly2'>5</a><a class='menu  ' href='../ode'>6</a><a class='menu  ' href='../matice'>7</a><a class='menu  ' href='../inverzni_matice'>8</a><a class='menu  ' href='../soustavy'>9</a><a class='menu  ' href='../vektorove_pole'>10</a><a class='menu  ' href='../dvojny_integral'>11</a><a class='menu  ' href='../numerika'>12</a><a class='menu  ' href='../shrnuti'>13</a> </div> 


<div class="footer">
      Copyright by Robert Mařík, content is available under <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener">CC BY-SA 3.0</a>, built with <a href="https://www.pandoc.org" target="_blank" rel="noopener">Pandoc</a>
   </div>



<style>
  .shorten {
      border-left: solid;
      border-left-color:gray;
      padding-left:1em;
      max-height:300px;
      overflow:hidden;
      margin-bottom:20px;
      margin-top:20px;
          -webkit-mask-image: linear-gradient(180deg, #000 20%, transparent);
  }
  .rozbalovatko {
      color:gray;
      margin-bottom:30px;
      display:block;
      background-color: gainsboro;
  }
  .rozbalovatko p {padding:10px; margin-top:0px;}
  .rozbalovatkoPopisek {
      color:orangered;
      background-color:#444;
      font-weight: bold;
      display:block;
      padding:5px;
      margin-left: -20px;
      padding-left: 20px;
  }
  .rozbalovatko p {
      color:crimson;
  }
</style>

<script>


jQuery( document ).ready(function() {
    jQuery(".shorten").each(function(){
	popisek = jQuery(this).data("text");
	if (!popisek) {popisek="";}
	jQuery(this).prepend("<span class=\"rozbalovatko\"><span class=\"rozbalovatkoPopisek\">Volitelný text. Klikněte pro rozbalení.</span><p>"+popisek+"</p></span>").css("background-color","gainsboro");
    });

    jQuery(".rozbalovatko").each(function(){
    	jQuery(this).parent().click(function() {
            jQuery( this ).css("max-height","100%").css("-webkit-mask-image","none").css("background-color","inherit");
	    jQuery( this ).children(".rozbalovatko").slideUp();
	    jQuery( this ).unbind("click");
	})
    });
});

</script>

  
</body>
</html>
