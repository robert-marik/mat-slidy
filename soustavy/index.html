<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Robert Mařík" />
  <title>Soustavy lineárních rovnic</title>
  <style type="text/css">code{white-space: pre;} body {  font-family: "Open Sans", Sans-Serif;}</style>
<link href="../lity/dist/lity.css" rel="stylesheet">
  <link rel="stylesheet" href="../my.css?123" type="text/css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../lity/dist/lity.js"></script>

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
  

 <script type="text/javascript">

function otevrit(co)
   {
       seed=Math.round(Math.random()*1000);
       window.open('http://um.mendelu.cz/webwork2/html2xml?&answersSubmitted=0&sourceFilePath='+co+'&problemSeed='+seed+'&displayMode=MathJax&courseID=daemon&userID=demon&course_password=demonek&outputformat=simpleM&language=cs_CZ', '_blank');
   };

function    myFunctionYTB()
    {
        //jQuery(".reseni").slideToggle();
	jQuery(".Ycontainer").slideToggle();
    }
        

  </script>

</head>
<body>

  <div class='menu-obalka'>
    <a class='menu menu4' href='../../'>Matematika</a><a class='menu menu4 ACTIVE' href='../'>Přednáška</a><a class='menu menu4' href='../cviceni'>Cvičení</a><a class='menu menu4' href='https://um.mendelu.cz/'>WeBWorK</a>
  </div>
	
 <div class='menu-obalka'><a class='menu' href='../intro'>0</a><a class='menu  ' href='../derivace_I'>1</a><a class='menu  ' href='../derivace_II'>2</a><a class='menu  ' href='../derivace_III'>3</a><a class='menu  ' href='../integraly'>4</a><a class='menu  ' href='../integraly2'>5</a><a class='menu  ' href='../ode'>6</a><a class='menu  ' href='../matice'>7</a><a class='menu  ' href='../inverzni_matice'>8</a><a class='menu ACTIVE ' href='../soustavy'>9</a><a class='menu  ' href='../vektorove_pole'>10</a><a class='menu  ' href='../dvojny_integral'>11</a><a class='menu  ' href='../numerika'>12</a><a class='menu  ' href='../shrnuti'>13</a> </div> 

<div class="container">
<div id="header">
<h1 class="title">Soustavy lineárních rovnic</h1>
<h2 class="author">Robert Mařík</h2>
<h3 class="date">2020-2021</h3>
</div>

<!-- YTB -->


<div>
<button onclick="myFunctionYTB()">Videa on/off</button>
<button onclick="jQuery('.shorten').css('display','none');">Volitelné části off</button>
</div>


<div id="TOC">
<ul>
<li><a href="#varianty-zápisu-soustavy-lineárních-rovnic">Varianty zápisu soustavy lineárních rovnic</a></li>
<li><a href="#soustava-lineárních-rovnic">Soustava lineárních rovnic</a></li>
<li><a href="#vektorový-zápis-soustavy-lineárních-rovnic">Vektorový zápis soustavy lineárních rovnic</a></li>
<li><a href="#maticový-zápis-soustavy-lineárních-rovnic">Maticový zápis soustavy lineárních rovnic</a></li>
<li><a href="#využití-inverzní-matice-pro-řešení-soustavy-lineárních-rovnic">Využití inverzní matice pro řešení soustavy lineárních rovnic</a></li>
<li><a href="#inverzní-matice-k-diagonální-matici">Inverzní matice k diagonální matici</a></li>
<li><a href="#iterační-metoda-řešení-soustav-lineárních-rovnic">Iterační metoda řešení soustav lineárních rovnic</a></li>
<li><a href="#hodnost-matice">Hodnost matice</a></li>
<li><a href="#výpočet-hodnosti">Výpočet hodnosti</a></li>
<li><a href="#existence-a-jednoznačnost-řešení-soustavy-lineárních-rovnic">Existence a jednoznačnost řešení soustavy lineárních rovnic</a></li>
<li><a href="#gaussova-eliminace">Gaussova eliminace</a></li>
<li><a href="#gaussova-seidelova-iterační-metoda">Gaussova-Seidelova iterační metoda</a></li>
<li><a href="#shrnutí-hlavní-myšlenky">Shrnutí, hlavní myšlenky</a></li>
</ul>
</div>

<blockquote><p><strong>Motivace</strong>.</p>
<ul>
<li>Pro popis přírodních dějů je ideální jazyk derivací, protože umožňuje pracovat s okamžitými rychlostmi změn fyzikálních veličin. Pokud mechanismus děje známe, je snadné naformulovat pomocí derivací příslušný matematický model, poté ovšem přijde fáze řešení. Tady málokdy vystačíme s analytickými metodami, které jsme si ukázali v přednášce věnované diferenciálním rovnicím. Často se uchylujeme k numerickému řešení. V naprosté většině případů se toto řešení redukuje na řešení soustav lineárních rovnic. Tyto soustavy ovšem bývají obrovské, řádově obsahující tisíce rovnic a neznámých a proto středoškolské metody nejsou použitelné (například nejsou dostatečně rychlé, nebo mohou být numericky nestabilní). Z tohoto důvodu je nutné se problematice soustav rovnic věnovat podrobněji.</li>
<li>Nalezení vlastních směrů matice je zásadní pro zjednodušení popisu anizotropního materiálu, protože díky tomu, že matice má v soustavě respektující vlastní směry diagonální tvar, se redukuje počet materiálových konstant. Hledání těchto směrů je vlastně řešení soustavy lineárních rovnic. Situace je relativně jednoduchá, protože soustava má dimenzi dva nebo tři a k tomu nekonečně mnoho řešení, což výpočty urychluje. (Například ve dvourozměrném případě to znamená, že jedna rovnice je násobkem druhé a nemusíme ji uvažovat.)</li>
<li>Podrobněji viz <a href="https://user.mendelu.cz/marik/mtk/soustavy_motivace.pdf">zde</a>. Numerický výpočet vlastních čísel <a href="https://sagecell.sagemath.org/?z=eJyVVbtu4zgU7Q34H4gEgaWBVhtnMY0BFe4WWGyQYpDGMRa0zNiMJZLDh2LpH_IBi6lSThHMF2Qb2f-194qS7HiSYgxDosjLc1-Hh-fkRktS0SUV0pGcWp5yUpRKptxSUmTUWMFJyk1GyeG7YBsrdRkPB-fkRlpGFIAIupZLwbrFA4qSS56RJcvYhsiFppVrbRxCVvBugL4wYWVr_MBIzioOD2E4WjEL7849-pFW-m235UYzk_GckTU3Vq40zYmWVSYrBrYNnosJmv6N6TEEN2XOrObpBrNSsuKWFxD6kt1zwcEFIA8HPFdSWyJcrkpCDRGqn4NCqUzajC9iVeII11VmewPD6EJqgdNGGESbJkLFVGtaBrPZVTSeR7Nx9Md8HhJyjg2on0X9cgis_u67wYaDx4gUJAH3ccYFzVYx46tgCvtgY1G_Krl7YrYtTv2SrsnuqX4xLGvqhnXe_8AAIDmyYvYfk1LAWQUumoaT4QBgyNR5fPCYuyyYRi70C5pZB1kEB99C6jyYuvD3kykXhujkOhlfwm84cOusBNDZ1ScwVByfmoqlzJtXEJJ7qQknXBD4XrHgOpxDOh2HTM50ORx0VAKco-LBMJUm4CGUEMaGCxzPQ_RhvmobnPo6coZhHTvqPJh2Bg4BEHUj3XDgmQiuT4vWoDlEa3cj4Dskb8mNZVGaCxuctQS8ExfmTpxdTMN-5fb4pE3IhTm7eGyY0bXVNxVOYc8Q1hPkLboBguP52EggR84P5xGWMulUihyZ3InGSdE4yX9hZ-_uLymslhARFwXTlZDG8g72wKUiKuIvoSerhXYYJYUsqKifO694HKXbPVEjdt86MEi4WYZ3AOJi4TCTB2AFKELGDzXoNetQyd8--p1hEKS3u2YPXl2W0lCQitK3cNLFT3PgVTPVRi_e33AM6GXqQ0C6PQV8bwMWRGm6gbQ2JShZwYTXv9x1CggjJEpDLTy6xWwSXc7JG7745hG1_xd54_YgL6-op_tnXOysvJTuvmEWcglNbkQz-UkoiKd4_QIcr7-_R_K2CjdNCngfvL0sgFy-eqci7utz5D3EJg0H93wVEbo1EAwIa2zcAnXWBOPoKiKwaHjFkmB8FX32ykO3YAn2s8s5fsR4GfhyR2TBBeJ8vgybJQPJWW4zFoz-7K8Mf1E0p788SW7UOGhCmXHAh_9BUToNGA7K1mD8kUEf4hg-4FqIocLWMo2JBdtkayJSJiU8144lbeiKZgxskpFh3OQ8Hf2Uwi2vHDSqonCWlHT7_7itX-EWgCOGNW7G3T1wtJsaxVIbjNhX2N3OZ2zFQDAb4GR0c9xvX4OmE2v5GIT_A0gl31s=&amp;lang=python&amp;interacts=eJyLjgUAARUAuQ==">zde</a></li>
</ul>
</blockquote>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/yAozKR9QBls"></iframe> </div>
<h1 id="varianty-zápisu-soustavy-lineárních-rovnic">Varianty zápisu soustavy lineárních rovnic</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/E1Ey_xz6_ig"></iframe> </div>
<p>Uvažujme následující tři problémy:</p>
<ol type="1">
<li>Najděte všechna reálná čísla <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, splňující dvojici rovnic <span class="math display">\[ \begin{aligned}   4x_1&amp;+5x_2=7\\   \phantom{4}x_1&amp;-2x_2=4 \end{aligned} \]</span></li>
<li>Najděte všechna reálná čísla <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, splňující vektorovou rovnici <span class="math display">\[   \begin{aligned} \begin{pmatrix}       4\\1     \end{pmatrix}     x_1     +     \begin{pmatrix}       5\\-2     \end{pmatrix}     x_2     =     \begin{pmatrix}       7\\4     \end{pmatrix}   \end{aligned}\]</span></li>
<li>Najděte všechna reálná čísla <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, splňující maticovou rovnici <span class="math display">\[\begin{aligned}     \begin{pmatrix}       4&amp;5\\1&amp;-2     \end{pmatrix}     \begin{pmatrix}       x_1\\x_2     \end{pmatrix}     =     \begin{pmatrix}       7\\4     \end{pmatrix}   \end{aligned} \]</span></li>
</ol>
<p>Všechny problémy jsou ekvivalentní a jedná se o jiný zápis téhož. Jednou však používáme soustavu rovnic, vektory a jejich lineární kombinaci a jednou matice a maticový součin!</p>
<h1 id="soustava-lineárních-rovnic">Soustava lineárních rovnic</h1>
<blockquote class="definice"><p class="definicename">Definice (soustava lineárních rovnic).</p><p> <em>Soustavou <span class="math inline">\(m\)</span> lineárních rovnic o <span class="math inline">\(n\)</span> neznámých</em> nazýváme soustavu rovnic <span class="math display">\[ \tag{1}
\begin{gathered}
a_{11}x_1+a_{12}x_2+a_{13}x_3+\cdots+a_{1n}x_n=b_1 \\
a_{21}x_1+a_{22}x_2+a_{23}x_3+\cdots+a_{2n}x_n=b_2 \\
a_{31}x_1+a_{32}x_2+a_{33}x_3+\cdots+a_{3n}x_n=b_3 \\
\vdots \\
a_{m1}x_1+a_{m2}x_2+a_{m3}x_3+\cdots+a_{mn}x_n=b_m 
\end{gathered} \]</span> Proměnné <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, , <span class="math inline">\(x_n\)</span> nazýváme <em>neznámé</em>. Reálná čísla <span class="math inline">\(a_{ij}\)</span> nazýváme <em>koeficienty levých stran</em>, reálná čísla <span class="math inline">\(b_j\)</span> <em>koeficienty pravých stran</em> soustavy rovnic. <em>Řešením soustavy rovnic</em> rozumíme uspořádanou <span class="math inline">\(n\)</span>-tici reálných čísel <span class="math inline">\([t_1, t_2, \ldots, t_n]\)</span> po jejichž dosazení za neznámé (v tomto pořadí) do soustavy dostaneme ve všech rovnicích identity.</p>
</blockquote>
<blockquote class="definice"><p class="definicename">Definice (matice soustavy).</p><p> Matici <span class="math display">\[
A=\left(
\begin{matrix}
a_{11}&amp; a_{12}&amp; a_{13}&amp; \cdots{}&amp; a_{1n}\\
a_{21}&amp; a_{22}&amp; a_{23}&amp; \cdots{}&amp; a_{2n}\\
\vdots{} &amp;\vdots{}&amp; {} &amp;\ddots{}&amp; \vdots{}\\
a_{m1}&amp; a_{m2}&amp; a_{m3}&amp; \cdots{}&amp; a_{mn}\\      
\end{matrix}\right)
\]</span> nazýváme <em>maticí soustavy</em> (1). Matici <span class="math display">\[
A_r=\left(
\begin{array}{ccccc|c}
a_{11}&amp; a_{12}&amp; a_{13}&amp; \cdots{}&amp; a_{1n}&amp;b_1\\
a_{21}&amp; a_{22}&amp; a_{23}&amp; \cdots{}&amp; a_{2n}&amp;b_2\\
\vdots{} &amp;\vdots{}&amp; {} &amp;\ddots{}&amp; \vdots{}&amp;\vdots\\
a_{m1}&amp; a_{m2}&amp; a_{m3}&amp; \cdots{}&amp; a_{mn}&amp;b_m\\
\end{array}
\right)
\]</span> nazýváme <em>rozšířenou maticí soustavy</em> (1).</p>
</blockquote>
<h1 id="vektorový-zápis-soustavy-lineárních-rovnic">Vektorový zápis soustavy lineárních rovnic</h1>
<p>Soustavu (1) lze ekvivalentně přepsat do vektorového tvaru <span class="math display">\[    \begin{pmatrix}
      a_{11}\\a_{21}\\\vdots\\a_{m1}
    \end{pmatrix}
    x_1+
    \begin{pmatrix}
      a_{12}\\a_{22}\\\vdots\\a_{m2}
    \end{pmatrix}
    x_2+
    \begin{pmatrix}
      a_{13}\\a_{23}\\\vdots\\a_{m3}
    \end{pmatrix}
    x_3+\cdots+
    \begin{pmatrix}
      a_{1n}\\a_{2n}\\\vdots\\a_{mn}
    \end{pmatrix}
    x_n=
    \begin{pmatrix}
      b_{1}\\b_{2}\\\vdots\\b_{m}
    \end{pmatrix}.
 \]</span> Vidíme tedy, že se vlastně jedná o problém, vyjádřit vektor složený z čísel na pravé straně soustavy rovnic jako lineární kombinaci vektorů, které tvoří sloupce matice soustavy.</p>
<h1 id="maticový-zápis-soustavy-lineárních-rovnic">Maticový zápis soustavy lineárních rovnic</h1>
<p>Soustavu (1) lze ekvivalentně přepsat do maticového tvaru pomocí maticového součinu <span class="math display">\[
\left(
    \begin{matrix}
      a_{11}&amp; a_{12}&amp; \cdots{}&amp; a_{1n}\\
      a_{21}&amp; a_{22}&amp;  \cdots{}&amp; a_{2n}\\
      \vdots{} &amp;\vdots{} &amp;\ddots{}&amp; \vdots{}\\
      a_{m1}&amp; a_{m2}&amp;  \cdots{}&amp; a_{mn}\\
    \end{matrix}\right) 
\left(  \begin{matrix}
    x_1\\x_2\\ \vdots \\x_n
  \end{matrix}
\right)    = \left(  \begin{matrix}
    b_1\\b_2\\ \vdots \\b_m
  \end{matrix}
\right).
\]</span> Tento tvar se používá často v inženýrských výpočtech pro úspornost. Symbolicky zpravidla píšeme soustavu lineárních rovnic ve tvaru <span class="math display">\[
    A\vec x=\vec b,
    \]</span> nebo <span class="math display">\[AX=B\]</span> kde <span class="math inline">\(A\)</span> je matice soustavy a <span class="math inline">\(\vec b\)</span> resp. <span class="math inline">\(B\)</span> je vektor pravých stran.</p>
<h1 id="využití-inverzní-matice-pro-řešení-soustavy-lineárních-rovnic">Využití inverzní matice pro řešení soustavy lineárních rovnic</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/YpbOWJ_6ZS4"></iframe> </div>

<div class="obtekat">
<figure>
<img src="matrix.jpg" alt="Inverzní matice umožní zapsat elegantně řešení i neuvěřitelně komplexní a složité soustavy rovnic. Pro praktické počítání se však tato metoda moc nehodí a budeme ji muset ještě o něco vylepšit na iterační metodu. Zdroj: pixabay.com." /><figcaption>Inverzní matice umožní zapsat elegantně řešení i neuvěřitelně komplexní a složité soustavy rovnic. Pro praktické počítání se však tato metoda moc nehodí a budeme ji muset ještě o něco vylepšit na iterační metodu. Zdroj: pixabay.com.</figcaption>
</figure>
</div>

<p>Z úvodní přednášky o lineární algebře víme, že pomocí maticového násobení je možné soustavu lineárních rovnic zapsat ve tvaru <span class="math display">\[AX=B,\]</span> kde <span class="math inline">\(A\)</span> je matice soustavy, <span class="math inline">\(X\)</span> je sloupcový vektor neznámých a <span class="math inline">\(B\)</span> je vektor pravých stran. Pokud má matice <span class="math inline">\(A\)</span> inverzní matici, můžeme pomocí této matice soustavu vyřešit. Po vynásobení rovnice inverzní maticí zleva dostáváme <span class="math display">\[A^{-1}(AX)=A^{-1}B\]</span> a po uplatnění asociativního zákona <span class="math display">\[(A^{-1}A)X=A^{-1}B.\]</span> Protože výraz v závorce je součinem matice s maticí inverzní, je tento součin roven jednotkové matici, která je neutrálním prvkem při násobení a proto okamžitě dostáváme řešení soustavy ve tvaru <span class="math display">\[X=A^{-1}B.\]</span> Jako přirozený důsledek vidíme, že řešení je určeno jednoznačně. Známe-li inverzní matici, můžeme řešení dokonce vypočítat pro libovolnou pravou stranu velmi pohodlně a rychle pomocí maticového násobení. Bohužel, výpočet inverzní matice je zpravidla velmi drahý (vyžaduje velké množství operací) a numericky málo stabilní. Proto je tento postup užitečným teoretickým nástrojem, ale v praxi postupujeme poněkud odlišně.</p>
<h1 id="inverzní-matice-k-diagonální-matici">Inverzní matice k diagonální matici</h1>
<p>Diagonální matice (tj. matice, které mají nenulové prvky jenom na hlavní diagonále) se vzhledem k násobení chovají velice hezky: součinem je taková matice, která je diagonální a na hlavní diagonále má prvky vytvořené jako součin odpovídajících prvků násobených matic.</p>
<p><span class="math display">\[
\begin{pmatrix}
  2&amp;0&amp;0 \\
  0&amp;3&amp;0 \\
  0&amp;0&amp;12  
\end{pmatrix}
\begin{pmatrix}
  5&amp;0&amp;0 \\
  0&amp;7&amp;0 \\
  0&amp;0&amp;1  
\end{pmatrix}
=
\begin{pmatrix}
  10&amp;0&amp;0 \\
  0&amp;21&amp;0 \\
  0&amp;0&amp;12  
\end{pmatrix}
\]</span></p>
<p>Proto je snadné zařídit, aby v hlavní diagonále vyšly jedničky. Stačí uvažovat podobně jako v následujícím příkladě. <span class="math display">\[
\begin{pmatrix}
  2&amp;0&amp;0 \\
  0&amp;3&amp;0 \\
  0&amp;0&amp;12  
\end{pmatrix}
\begin{pmatrix}
  \frac 12&amp;0&amp;0 \\
  0&amp;\frac 13&amp;0 \\
  0&amp;0&amp;\frac1{12}  
\end{pmatrix}
=
\begin{pmatrix}
  1&amp;0&amp;0 \\
  0&amp;1&amp;0 \\
  0&amp;0&amp;1  
\end{pmatrix}
\]</span> a tedy <span class="math display">\[
\begin{pmatrix}
  2&amp;0&amp;0 \\
  0&amp;3&amp;0 \\
  0&amp;0&amp;12  
\end{pmatrix}^{-1}
=
\begin{pmatrix}
  \frac 12&amp;0&amp;0 \\
  0&amp;\frac 13&amp;0 \\
  0&amp;0&amp;\frac1{12}  
\end{pmatrix}.
\]</span></p>
<h1 id="iterační-metoda-řešení-soustav-lineárních-rovnic">Iterační metoda řešení soustav lineárních rovnic</h1>
<p>Na předchozím slidu jsme viděli, že je jednoduché najít inverzní matici k matici diagonální. Toho využijeme pro řešení soustavy lineárních rovnic iterační metodou. Představíme si nejednodušší, přesto však velmi mocnou metodu, <strong>Jacobiho metodu</strong>.</p>
<p>V úvodní přednášce z lineární algebry jsme modelovali rozložení teploty ve dvourozměrné desce pomocí soustavy rovnic <span class="math display">\[
\begin{pmatrix}
 \phantom{-}4&amp;-1&amp; \phantom{-}0&amp;-1\\
 -1&amp; \phantom{-}4&amp;-1&amp; \phantom{-}0\\
 \phantom{-}0 &amp;-1&amp; \phantom{-}4&amp;-1\\
 -1&amp; \phantom{-}0&amp;-1&amp; \phantom{-}4
\end{pmatrix}
\begin{pmatrix}
  x_1\\x_2\\x_3\\x_4
\end{pmatrix}
=
\begin{pmatrix}
  30\\60\\70\\40
\end{pmatrix}.
\]</span> Pro <span class="math display">\[A=\begin{pmatrix}
 \phantom{-}4&amp;-1&amp; \phantom{-}0&amp;-1\\
 -1&amp; \phantom{-}4&amp;-1&amp; \phantom{-}0\\
 \phantom{-}0 &amp;-1&amp; \phantom{-}4&amp;-1\\
 -1&amp; \phantom{-}0&amp;-1&amp; \phantom{-}4
\end{pmatrix}, \quad
X=\begin{pmatrix}
  x_1\\x_2\\x_3\\x_4
\end{pmatrix}
,\quad
B=\begin{pmatrix}
  30\\60\\70\\40
\end{pmatrix}
\]</span> tedy <span class="math display">\[AX=B.\tag{1}\]</span></p>
<p>Rozdělíme matici <span class="math inline">\(A\)</span> na součet diagonální matice a matice s nulami v hlavní diagonále, tj. na součet matic <span class="math display">\[D=
\begin{pmatrix}
 4&amp;0&amp;0&amp;0\\
 0&amp; 4&amp;0&amp;0\\
0 &amp;0&amp; 4&amp;0\\
 0&amp;0&amp;0&amp; 4
\end{pmatrix}
\quad \text{a}\quad
T=
\begin{pmatrix}
 \phantom{-}0&amp;-1&amp; \phantom{-}0&amp;-1\\
 -1&amp; \phantom{-}0&amp;-1&amp; \phantom{-}0\\
 \phantom{-}0 &amp;-1&amp; \phantom{-}0&amp;-1\\
 -1&amp; \phantom{-}0&amp;-1&amp; \phantom{-}0
\end{pmatrix}
\]</span> Potom můžeme psát rovnici ve tvaru <span class="math display">\[(D+T)X=B\]</span> a odsud <span class="math display">\[\begin{aligned}DX+TX&amp;=B\\
DX&amp;=B-TX
\end{aligned}\]</span> a využitím inverzní matice <span class="math display">\[X=D^{-1}(B-TX).\tag{2}\]</span> Definujme nyní iterační vzorec <span class="math display">\[X_{k+1}=D^{-1}(B-TX_k).\tag{3}\]</span> Podobně jako u Markovových řetězců můžeme najít postupnými iteracemi z vhodného (nebo libovolného) počátečního stavu stacionární stav, kdy se <span class="math inline">\(X_k\)</span> dalšími iteracemi nemění a tím dostaneme řešení rovnice (2), která je ekvivalentní rovnici (1). Protože inverzní matici počítáme pro matici diagonální, je tento výpočet velice rychlý a levný. Vlastně není vůbec nutné mít k dispozici maticový počet. Iterace dostaneme tak, že z první rovnice osamostatníme <span class="math inline">\(x_1\)</span>, z druhé rovnice <span class="math inline">\(x_2\)</span> atd. Výchozí odhad dosadíme do pravých stran a obdržíme zpřesněný odhad. Postup opakujeme, dokud nejsou dvě následující iterae dostatečně blízké.</p>
<p><strong>Poznámka.</strong> Předchozí postup je možné použít jenom v případě, že iterační proces (3) konverguje. Pokud by nekonvergoval, není možné o řešení rovnice nic říct, pouze to, že Jacobiho metoda nefunguje. Postačující podmínka, kdy Jacobiho metoda konverguje, je aby každý řádek měl v hlavní diagonále číslo, které je v absolutní hodnotě větší než je součet absolutních hodnot zbylých čísel v tomto řádku. Matice, která splňuje tuto podmínku se nazývá <em>řádkově ostře diagonálně dominantní matice</em> a pro takovou matici Jacobiho metoda konverguje. Podobně je možné uvažovat <em>sloupcově ostře diagonálně dominantní matice</em> porovnáním absolutních hodnot diagonálních prvků se součty absolutních hodnot ostatních prvků v daných sloupcích a i pro sloupcově ostře diagonální matice metoda konverguje. I přes jednoduchost tohoto kriteria se s diagonálně dominantními maticemi setkáváme v aplikacích poměrně často. Podíváme-li se, jak byla odvozena soustava popisující rozložení teploty na tepelně vodivé desce (poslední slajd minulé přednášky), není to až takové překvapení.</p>
<p><a href="https://sagecell.sagemath.org/?z=eJxtj8FqwzAMhu-BvIPoLk5wMnfzOij4kJDTTjv0EMjC8GK31aFycMzY3n5O03YMZozRL_3SJ1fqpIPHL9Z1khdrLuLT8y5Gi4zxnDqrJb_Ivs_SpL41Pwq-EfxZcCn6rAxe0zS6ybJoSpNGyRyNpYDh-_3SIWOlQfpU6_v_iztVFU2atDfEk-DX-xcBdzC6QQc7EIIzR23A28kSzuy984CABNF_sOxBZNs0gXhaRWxeIGd1scvbLCJHjxSArV704D7w6OBkgzN6C2-04m1JzOABw6Rkdv7W1f4aaWQvzMVMrCrjbOvn_fKaw2_nD3USakw=&amp;lang=sage&amp;interacts=eJyLjgUAARUAuQ==">Online výpočet.</a></p>
<p>Podobnými iteračními metodami je možné efektivně řešit soustavy o tisících rovnic a neznámých. Výpočty probíhají rychle a nejsou náročné na paměť jako u přímých metod, známých například ze střední školy. Tímto způsobem se řeší soustavy rovnic při modelování namáhání konstrukcí, vedení tepla, proudění vody apod.</p>
<h1 id="hodnost-matice">Hodnost matice</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/HF-RDBZUenY"></iframe> </div>
<p>Iterační metoda funguje pro soustavy s jediným řešením. Pokud však hledáme vlastní vektory, musíme být schopni umět řešit i soustavy s nekonečně mnoha řešeními.</p>
<p>Matice řádu <span class="math inline">\(m\times n\)</span> obsahuje celkem <span class="math inline">\(m\cdot n\)</span> čísel. Jedná se tedy o relativně komplikovaný objekt. V matematice se často snažíme složitější objekty nějakým způsobem charakterizovat pomocí objektů jednodušších, např. pomocí čísel. Jedno už známe, determinant. Dalším z těchto čísel je hodnost matice, kterou si nadefinujeme nyní.</p>
<blockquote class="definice"><p class="definicename">Definice (hodnost matice).</p><p> Buď <span class="math inline">\(A\)</span> matice. <em>Hodností matice</em> rozumíme maximální počet lineárně nezávislých řádků matice. Hodnost matice <span class="math inline">\(A\)</span> označujeme <span class="math inline">\({h(A)}\)</span>.</p>
</blockquote>
<p>Poznámka: Hodnost je v anglické literatuře označována jako <em>rank</em>.</p>
<p>Schodovitý tvar jsme si představili u determinantu. U matice ve schodovitém tvaru je určení determinantu velmi jednoduché. Podobný efekt vidíme i u hodnosti.</p>
<blockquote class="definice"><p class="definicename">Definice (schodovitý tvar).</p><p> Řekneme, že matice <span class="math inline">\(A\)</span> je ve <em>schodovitém tvaru</em>, jestliže případné nulové řádky jsou uspořádány na konci matice a nenulové jsou uspořádány tak, že každý následující řádek začíná větším počtem nul než řádek předchozí.</p>
</blockquote>
<blockquote class="veta"><p class="vetaname">Věta (hodnost matice ve schodovitém tvaru).</p><p> Hodnost matice, která je ve schodovitém tvaru je rovna počtu jejích nenulových řádků.</p>
</blockquote>
<p><strong>Příklad.</strong> Matice <span class="math inline">\(A= \begin{pmatrix} 2&amp;2&amp;2&amp;3&amp;-1&amp;5\\ 0&amp;0&amp;1&amp;0&amp;0&amp;3\\ 0&amp;0&amp;0&amp;-1&amp;2&amp;1\\ 0&amp;0&amp;0&amp;0&amp;0&amp;0 \end{pmatrix}\)</span> je ve schodovitém tvaru a <span class="math inline">\(h(A)=3\)</span>. Matice <span class="math inline">\(B= \begin{pmatrix} 2&amp;2&amp;2&amp;3&amp;-1&amp;5\\ 0&amp;0&amp;1&amp;0&amp;0&amp;3\\ 0&amp;0&amp;3&amp;-1&amp;2&amp;1 \end{pmatrix}\)</span> není ve schodovitém tvaru a její hodnost na první pohled nepoznáme.</p>
<h1 id="výpočet-hodnosti">Výpočet hodnosti</h1>
<p>Výpočet hodnosti se provádí postupným nahrazením zadané matice maticí, která má stejnou hodnost, ale postupně se přibližuje schodovitému tvaru. Uvedeme si jenom základní postup. Tento se sice dá vylepšit, pro nás je však důležité, že i bez jakýchkoliv vylepšení vždy vede k cíli. (Alespoň teoreticky.)</p>
<blockquote class="veta"><p class="vetaname">Věta (řádkové operace zachovávající hodnost matice).</p><p> Následující operace nemění hodnost matice:</p>
<ol type="1">
<li>vynechání řádku složeného ze samých nul, nebo vynechání řádku, který je totožný s jiným řádkem, nebo vynechání řádku, který je násobkem jiného řádku,</li>
<li>vynásobení nebo vydělení libovolného řádku nenulovým číslem,</li>
<li>záměna pořadí řádků,</li>
<li>ponechání jednoho řádku beze změny a opakované přičtení libovolných násobků tohoto řádku k nenulovým násobkům ostatních řádků matice.</li>
</ol>
<p>Libovolnou matici lze konečným počtem těchto úprav převést do schodovitého tvaru.</p>
</blockquote>
<p>Následující věta udává, že veškerá tvrzení, uvedená v souvislosti s hodností pro řádky matice, se dají přeformulovat i pro sloupce matice.</p>
<blockquote class="veta"><p class="vetaname">Věta.</p><p> Transponování nemění hodnost matice.</p>
</blockquote>
<h1 id="existence-a-jednoznačnost-řešení-soustavy-lineárních-rovnic">Existence a jednoznačnost řešení soustavy lineárních rovnic</h1>
<p>V případě, že matice soustavy je čtvercová již víme, že řešení je určeno jednoznačně právě tehdy, když má matice soustavy matici inverzní. O počtu řešení v obecném případě obdélníkové matice, kdy matici inverzní nemá smysl uvažovat, nám dávají informaci dvě následující věty. První se týká existence řešení a druhá identifikuje případ, kdy řešení je určeno jednoznačně.</p>
<blockquote class="veta"><p class="vetaname">Věta (Frobeniova věta, Kronecker-Capelliho věta).</p><p> Soustava lineárních rovnic je řešitelná právě tehdy, když její matice soustavy a rozšířená matice soustavy mají stejnou hodnost.</p>
</blockquote>
<blockquote class="veta"><p class="vetaname">Věta (jednoznačnost řešení).</p><p> Nechť soustava lineárních rovnic má řešení. Toto řešení je právě jedno, pokud je společná hodnost matice soustavy a rozšířené matice soustavy rovna počtu neznámých. V opačném případě je společná hodnost matice a rozšířené matice soustavy menší než počet neznámých.</p>
</blockquote>
<h1 id="gaussova-eliminace">Gaussova eliminace</h1>
<p>Spočívá v reprezentaci soustavy pomocí rozšířené matice soustavy a převodu této matice na schodovitý tvar pomocí řádkových operací zachovávajících hodnost. Tyto operace zachovávají i množinu řešení soustavy. Jakmile je matice ve schodovitém tvaru, zpětnou substitucí postupně dopočítáváme jednotlivé proměnné. (Formálně to u čtvercových regulárních matic odpovídá použití inverzní matice k matici, která má pod hlavní diagonálou nuly. Ale postup funguje i pro obecnější matice a dá se realizovat jednoduchými prostředky a postupným dosazováním.)</p>
<p>Gaussova eliminace je velice flexibilní a univerzální, umožní nám řešit i soustavy mající nekonečně mnoho řešení. V tomto případě dokážeme zapsat řešení pomocí parametrů.</p>
<p><strong>Příklad.</strong></p>
<p><span class="math display">\[
\begin{aligned}
  x_1+2x_2+2x_3+x_4&amp;=0\\
  x_1-x_2+x_3-2x_4&amp;=1\\
  x_2-2x_3+x_4&amp;=2
\end{aligned}
\]</span></p>
<p>Rozšířená matice soustavy je <span class="math display">\[\left(
  \begin{array}{cccc|c}
 1&amp; 2&amp; 2&amp; 1&amp; 0\\
 1&amp; -1&amp; 1&amp; -2&amp; 1\\
 0&amp; 1&amp; -2&amp; 1&amp; 2
  \end{array}\right)
  \]</span></p>
<p>V prvním kroku převedeme na tvar, kdy jednom jeden řádek začíná nenulovým prvkem. První řádek už nijak neupravujeme a opíšeme jej. Místo druhého řádku napíšeme jeho součet s <span class="math inline">\((-1)\)</span>-násobkem prvního řádku. <span class="math display">\[ \left( \begin{array}{cccc|c}
 1&amp; 2&amp; 2&amp; 1&amp; 0\\
 0&amp; -3&amp; -1&amp; -3&amp; 1\\
 0&amp; 1&amp; -2&amp; 1&amp; 2
    \end{array}\right)
    \]</span></p>
<p>V dalším kroku převedeme na tvar, kdy z řádků začínajících jednou nulou ponecháme jenom jeden a ostatní upravíme tak, aby začínaly alespoň dvěma nulami. K tomu je vhodné nejprve přehodit poslední dva řádky, abychom mohli použít k vytváření nul jedničku. <span class="math display">\[ \left( \begin{array}{cccc|c}
 1&amp; 2&amp; 2&amp; 1&amp; 0\\
 0&amp; 1&amp; -2&amp; 1&amp; 2\\
 0&amp; -3&amp; -1&amp; -3&amp; 1
    \end{array}\right)
    \]</span></p>
<p>Nyní provedeme potřebnou úpravu. První dva řádky opíšeme. Místo třetího řádku napíšeme jeho součet s trojnásobkem druhého řádku. <span class="math display">\[ \left( \begin{array}{cccc|c}
 1&amp; 2&amp; 2&amp; 1&amp; 0\\
 0&amp; 1&amp; -2&amp; 1&amp; 2\\
 0&amp; 0&amp; -7&amp; 0&amp; 7
    \end{array}\right)
    \]</span></p>
<p>Nyní přepíšme do tvaru soustavy rovnic</p>
<p><span class="math display">\[
\begin{aligned}
    x_1+2x_2+2x_3+x_4&amp;=0\\
  x_2-2x_3+x_4&amp;=2\\
-7x_3\phantom{+x_4}&amp;=7
\end{aligned}
\]</span></p>
<p>Z poslední rovnice máme snadno <span class="math inline">\(x_3=-1\)</span>. Tuto hodnotu použijeme ve druhé rovnici. <span class="math display">\[
\begin{aligned}
  x_2-2x_3+x_4&amp;=2\\
  x_2+2+x_4&amp;=2\\
  x_2+x_4&amp;=0\\
\end{aligned}
\]</span> Protože však máme pořád dvě neznámé, jednu z nich zvolíme za parametr. Nechť je například <span class="math inline">\(x_4\)</span> a nechť je parametr označen jako <span class="math inline">\(t\)</span>. <span class="math display">\[
  x_4=t
\]</span> Rovnice má poté tvar <span class="math display">\[
  x_2+t=0.
\]</span> Odsud již snadno dostáváme <span class="math display">\[
  x_2=-t.
\]</span> Vypočtené hodnoty dosadíme do první rovnice a určíme zbývající neznámou <span class="math inline">\(x_1\)</span>. <span class="math display">\[
\begin{aligned}
  x_1+2x_2+2x_3+x_4&amp;=0\\
  x_1-2t-2+t&amp;=0\\
  x_1&amp;=2+t
\end{aligned}
\]</span> Řešení je <span class="math inline">\(x_1=2+t\)</span>, <span class="math inline">\(x_2=-t\)</span>, <span class="math inline">\(x_3=-1\)</span>, <span class="math inline">\(x_4=t\)</span>, kde <span class="math inline">\(t\)</span> je libovolné reálné číslo. Vektorově (maticově) máme řešení ve tvaru <span class="math display">\[
\begin{pmatrix}
  x_1\\x_2\\x_3\\x_4
\end{pmatrix}
=
\begin{pmatrix}
  2+t\\-t\\-1\\t
\end{pmatrix}
=
\begin{pmatrix}
  2\\0\\-1\\0
\end{pmatrix}
+t
\begin{pmatrix}
  1\\-1\\0\\1
\end{pmatrix}
.
\]</span></p>
<h1 id="gaussova-seidelova-iterační-metoda">Gaussova-Seidelova iterační metoda</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/KBg1tllDhxM"></iframe> </div>
<p>Gaussova-Seidelova iterační metoda je jakýsi mezikrok mezi Jacobiho iterační metodou a Gausovou eliminací. Postupujeme jako v Jacobiho metodě, ale všechny zpřesněné hodnoty použijeme okamžitě, když jsou k dispozici. Nikoliv až v další iteraci jako u Jacobiho metody. Metoda konverguje za stejných podmínek jako Jacobiho metoda, ale rychleji a přesto nevznikají vyšší nároky na výpočetní výkon.</p>
<p>Použijeme příklad z <a href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Seidel_method#An_example_for_the_equation_version">Wikipedie</a>. Soustavu <span class="math display">\[\begin{array}{rrrrl}
10x_1 &amp;-   x_2 &amp;+  2x_3 &amp;       &amp; = 6, \\
 -x_1 &amp;+ 11x_2 &amp;-   x_3 &amp;+ 3x_4 &amp; =  25, \\
 2x_1 &amp;-   x_2 &amp;+ 10x_3 &amp;-  x_4 &amp; =  -11, \\
      &amp;   3x_2 &amp;-   x_3 &amp;+ 8x_4 &amp; =  15.
\end{array}\]</span> s diagonálně dominantní maticí převedeme na iterační tvar <span class="math display">\[
\begin{aligned}
  x_1 &amp; = x_2/10 - x_3/5 + 3/5, \\           
x_2 &amp; = x_1/11 + x_3/11 - 3x_4/11 + 25/11, \\
x_3 &amp; = -x_1/5  + x_2/10 + x_4/10  - 11/10, \\
x_4 &amp; = -3x_2/8  + x_3/8 + 15/8.
\end{aligned}
\]</span> Poté vyjdeme z počátečního odhadu řešení a dosazujeme do pravých stran.</p>
<p>U Jacobiho metody pro počáteční odhad vypočteme nejprve všechny pravé strany a dosadíme do proměnných na levé straně jako zpřesnění počáteční aproximace. Tento postup opakujeme.</p>
<p>U Gaussovy-Seidlovy metody nejprve pomocí počátečního odhadu vypočteme z první rovnice <span class="math inline">\(x_1\)</span> a tuto hodnotu ihned použijeme při výpočtu <span class="math inline">\(x_2\)</span> z další rovnice. Obojí, <span class="math inline">\(x_1\)</span> i <span class="math inline">\(x_2\)</span> už využijeme při výpočtu <span class="math inline">\(x_3\)</span> a tak dále. Po výpočtu <span class="math inline">\(x_4\)</span> je první iterace dokončena a postup opět opakujeme, dokud dvě po sobě jdoucí iterace nejsou dostatečně blízké.</p>
<p>S nulovou počáteční aproximací dostáváme v prvním průchodu <span class="math display">\[
\begin{aligned}
x_1 &amp; = 3/5 = 0.6, \\
x_2 &amp; = 0.6/11 + 25/11 = 2.3272, \\
x_3 &amp; = -0.6/5 +(2.3272)/10-11/10 = -0.9873,\\ 
x_4 &amp; = -3(2.3272)/8 +(-0.9873)/8+15/8 = 0.8789.
\end{aligned}
\]</span> Jak vidno, vypočtenou hodnotu <span class="math inline">\(x_1\)</span> ihned použijeme pro výpočet <span class="math inline">\(x_2\)</span>. Obě tyto hodnoty ihned použijeme pro výpočet <span class="math inline">\(x_3\)</span> a tak dále. V dalších iteracích postup <a href="https://sagecell.sagemath.org/?z=eJytUMGKwjAQvRf6D0NPraakk6RShJ4X9rpXL3WtEpAorcLk73eyCYt4UJFNIC8z782DeefJuguUxefwfdrajevjKao8IxSkBGlBpm_E782z_WkCC9bBNLjDWGJTrfMM-HiEHkhJbKAG0rKFJYQXEq0CjRKR-0wz1qAXZGJHtYxJqVlZs5Rnl8mR0QTkGcTwSVITpOyiZAfRt2PAVnZRcLuCR-GV8Fp4E8lzXN0KV7IOdvZgL3O_qkKt7mp9V5ubmqNKVsXGfQzXea6_Rrsbj39pvhkpPY6UXo6UXo-UnkX6b6n9AO8SliU=&amp;lang=sage&amp;interacts=eJyLjgUAARUAuQ==">opakujeme</a>. Mimo jiné hodnoty v paměti přímo přepisujeme a nemusíme držet v paměti starou a novou hodnotu.</p>
<h1 id="shrnutí-hlavní-myšlenky">Shrnutí, hlavní myšlenky</h1>
<div class="Ycontainer"> <iframe class="responsive-iframe" src="https://www.youtube.com/embed/aeUs2y2QrRw"></iframe> </div>

<div class="obtekat">
<figure>
<img src="../message.jpg" alt="A jaká je hlavní message? Zdroj: pixabay.com" /><figcaption>A jaká je hlavní message? Zdroj: pixabay.com</figcaption>
</figure>
</div>

<ul>
<li>Řada numerických metod pro řešení modelů založených na matematickém modelování fyzikálních zákonů se v nějaké fázi redukuje na řešení soustav lineárních rovnic. Kromě toho se se soustavami lineárních rovnic setkáváme při hledání vlastních směrů matic, což je důlležité pro matice reprezentující materiálové charakteristiky.</li>
<li>Ukázali jsme si tři různé formulace soustav lineárních rovnic, klasickou pomocí rovnic, vektorovou pomocí jedné vektorové rovnice a maticovou pomocí jediné maticové rovnice a jediné maticové operace, maticového součinu.</li>
<li>Ukázali jsme si, že v případě známé inverze k matici soustavy se řešení redukuje na součin inverzní matice s maticí pravých stran.</li>
<li>Kromě možnosti využít inverzní matici jsme si ukázali další tři metody řešení. Dvě čistě numerické metody (Jacobiho a Gaussova-Seidelova metoda) a jednou univerzální (Gaussova eliminační metoda).</li>
</ul>

</div>  <!-- container -->



  <div class='menu-obalka'>
    <a class='menu menu4' href='../../'>Matematika</a><a class='menu menu4 ACTIVE' href='../'>Přednáška</a><a class='menu menu4' href='../cviceni'>Cvičení</a><a class='menu menu4' href='https://um.mendelu.cz/'>WeBWorK</a>
  </div>
	
 <div class='menu-obalka'><a class='menu' href='../intro'>0</a><a class='menu  ' href='../derivace_I'>1</a><a class='menu  ' href='../derivace_II'>2</a><a class='menu  ' href='../derivace_III'>3</a><a class='menu  ' href='../integraly'>4</a><a class='menu  ' href='../integraly2'>5</a><a class='menu  ' href='../ode'>6</a><a class='menu  ' href='../matice'>7</a><a class='menu  ' href='../inverzni_matice'>8</a><a class='menu ACTIVE ' href='../soustavy'>9</a><a class='menu  ' href='../vektorove_pole'>10</a><a class='menu  ' href='../dvojny_integral'>11</a><a class='menu  ' href='../numerika'>12</a><a class='menu  ' href='../shrnuti'>13</a> </div> 


<div class="footer">
      Copyright by Robert Mařík, content is available under <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener">CC BY-SA 3.0</a>, built with <a href="https://www.pandoc.org" target="_blank" rel="noopener">Pandoc</a>
   </div>



<style>
  .shorten {
      border-left: solid;
      border-left-color:gray;
      padding-left:1em;
      max-height:300px;
      overflow:hidden;
      margin-bottom:20px;
      margin-top:20px;
          -webkit-mask-image: linear-gradient(180deg, #000 20%, transparent);
  }
  .rozbalovatko {
      color:gray;
      margin-bottom:30px;
      display:block;
      background-color: gainsboro;
  }
  .rozbalovatko p {padding:10px; margin-top:0px;}
  .rozbalovatkoPopisek {
      color:orangered;
      background-color:#444;
      font-weight: bold;
      display:block;
      padding:5px;
      margin-left: -20px;
      padding-left: 20px;
  }
  .rozbalovatko p {
      color:crimson;
  }
</style>

<script>


jQuery( document ).ready(function() {
    jQuery(".shorten").each(function(){
	popisek = jQuery(this).data("text");
	if (!popisek) {popisek="";}
	jQuery(this).prepend("<span class=\"rozbalovatko\"><span class=\"rozbalovatkoPopisek\">Volitelný text. Klikněte pro rozbalení.</span><p>"+popisek+"</p></span>").css("background-color","gainsboro");
    });

    jQuery(".rozbalovatko").each(function(){
    	jQuery(this).parent().click(function() {
            jQuery( this ).css("max-height","100%").css("-webkit-mask-image","none").css("background-color","inherit");
	    jQuery( this ).children(".rozbalovatko").slideUp();
	    jQuery( this ).unbind("click");
	})
    });
});

</script>

  
</body>
</html>
